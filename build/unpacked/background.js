(()=>{var e={5739:(e,t,a)=>{"use strict";a.d(t,{$:()=>n});const n=globalThis.gvar??{}},181:(e,t,a)=>{var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,l="object"==typeof a.g&&a.g&&a.g.Object===Object&&a.g,d="object"==typeof self&&self&&self.Object===Object&&self,c=l||d||Function("return this")(),u=Object.prototype.toString,f=Math.max,m=Math.min,p=function(){return c.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(h(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=h(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var a=i.test(e);return a||o.test(e)?s(e.slice(2),a?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,a){var n,r,i,o,s,l,d=0,c=!1,u=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var a=n,i=r;return n=r=void 0,d=t,o=e.apply(i,a)}function v(e){var a=e-l;return void 0===l||a>=t||a<0||u&&e-d>=i}function w(){var e=p();if(v(e))return I(e);s=setTimeout(w,function(e){var a=t-(e-l);return u?m(a,i-(e-d)):a}(e))}function I(e){return s=void 0,g&&n?y(e):(n=r=void 0,o)}function S(){var e=p(),a=v(e);if(n=arguments,r=this,l=e,a){if(void 0===s)return function(e){return d=e,s=setTimeout(w,t),c?y(e):o}(l);if(u)return s=setTimeout(w,t),y(l)}return void 0===s&&(s=setTimeout(w,t)),o}return t=b(t)||0,h(a)&&(c=!!a.leading,i=(u="maxWait"in a)?f(b(a.maxWait)||0,t):i,g="trailing"in a?!!a.trailing:g),S.cancel=function(){void 0!==s&&clearTimeout(s),d=0,n=l=r=s=void 0},S.flush=function(){return void 0===s?o:I(p())},S}}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,a),i.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=a(5739).$;function t(e,t,a){let n=a;return null!=e&&(n=Math.max(e,n)),null!=t&&(n=Math.min(t,n)),n}function n(e,t,a){const n=t-e+1e-11;return t<e&&([e,t]=[t,e]),a<e?r(t-(e-a)%n,6):a>t?r(e+(a-t)%n,6):a}function r(e,t){const a=10**t;return Math.round(e*a)/a}function i(){return Math.ceil(1e10*Math.random()).toString()}let o,s,l;function d(){return o=o??navigator.userAgent.includes("Firefox/"),o}function c(){if(null!=l)return l;let e=navigator.userAgentData;return e?(l=e.mobile,l):(l=/Mobi|Android|iPhone|iTabletPad/i.test(navigator.userAgent),!l&&!d()&&globalThis.CSS&&globalThis.CSS.supports?.("(-webkit-touch-callout: none)")&&(l=!0),l)}function u(e,t){let a=e<0?"-":t?"+":"";const n=(e=Math.abs(e))/60,r=n/60;return r>=100?"":r>1?`${a}${Math.floor(r)}:${Math.floor(n%60).toString().padStart(2,"0")}:${Math.floor(e%60).toString().padStart(2,"0")}`:`${a}${Math.floor(n).toString().padStart(1,"0")}:${Math.floor(e%60).toString().padStart(2,"0")}`}function f(e){return new Promise(((t,a)=>{setTimeout((()=>t(!0)),e)}))}function m(e,t){return Object.fromEntries(e.map((e=>[e,t])))}function p(){if(!screen)return{width:1e3,height:800,left:200,top:200};const e=Math.min(screen.width-100,1e3),t=Math.min(screen.height-100,800);return{width:e,height:t,left:screenLeft+(screen.width-e)/2,top:screenTop+(screen.height-t)/2}}e.sess=new class{installCbs=new Set;safeCbs=new Set;safeStartupCbs=new Set;#e=!1;constructor(){chrome.runtime.onInstalled.addListener(this.handleInstall),chrome.runtime.onStartup.addListener(this.handleStartup)}handleInstall=async()=>{this.#e||(this.#e=!0,this.installCbs.forEach((e=>e())),this.handleCommon())};handleStartup=async()=>{this.#e||(this.#e=!0,this.handleCommon())};handleCommon=async()=>{await e.installPromise,this.safeCbs.forEach((e=>e())),this.safeStartupCbs.forEach((e=>e()))}},a(5739).$;var h=a(5739).$;h.es=new class{watchers=[];processedChangeIds=new Set;released=!1;constructor(){chrome.storage.local.onChanged.addListener(this.handleChange)}init=async()=>{if(this.rawMap||(await h.installPromise,this.rawMap=await chrome.storage.local.get()),!this.rawMap)throw Error("Raw map could not be loaded")};addWatcher=(e,t)=>{this.watchers.push([e,t])};removeWatcher=e=>{const t=this.watchers.findIndex((t=>t[1]===e));t>=0&&this.watchers.splice(t,1)};handleChange=async e=>{await this.init(),e=e??{};const t=e.changeId?.newValue;if(t){if(this.processedChangeIds.has(t))return void this.processedChangeIds.delete(t);this.processedChangeIds.add(t)}for(let t in e)Object.hasOwn(e[t],"newValue")?this.rawMap[t]=e[t].newValue:delete this.rawMap[t];if(!this.rawMap["g:version"])return;const a=Object.keys(e),n=new Set(a);this.watchers.forEach((([t,r])=>{this.testWatcher(a,n,t)&&r(e)}))};testWatcher=(e,t,a)=>{if(0===a.length)return!0;for(let n of a)if("function"==typeof n||"function"==typeof n?.test){let t=n.test?.bind(n)??n;if(e.some((e=>t(e))))return!0}else if("string"==typeof n&&t.has(n))return!0;return!1};getAllUnsafe=async()=>(await this.init(),this.rawMap);get=async e=>{if(await this.init(),null==e)return{...this.rawMap};let t={};"string"==typeof e?e=[e]:Array.isArray(e)||"object"==typeof e&&(t={...e},e=Object.keys(t));for(let a of e)Object.hasOwn(this.rawMap,a)&&(t[a]=this.rawMap[a]);return t};set=async e=>{await this.init(),e.changeId=i();const t={};for(let a in e)void 0!==e[a]&&(t[a]={newValue:e[a],oldValue:this.rawMap[a]});await Promise.all([this.handleChange(t),chrome.storage.local.set(e)])}};let b=function(e){return e[e.PREVIOUS=1]="PREVIOUS",e[e.GLOBAL=2]="GLOBAL",e[e.NEW=3]="NEW",e[e.CUSTOM=4]="CUSTOM",e}({});const g=["speed","lastSpeed","enabled","latestViaShortcut","elementFx","backdropFx","monoOutput","audioFx","audioFxAlt","audioPan"],y=new Set(g),v=[["speed"],["elementFx","backdropFx"],["enabled","latestViaShortcut"]],w=v.flat(1),I=new Set(w),S=Object.fromEntries(w.map((e=>[e,v.find((t=>t.includes(e)))]))),M=["enabled","monoOutput","audioFx","audioFxAlt","audioPan"];new Set(M);let x=function(e){return e[e.SET=1]="SET",e[e.ADD=2]="ADD",e[e.CYCLE=3]="CYCLE",e[e.ITC=4]="ITC",e[e.ITC_REL=5]="ITC_REL",e}({}),E=function(e){return e[e.SECS=1]="SECS",e[e.FRAMES=2]="FRAMES",e[e.PERCENT=3]="PERCENT",e}({}),T=function(e){return e[e.LOCAL=0]="LOCAL",e[e.GLOBAL=1]="GLOBAL",e[e.CONTEXT=2]="CONTEXT",e}({}),k=function(e){return e[e.FX=1]="FX",e[e.AUDIO_FX=2]="AUDIO_FX",e[e.MEDIA=3]="MEDIA",e[e.MISC=4]="MISC",e}({}),_=function(e){return e[e.FIRST_TIME=1]="FIRST_TIME",e[e.DIFFERENT_HOST=2]="DIFFERENT_HOST",e[e.EVERY_COMMIT=3]="EVERY_COMMIT",e[e.EVERY_NAVIGATION=4]="EVERY_NAVIGATION",e}({});var C=a(5739).$;function A(e){const t={};return"backdrop"!==e&&"both"!==e||(t.backdrop=!0),"element"!==e&&"both"!==e||(t.element=!0),t}function F(e,t,a,n){C?.tabInfo?.tabId===a&&C.tabInfo.frameId,chrome.tabs.sendMessage(a,{type:"APPLY_MEDIA_EVENT",event:e,key:t},null==n?void 0:{frameId:n})}function O(e,t,a){chrome.tabs.sendMessage(t,e,null==a?void 0:{frameId:a})}function P(e,t,a){const n=t?.parts.filter((e=>!e.disabled))||[];if(!n.length)return a;const r=n.some((t=>function(e,t){if("STARTS_WITH"===t.type)return e.startsWith(t.valueStartsWith);if("CONTAINS"===t.type)return e.includes(t.valueContains);if("REGEX"===t.type)try{return new RegExp(t.valueRegex).test(e)}catch(e){}}(e,t)));return t.block?!r:r}var D=a(181),R=a.n(D);async function N(e){if(!chrome.contextMenus)return;let t=new Set;await new Promise(((e,t)=>{chrome.contextMenus.removeAll((()=>{chrome.runtime.lastError&&t(chrome.runtime.lastError),e()}))})),(e=(e=(await V(["keybinds"])).keybinds).filter((e=>e.trigger===T.CONTEXT&&e.enabled))).length&&(await U({id:"parent",title:"Global Speed",contexts:["all"],documentUrlPatterns:["https://*/*","http://*/*"]}),await Promise.all(e.map((async e=>{await $(t,e),e.allowAlt&&e.adjustMode===x.CYCLE&&await $(t,e,!0)}))),e.forEach((e=>{L(t,e),e.allowAlt&&e.adjustMode===x.CYCLE&&L(t,e,!0)})))}function $(e,t,a){const n=(a?t.contextLabelAlt:t.contextLabel)||"";if(!n.includes("::"))return;const r=n.split("::")[0].trim();if(!r)return;const i=`fold_${r.toLowerCase()}`;return e.has(i)?void 0:(e.add(i),U({id:i,title:r,contexts:["all"],parentId:"parent",documentUrlPatterns:["https://*/*","http://*/*"]}))}function L(e,t,a){let n="parent",r=(a?t.contextLabelAlt:t.contextLabel)||"";if(r.includes("::")){let[t,a]=r.split("::");t=`fold_${t.trim().toLowerCase()}`,e.has(t)&&(n=t,r=a.trim())}return U({id:a?`ALT_${t.id}`:t.id,title:r?.trim()||"---",type:"normal",contexts:["all"],parentId:n,documentUrlPatterns:["https://*/*","http://*/*"]})}const j=R()(N,1e3,{trailing:!0});function U(e){return new Promise(((t,a)=>{chrome.contextMenus.create(e,(()=>{chrome.runtime.lastError&&a(chrome.runtime.lastError),t()}))}))}var G=a(5739).$;async function V(e,t,a=!1){return t=t??0,function(e,t,a){t={...t};let n="g:";a>0&&t[`t:${a}:isPinned`]&&(n=`t:${a}:`);const r=`r:${a}:`;let i={};for(let a in e)"isPinned"===a?i[a]=t[n.concat(a)]:"hasOrl"===a?i[a]=w.some((e=>null!=t[r.concat(e)])):y.has(a)?i[a]=t[r.concat(a)]??t[n.concat(a)]:i[a]=t[`g:${a}`];return i}(e=Array.isArray(e)?m(e,!0):e,await async function(e){return G.es?G.es.get(e):chrome.storage.local.get(e)}(function(e,t,a=!1,n=!1){let r=new Set;n&&t>0&&r.add(`t:${t}:isPinned`);for(let n in e)"isPinned"===n?t>0&&r.add(`t:${t}:isPinned`):"hasOrl"===n?t>0&&w.forEach((e=>{r.add(`r:${t}:${e}`)})):y.has(n)?(r.add(`g:${n}`),t>0&&(r.add(`t:${t}:${n}`),r.add(`t:${t}:isPinned`),!a&&I.has(n)&&r.add(`r:${t}:${n}`))):r.add(`g:${n}`);return[...r]}(e,t,a)),t)}async function B(e){return async function(e){return G.es?G.es.set(e):chrome.storage.local.set(e)}(await async function(e){e.tabId=e.tabId??0,e.override={...e.override};const t={};let a=Object.entries(e.override).filter((([a,n])=>{if("isPinned"!==a){if(y.has(a))return!0;if("hasOrl"===a){if(1==n||0===e.tabId)return;w.forEach((a=>{t[`r:${e.tabId}:${a}`]=null}))}else t[`g:${a}`]=n}})),n=a.length||null!=e.override.isPinned,{base:r,isPinned:i}=n?await async function(e,t){const a=t.override;if(null!=a.isPinned&&0===t.tabId)throw Error("Setting isPinned requires a non-zero tabId");let n=!1;return t.tabId>0&&(n=t.knownPinStatus??(await V(["isPinned"],t.tabId)).isPinned??!1,null!=a.isPinned&&(!0===a.isPinned&&!1===n?(e=await async function(e,t,a){g.forEach((a=>{e[`t:${t}:${a}`]=null})),e[`t:${t}:isPinned`]=!0;const n=await V(g,a,!0);for(let a in n)e[`t:${t}:${a}`]=n[a];return w.forEach((a=>{e[`r:${t}:${a}`]=null})),e}(e,t.tabId,t.inheritContextFromTabId||0),n=!0):!1===a.isPinned&&!0===n&&(e=function(e,t){return[...g,"isPinned"].forEach((a=>{e[`t:${t}:${a}`]=null})),w.forEach((a=>{e[`r:${t}:${a}`]=null})),e}(e,t.tabId),n=!1))),delete a.isPinned,{base:e,isPinned:n}}({},e):{base:{},isPinned:!1};if(Object.assign(r,t),a.length){const t=i?`t:${e.tabId}:`:"g:",n=`r:${e.tabId}:`;a.forEach((([e,a])=>{r[`${t}${e}`]=a,I.has(e)&&S[e].forEach((e=>{r[`${n}${e}`]=null}))}))}if(e.overrideRaw)for(let t in e.overrideRaw)r[t]=e.overrideRaw[t];return r}(e))}const W=["s:","r:","t:"],X=["g:"];async function q(e,t){return t=t??await chrome.storage.local.get(),Object.keys(t).filter((t=>e.some((e=>t.startsWith(e)))))}var z=a(5739).$;let K;const H={128:"icons/128.png"},Y={128:"icons/128g.png"};async function J(e){K||(K=await Z(0)),ee(K,void 0),async function(e){Promise.all(e.map((e=>async function(e){ee(await Z(e.id),e.id)}(e))))}(e??await chrome.tabs.query({active:!0}))}const Q=R()(J,100,{leading:!0,trailing:!0,maxWait:1e3});async function Z(e){const{isPinned:t,speed:a,enabled:n,hasOrl:r,superDisable:i,hideBadge:o}=await V({hideBadge:!0,superDisable:!0,isPinned:!0,speed:!0,enabled:!0,hasOrl:!0},e),s=n&&!i;let l=s&&!o,c=s?H:Y,u=l?function(e){return function(e,t=!1){let a=e.toFixed(2);return t&&"0"===a.at(-1)&&(a=a.slice(0,-1)),a}(e).slice(0,d()?3:4)}(a??1):"",f="#000";return!r||s||o||(l=!0,u="OFF"),l&&(f=r?"#7fffd4":t?"#44a":"#a33"),{badgeText:u,badgeColor:f,badgeIcons:c}}async function ee(e,t){chrome.action.setBadgeText({text:e.badgeText,tabId:t}),chrome.action.setBadgeBackgroundColor({color:e.badgeColor,tabId:t}),chrome.action.setIcon({path:e.badgeIcons,tabId:t})}c()||(z.es.addWatcher([/^g:(speed|enabled|superDisable|hideBadge)/,/^[rt]:[\d\w]+:(speed|isPinned|enabled)/,/^[r]:[\d\w]+:(elementFx|backdropFx|latestViaShortcut|)/],(e=>{Q()})),z.sess.safeCbs.add((()=>J())),chrome.webNavigation.onCommitted.addListener((()=>J())),chrome.tabs.onActivated.addListener((()=>J())));const te={sepia:{ref:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,itcStep:.5,wrappable:!0},format:e=>`sepia(${e})`},hueRotate:{ref:{step:8,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,itcStep:180},format:e=>`hue-rotate(${e}deg)`},grayscale:{ref:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,itcStep:.5,wrappable:!0},format:e=>`grayscale(${e})`},contrast:{ref:{min:0,step:.1,sliderMin:0,sliderMax:5,default:1,itcStep:2.5},format:e=>`contrast(${e})`},brightness:{ref:{min:0,step:.1,sliderMin:0,sliderMax:5,sliderStep:.05,default:1,itcStep:2.5},format:e=>`brightness(${e})`},saturate:{ref:{min:0,step:.1,sliderMin:0,sliderMax:5,sliderStep:.05,default:1,itcStep:2.5},format:e=>`saturate(${e})`},invert:{ref:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,itcStep:.5,wrappable:!0},format:e=>`invert(${e})`},blur:{ref:{min:0,step:.1,sliderMin:0,sliderMax:10,sliderStep:.1,default:0,itcStep:5},format:e=>`blur(${e}px)`},opacity:{ref:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:1,itcStep:.5,wrappable:!0},format:e=>`opacity(${e})`},scaleX:{isTransform:!0,ref:{step:.1,sliderMin:-1,sliderMax:3,sliderStep:.04,default:1,itcStep:2},format:e=>`scaleX(${e})`},scaleY:{isTransform:!0,ref:{step:.1,sliderMin:-1,sliderMax:3,sliderStep:.04,default:1,itcStep:2},format:e=>`scaleY(${e})`},translateX:{isTransform:!0,ref:{step:1,sliderMin:-300,sliderMax:300,sliderStep:5,default:0,itcStep:300},format:e=>`translateX(${e}px)`},translateY:{isTransform:!0,ref:{step:1,sliderMin:-300,sliderMax:300,sliderStep:5,default:0,itcStep:300},format:e=>`translateY(${e}px)`},rotateX:{isTransform:!0,ref:{step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,itcStep:180},format:e=>`rotateX(${e}deg)`},rotateY:{isTransform:!0,ref:{step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,itcStep:180},format:e=>`rotateY(${e}deg)`},rotateZ:{isTransform:!0,ref:{step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,itcStep:180},format:e=>`rotateZ(${e}deg)`}};let ae={nothing:{group:k.MISC,valueType:"number",disableOnMobile:!0,ref:{default:0,min:0,max:600},generate:()=>({id:i(),command:"nothing",enabled:!0,greedy:!0})},runCode:{group:k.MISC,valueType:"modalString",disableOnMobile:!0,generate:()=>({id:i(),command:"runCode",enabled:!0,greedy:!0,valueString:"// code here"})},openUrl:{group:k.MISC,valueType:"string",generate:()=>({id:i(),command:"openUrl",enabled:!0,greedy:!0,valueString:"https://example.com"})},intoPopup:{group:k.MISC,disableOnMobile:!0,generate:()=>({id:i(),command:"intoPopup",enabled:!0,greedy:!0,valuePopupRect:p()})},speed:{valueType:"adjustMode",hasFeedback:!0,ref:{min:.07,max:16,step:.1,default:1,sliderMin:.5,sliderMax:1.5,itcStep:1,wrappable:!0},generate:()=>({id:i(),command:"speed",enabled:!0,greedy:!0})},temporarySpeed:{valueType:"number",hasFeedback:!0,requiresMedia:!0,ref:{default:3,min:0},generate:()=>({id:i(),command:"temporarySpeed",enabled:!0,greedy:!0,valueNumber:3})},speedChangesPitch:{valueType:"state",hasFeedback:!0,requiresMedia:!0,generate:()=>({id:i(),command:"speedChangesPitch",enabled:!0,greedy:!0,valueState:"toggle"})},pin:{valueType:"state",hasFeedback:!0,generate:()=>({id:i(),command:"pin",enabled:!0,greedy:!0,valueState:"toggle"})},state:{valueType:"state",hasFeedback:!0,generate:()=>({id:i(),command:"state",enabled:!0,greedy:!0,valueState:"toggle"})},seek:{group:k.MEDIA,withDuration:!0,valueType:"adjustMode",requiresMedia:!0,hasFeedback:!0,getRef:(e,t)=>{const a=t.duration||E.SECS;return a===E.SECS?{min:0,default:300,itcStep:60,step:10,sliderMin:0,sliderMax:600,wrappable:!0}:a===E.PERCENT?{min:0,max:100,default:50,step:10,itcStep:50,sliderMin:0,sliderMax:100,wrappable:!0}:a===E.FRAMES?{min:0,default:240,step:1,itcStep:2400,sliderMin:0,sliderMax:14e3,wrappable:!0}:void 0},generate:()=>({id:i(),adjustMode:x.ADD,command:"seek",enabled:!0,greedy:!0,valueNumber:10})},pause:{group:k.MEDIA,valueType:"state",requiresMedia:!0,hasFeedback:!0,generate:()=>({id:i(),command:"pause",enabled:!0,greedy:!0,valueState:"toggle"})},mute:{group:k.MEDIA,hasFeedback:!0,valueType:"state",requiresMedia:!0,generate:()=>({id:i(),command:"mute",enabled:!0,greedy:!0,valueState:"toggle"})},muteTab:{group:k.MEDIA,disableOnMobile:!0,hasFeedback:!0,valueType:"state",requiresMedia:!0,generate:()=>({id:i(),command:"muteTab",enabled:!0,greedy:!0,valueState:"toggle"})},volume:{group:k.MEDIA,hasFeedback:!0,valueType:"adjustMode",requiresMedia:!0,ref:{min:0,max:1,step:.05,default:.5,sliderMin:0,sliderMax:1,itcStep:.5,wrappable:!0},generate:()=>({id:i(),adjustMode:x.ADD,command:"volume",enabled:!0,greedy:!0})},setMark:{group:k.MEDIA,hasFeedback:!0,valueType:"string",requiresMedia:!0,generate:()=>({id:i(),command:"setMark",enabled:!0,greedy:!0,valueString:"mark1"})},seekMark:{group:k.MEDIA,hasFeedback:!0,valueType:"string",requiresMedia:!0,generate:()=>({id:i(),command:"seekMark",enabled:!0,greedy:!0,valueString:"mark1"})},loop:{group:k.MEDIA,hasFeedback:!0,valueType:"string",requiresMedia:!0,generate:()=>({id:i(),command:"loop",enabled:!0,greedy:!0,valueString:"mark1"})},skip:{group:k.MEDIA,hasFeedback:!0,valueType:"string",requiresMedia:!0,generate:()=>({id:i(),command:"skip",enabled:!0,greedy:!0,valueString:"mark1"})},fullscreen:{group:k.MEDIA,requiresVideo:!0,disableOnMobile:!0,generate:()=>({id:i(),command:"fullscreen",enabled:!0,greedy:!0})},PiP:{group:k.MEDIA,valueType:"state",requiresVideo:!0,disableOnMobile:!0,requiresPiPApi:!0,generate:()=>({id:i(),command:"PiP",enabled:!0,greedy:!0,valueState:"toggle"})},cinema:{group:k.MEDIA,valueType:"state",disableOnMobile:!0,requiresVideo:!0,generate:()=>({id:i(),command:"cinema",enabled:!0,greedy:!0,valueState:"toggle"})},mediaInfo:{group:k.MEDIA,requiresMedia:!0,disableOnMobile:!0,generate:()=>({id:i(),command:"mediaInfo",enabled:!0,greedy:!0})},loopEntire:{group:k.MEDIA,requiresMedia:!0,valueType:"state",generate:()=>({id:i(),command:"loopEntire",enabled:!0,greedy:!0,valueState:"toggle"})},fxState:{group:k.FX,hasFeedback:!0,withFilterTarget:!0,valueType:"state",generate:()=>({id:i(),command:"fxState",enabled:!0,greedy:!0,valueState:"toggle",filterTarget:"element"})},fxReset:{group:k.FX,hasFeedback:!0,withFilterTarget:!0,generate:()=>({id:i(),command:"fxReset",enabled:!0,greedy:!0,filterTarget:"element"})},fxSwap:{group:k.FX,hasFeedback:!0,generate:()=>({id:i(),command:"fxSwap",enabled:!0,greedy:!0})},fxFilter:{group:k.FX,hasFeedback:!0,valueType:"adjustMode",withFilterOption:!0,withFilterTarget:!0,getRef:(e,t)=>e.withFilterOption&&te[t.filterOption]?.ref,generate:()=>({id:i(),command:"fxFilter",filterOption:"hueRotate",enabled:!0,greedy:!0,filterTarget:"element",adjustMode:x.ADD})},drawPage:{group:k.FX,disableOnMobile:!0,generate:()=>({id:i(),command:"drawPage",enabled:!0,greedy:!0})},afxGain:{group:k.AUDIO_FX,hasFeedback:!0,valueType:"adjustMode",requiresTabCapture:!0,ref:{min:0,max:16,step:.05,default:1,sliderMin:0,sliderMax:3,itcStep:1.5},generate:()=>({id:i(),command:"afxGain",enabled:!0,greedy:!0,adjustMode:x.ADD})},afxPitch:{group:k.AUDIO_FX,hasFeedback:!0,valueType:"adjustMode",requiresTabCapture:!0,ref:{min:-100,max:100,step:1,default:0,sliderMin:-6,sliderMax:6,itcStep:3},generate:()=>({id:i(),command:"afxPitch",enabled:!0,greedy:!0,adjustMode:x.ADD})},afxDelay:{group:k.AUDIO_FX,hasFeedback:!0,valueType:"adjustMode",requiresTabCapture:!0,ref:{min:0,max:60,step:.05,default:0,sliderMin:0,sliderMax:5,itcStep:2.5},generate:()=>({id:i(),command:"afxDelay",enabled:!0,greedy:!0,adjustMode:x.ADD})},afxPan:{group:k.AUDIO_FX,hasFeedback:!0,valueType:"adjustMode",requiresTabCapture:!0,ref:{min:-1,max:1,step:.05,default:0,sliderMin:-1,sliderMax:1,itcStep:1,wrappable:!0},generate:()=>({id:i(),command:"afxPan",enabled:!0,greedy:!0,adjustMode:x.ADD})},afxMono:{group:k.AUDIO_FX,hasFeedback:!0,valueType:"state",requiresTabCapture:!0,generate:()=>({id:i(),command:"afxMono",enabled:!0,greedy:!0,valueState:"toggle"})},afxCapture:{group:k.AUDIO_FX,hasFeedback:!0,valueType:"state",requiresTabCapture:!0,generate:()=>({id:i(),command:"afxCapture",enabled:!0,greedy:!0,valueState:"toggle",trigger:T.GLOBAL})},afxReset:{group:k.AUDIO_FX,hasFeedback:!0,requiresTabCapture:!0,generate:()=>({id:i(),command:"afxReset",enabled:!0,greedy:!0})}};function ne(){if(c())return[];let e=[{...ae.speed.generate(),key:"KeyA",adjustMode:x.ADD,valueNumber:-.1},{...ae.speed.generate(),key:"KeyS",valueNumber:1},{...ae.speed.generate(),key:"KeyD",adjustMode:x.ADD,valueNumber:.1,spacing:1},{...ae.seek.generate(),key:"KeyZ",adjustMode:x.ADD,valueNumber:-5},{...ae.seek.generate(),key:"KeyX",adjustMode:x.ADD,spacing:1},{...ae.seek.generate(),key:{shiftKey:!0,code:"KeyZ"},adjustMode:x.ADD,duration:E.FRAMES,valueNumber:-1},{...ae.seek.generate(),key:{shiftKey:!0,code:"KeyX"},adjustMode:x.ADD,duration:E.FRAMES,valueNumber:1,spacing:1},{...ae.fullscreen.generate(),key:{shiftKey:!0,code:"KeyF"},direct:!0},{...ae.setMark.generate(),key:{shiftKey:!0,code:"KeyW"},valueString:"mark1"},{...ae.seekMark.generate(),key:"KeyW",valueString:"mark1"},{...ae.loop.generate(),key:"KeyR",valueString:"mark1",spacing:2},{...ae.drawPage.generate(),trigger:T.CONTEXT,contextLabel:"- Draw on Page",replaceWithGsm:4},{...ae.cinema.generate(),trigger:T.CONTEXT,contextLabel:"- Darken Background",replaceWithGsm:10},{...ae.fxFilter.generate(),trigger:T.CONTEXT,replaceWithGsm:6,contextLabel:"- Fx :: Invert Page",filterOption:"invert",filterTarget:"both",adjustMode:x.CYCLE,valueCycle:[0,1]},{...ae.fxFilter.generate(),trigger:T.CONTEXT,replaceWithGsm:7,contextLabel:"- Fx :: Grayscale Page",filterOption:"grayscale",filterTarget:"backdrop",adjustMode:x.CYCLE,valueCycle:[0,1]},{...ae.fxFilter.generate(),trigger:T.CONTEXT,replaceWithGsm:8,contextLabel:"- Fx :: Video Brightness",filterOption:"brightness",adjustMode:x.ITC,valueItcMin:.5,valueItcMax:2},{...ae.fxFilter.generate(),trigger:T.CONTEXT,replaceWithGsm:9,contextLabel:"- Fx :: Video Contrast",filterOption:"contrast",adjustMode:x.ITC,valueItcMin:.75,valueItcMax:1.25},{...ae.fxReset.generate(),trigger:T.CONTEXT,filterTarget:"both",contextLabel:"- Fx :: Reset",replaceWithGsm:5}];return chrome.tabCapture&&chrome.offscreen&&e.push({...ae.afxPitch.generate(),trigger:T.CONTEXT,contextLabel:"- pitch",adjustMode:x.ITC,replaceWithGsm:1},{...ae.afxGain.generate(),trigger:T.CONTEXT,contextLabel:"- gain",adjustMode:x.ITC,replaceWithGsm:2},{...ae.afxReset.generate(),trigger:T.CONTEXT,contextLabel:"- audio reset",replaceWithGsm:3,spacing:2}),e}const re=Object.entries(ae).filter((e=>!e[1].requiresTabCapture||chrome.tabCapture&&chrome.offscreen)).filter((e=>!e[1].requiresPiPApi||!d())).map((e=>e[0])),ie=[{v:"https://docs.google.com"},{v:"https://play.geforcenow.com"},{v:"https://www.xbox.com"},{v:"https://docs.qq.com"},{v:"https://www.playstation.com"},{v:"https://excalidraw.com"},{v:"https://www.photopea.com"},{v:"https://www.canva.com"},{v:"http://luna.amazon.com"},{v:"https://ys.mihoyo.com"},{v:"https://chatgpt.com"},{v:"https://claude.ai"},{v:"https://gemini.google.com"},{v:"https://www.deepseek.com"},{v:"https://www.youtube.com/playables"},{v:"game",contains:!0}];function oe(e){return e.contains?`contains_${e.v}`:`starts_${e.v}`}function se(e){return{id:i(),type:"STARTS_WITH",valueStartsWith:e,valueContains:e,valueRegex:""}}function le(){return{version:12,firstUse:Date.now(),keybinds:ne(),freshKeybinds:!0,...de(),keybindsUrlCondition:{block:!0,parts:ie.map((e=>{const t=se(e.v);return e.contains&&(t.type="CONTAINS"),t}))},websitesAddedToUrlConditionsExclusion:ie.map((e=>oe(e))),hideMediaView:c(),holdToSpeed:c()?2:void 0}}function de(e){const t={speed:1,enabled:!0,audioFx:ue()};return e&&g.forEach((e=>{t[e]=t[e]??null})),t}function ce(){const[e,t]=function(e,t){let a=[],n=[];return e.forEach((e=>{(([e,t])=>t.isTransform)(e)?a.push(e):n.push(e)})),[a,n]}(Object.entries(te));return{filters:t.map((([e,t])=>({name:e,value:t.ref.default}))),transforms:e.map((([e,t])=>({name:e,value:t.ref.default})))}}function ue(){return{pitch:0,volume:1,delay:0,eq:{enabled:!1,factor:1,values:Array(10).fill(0)}}}Object.freeze([{name:"1965",values:[-6,-17.2,-6,0,-3.6,9.2,1.2,9.2,3.6,-5.2]},{name:"1965 - Part 2",values:[-18,-14.4,0,0,-3.6,9.2,1.2,9.2,3.6,-5.2]},{name:"Lo-Fidelity",values:[-15.1,-9.4,0,2.3,-2,4.3,4.3,-2.3,-4.6,-8.9]},{name:"Musical Presence",values:[0,0,0,0,0,2.5,5,2.5,0,0]},{name:"Notch Every Two Octaves",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"Rattle The Trunk",values:[17.99,17.99,9,0,0,0,0,0,0,0]},{name:"Simple Bass Cut",values:[-4,-3,-2,-2,-2,0,0,0,0,0]},{name:"Simple Bass Lift",values:[6,6,3,3,3,0,0,0,0,0]},{name:"Simple High Cut",values:[0,0,0,0,0,-2,-2,-3,-3,-3]},{name:"Simple High Lift",values:[0,0,0,0,0,1,2,2,3,4]},{name:"Vocal Presence - Boost",values:[0,0,0,0,0,0,6.5,0,0,0]},{name:"Vocal Presence - Cut",values:[0,0,0,0,0,0,-6.5,0,0,0]}]),Object.freeze([{name:"20 Band Classic V",values:[5,6,3.54,.59,-.48,-2.5,-5,-7,-8,-8,-7,-5,-3,-2.5,-1,2,3,4,5,4.02]},{name:"Bowed String",values:[0,0,-1.2,-1.6,-2.4,-2.8,-1.6,-1.6,-1.6,0,0,0,0,0,2.4,3.6,5.6,0,0,0]},{name:"Bright and Punchy",values:[-3,3,6,4.5,3,1.5,0,0,0,0,0,0,0,1,2,3,4,4,4,4]},{name:"Cymbal Shimmer",values:[0,0,0,0,0,0,0,0,0,0,0,-.1,-.3,-.5,-.4,.2,1.3,2.6,3.6,4]},{name:"Dark and Dull",values:[-6,-4,-2,0,0,0,0,0,0,0,0,0,0,-3,-6,-9,-12,-15,-18,-18]},{name:"Destination - Car Stereo",values:[-4,-2,0,3,4,3,1.5,0,-1,-2,-2,-1,0,1,2,3,4,2,0,-3]},{name:"Heavy Guitar",values:[0,-.2,-.1,1,1.9,1.6,.4,-.5,-1.1,-2.2,-3.6,-3.9,-2.9,-1.6,-.5,.1,.1,0,0,0]},{name:"Liven up dead samples",values:[0,0,0,0,0,0,0,0,0,0,0,.1,.1,-.2,-.6,.5,3,3.9,1.5,-.4]},{name:"Notch Every Octave",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"Possible Bass",values:[0,0,5.2,6,3.2,0,-11.6,-5.2,-4,-4,0,3.2,4.8,0,0,0,-3.2,-7.2,-10.8,-14]},{name:"Sloping High End Boost",values:[0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,6,7,8,8]},{name:"Sloping Low End Boost",values:[8,8,8,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0]},{name:"Tinny and Brittle",values:[-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,0,0,0,1,3.52,6,6,3,1]},{name:"Vocal Magic (breath)",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,.1,-.1,-.5,2,2.5,1]}]),Object.freeze([{name:"Bass - Increased Clarity",values:[-4,-3.4,-1.9,-.3,.6,.6,.2,-.3,-1.2,-1.5,1.4,2.9,.7,.2,.8,.5,0,-2,-.5,-.5,-.4,-.2,0,0,-.2,-.4,-.4,-.3,-.1,0]},{name:"Background Vocal",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,-3,-6,-3,0,0,-.1,0,0,0]},{name:"Classic V",values:[3,2.5,1.3,.2,-.4,-.5,-.2,.2,.4,.3,-.3,-1.6,-3.4,-5.7,-8.2,-10.2,-10.9,-9.8,-7.4,-4.5,-2.3,-.9,-.1,0,-.2,-.3,.2,1.3,2.5,3]},{name:"Destination - Home Theater",values:[4.5,6,7.5,7.5,5,3,1.5,.5,0,-.5,-1.5,-3,-5,-3,-1.5,0,1.5,3,3,3,1.5,0,0,3,6,7.5,7.5,6,3,0]},{name:"Drums",values:[0,0,0,0,0,0,0,-.1,.3,.4,-2,-2.8,0,.6,-.2,-.1,0,-.2,-.3,-.5,-.4,-.1,0,0,.2,-.3,-.1,2.5,2.1,0]},{name:"Generic Attack Booster",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.1,-.1,-.1,.2,.6,1.3,2,2.8,3.1,2.7,1.8,.6,-.2,-.3,-.1,0]},{name:"Generic Mud Removal",values:[0,0,0,0,-.1,-.3,-.7,-1.5,-2.4,-3,-2.8,-2,-.8,0,.4,.3,0,-.1,-.1,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Hi Boost",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.5,1.5,3,5,5,3,1.5,.5]},{name:"Gentle Hi Cut",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.5,-1.5,-3,-5,-5,-3,-1.5,-.5]},{name:"Gentle Low Boost",values:[0,.5,1.5,3,5,3,1.5,.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Low Cut",values:[0,-.5,-1.5,-3,-5,-3,-1.5,-.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Mid Boost",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,.5,1.5,3,5,5,3,1.5,.5,0,0,0,0,0,0,0,0,0]},{name:"Gentle Mid Cut",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,-.5,-1.5,-3,-5,-5,-3,-1.5,-.5,0,0,0,0,0,0,0,0,0]},{name:"Guitar - Increases Attack",values:[0,0,0,0,-1.5,-4,-2,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,2,0,-.1,0,0,0,-.1,0,0,0]},{name:"Keyboards - Bright and Clear",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,2,5,2.5,0,0,-.1,0,0,0]},{name:"Kick - Less Boxy, more Attack",values:[0,0,0,0,0,0,0,0,0,0,-2.5,-6,-2.5,0,0,0,0,0,0,0,0,2,5,2,0,0,0,0,0,0]},{name:"Lead Vocal - Clarity",values:[0,0,0,0,0,0,0,0,-3,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,0,2,0,0,4,-.1,0,0,0]},{name:"Notch Every 2/3 Octave",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"RIAA De-Emphasis",values:[18.3,17.6,16.7,15.6,14.2,12.8,11.3,9.6,8,6.5,5,3.7,2.6,1.6,.7,0,-.7,-1.6,-2.6,-3.7,-5.1,-6.6,-8.2,-10,-11.9,-13.8,-15.7,-17.7,-19.7,-20]},{name:"Snare - Increase Snap",values:[0,-.1,-.2,-.1,.5,1.3,1.9,1.9,1.3,.4,-.1,-.3,-.2,0,.1,0,0,-.1,-.2,-.4,-.6,-.7,-.5,1.5,2,0,0,0,.9,0]},{name:"cymbals sans gong",values:[-8,-6.5,-3.3,-.4,.4,-.5,-2.3,-3.7,-4.5,-4.4,-3.7,-2.3,-.9,.1,.5,.3,0,-.3,-.5,-.5,-.4,-.2,0,.1,0,0,-.1,0,0,0]}]);var fe=a(5739).$;const me=[[["ON","OFF"],(e,t,a,n)=>{n[`r:${t}:enabled`]="ON"===a.type,n[`r:${t}:latestViaShortcut`]=!1}],[["SPEED"],(e,t,a,n)=>{n[`r:${t}:speed`]=a.overrideSpeed??1}],[["FX"],(e,t,a,n)=>{n[`r:${t}:elementFx`]=a.overrideFx?.elementFx||ce(),n[`r:${t}:backdropFx`]=a.overrideFx?.backdropFx||ce()}],[["JS"],async(e,t,a,n,r)=>{d()&&!e&&setTimeout((()=>{chrome.tabs.sendMessage(r.tabId,{type:"RUN_JS",value:a.overrideJs},{frameId:0})}),500)}]];async function pe(e,t){if(!c()){try{await chrome.userScripts.unregister()}catch{return}t||e.filter((e=>e.condition)).forEach((e=>{const t=(e.condition.parts??[]).filter((e=>!e.disabled&&"REGEX"!==e.type));if(!(e.enabled&&"JS"===e.type&&t.length&&e.overrideJs?.trim()))return;const a=t.map((e=>"CONTAINS"===e.type?`*${e.valueContains}*`:`*${e.valueStartsWith}`));chrome.userScripts.register([{id:e.id,matches:["https://test.invalid/"],[e.condition.block?"excludeGlobs":"includeGlobs"]:a,js:[{code:e.overrideJs}],world:"MAIN"}])}))}}async function he(e,t){if(e.frameId||!e.tabId||!e.url?.startsWith("http"))return;const a=await fe.es.getAllUnsafe(),n=function(e){return e["g:superDisable"]?[]:(e["g:rules"]||[]).filter((e=>e.enabled&&e.condition?.parts.some((e=>!e.disabled))))}(a);if(!n.length)return;let r={},i={};const o=new Set(g.map((t=>`r:${e.tabId}:${t}`)));let s;for(let l of n){const n=`s:ro:${e.tabId}:${l.id}`,d=a[n];let c=P(e.url,l.condition,!1);if(c&&l.titleRestrict&&!e.frameId&&(void 0===s&&(await f(2500),s=(await chrome.tabs.get(e.tabId)).title||null),s&&be(s.toLowerCase(),l.titleRestrict)||(c=!1)),c){r[n]=new URL(e.url).hostname;let a=!d||ge("JS"===l.type?_.EVERY_COMMIT:l.strictness||_.DIFFERENT_HOST,d,r[n],t)?r:i;me.find((([e])=>e.includes(l.type)))?.[1](a===i,e.tabId,l,a,e)}else a[n]&&o.add(n)}const l=Object.keys(r);[...l,...Object.keys(i)].forEach((e=>o.delete(e))),o.size&&fe.es.set(m([...o],null)),l.length&&fe.es.set(r)}function be(e,t){return!t||t.toLowerCase().split(/,+\s+/).some((t=>e.includes(t)))}function ge(e,t,a,n){return e===_.DIFFERENT_HOST?n&&a!==t:e===_.EVERY_COMMIT?n:e===_.EVERY_NAVIGATION}s=s??navigator.userAgent.includes("Mac OS"),s&&c()||!chrome.webNavigation?.onCommitted||!chrome.webNavigation.onHistoryStateUpdated||(chrome.webNavigation.onCommitted.addListener((e=>he(e,!0))),chrome.webNavigation.onHistoryStateUpdated.addListener((e=>he(e))),fe.es.addWatcher([],(async function(e){if(!e["g:rules"]&&!e["g:superDisable"])return;const t=await fe.es.getAllUnsafe();pe(t["g:rules"]||[],t["g:superDisable"])})),fe.sess.safeCbs.add((async()=>{const e=await fe.es.getAllUnsafe();pe(e["g:rules"]||[],e["g:superDisable"])})));var ye=a(5739).$;let ve=[...M,"isPinned"];const we=R()((async function(e){let t=await ye.es.getAllUnsafe();if(t["g:superDisable"])return void chrome.runtime.sendMessage({type:"OFFSCREEN_PUSH",superDisable:!0});const a=t["s:captured"]||[];if(0==a.length)return;const n=function(e,t,a){let n=[];for(let r of a)(ve.some((t=>e[`t:${r}:${t}`]||e[`r:${r}:${t}`]))||!t[`t:${r}:isPinned`]&&M.some((t=>e[`g:${t}`])))&&n.push(r);return n}(e,t,a);if(n.length){const e=await Promise.all(n.map((e=>V(M,e).then((t=>({view:t,tabId:e}))))));chrome.runtime.sendMessage({type:"OFFSCREEN_PUSH",updates:e})}}),500,{maxWait:500,leading:!0,trailing:!0});function Ie(e){if(e)return{tabId:e.id,frameId:0,windowId:e.windowId}}async function Se(e,t){try{const a=await chrome.tabs.get(e);return!a.frozen&&(a.discarded?null:(await chrome.tabs.sendMessage(e,{type:"CS_ALIVE"},{frameId:t||0}),!0))}catch(e){}}chrome.tabCapture&&chrome.offscreen&&ye.es.addWatcher([],we);var Me=Symbol.for("immer-nothing"),xe=Symbol.for("immer-draftable"),Ee=Symbol.for("immer-state");function Te(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var ke=Object.getPrototypeOf;function _e(e){return!!e&&!!e[Ee]}function Ce(e){return!!e&&(Fe(e)||Array.isArray(e)||!!e[xe]||!!e.constructor?.[xe]||Ne(e)||$e(e))}var Ae=Object.prototype.constructor.toString();function Fe(e){if(!e||"object"!=typeof e)return!1;const t=ke(e);if(null===t)return!0;const a=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return a===Object||"function"==typeof a&&Function.toString.call(a)===Ae}function Oe(e,t){0===Pe(e)?Reflect.ownKeys(e).forEach((a=>{t(a,e[a],e)})):e.forEach(((a,n)=>t(n,a,e)))}function Pe(e){const t=e[Ee];return t?t.type_:Array.isArray(e)?1:Ne(e)?2:$e(e)?3:0}function De(e,t){return 2===Pe(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Re(e,t,a){const n=Pe(e);2===n?e.set(t,a):3===n?e.add(a):e[t]=a}function Ne(e){return e instanceof Map}function $e(e){return e instanceof Set}function Le(e){return e.copy_||e.base_}function je(e,t){if(Ne(e))return new Map(e);if($e(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const a=Fe(e);if(!0===t||"class_only"===t&&!a){const t=Object.getOwnPropertyDescriptors(e);delete t[Ee];let a=Reflect.ownKeys(t);for(let n=0;n<a.length;n++){const r=a[n],i=t[r];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[r]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[r]})}return Object.create(ke(e),t)}{const t=ke(e);if(null!==t&&a)return{...e};const n=Object.create(t);return Object.assign(n,e)}}function Ue(e,t=!1){return Ve(e)||_e(e)||!Ce(e)||(Pe(e)>1&&(e.set=e.add=e.clear=e.delete=Ge),Object.freeze(e),t&&Object.entries(e).forEach((([e,t])=>Ue(t,!0)))),e}function Ge(){Te(2)}function Ve(e){return Object.isFrozen(e)}var Be,We={};function Xe(e){const t=We[e];return t||Te(0),t}function qe(){return Be}function ze(e,t){t&&(Xe("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Ke(e){He(e),e.drafts_.forEach(Je),e.drafts_=null}function He(e){e===Be&&(Be=e.parent_)}function Ye(e){return Be={drafts_:[],parent_:Be,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Je(e){const t=e[Ee];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Qe(e,t){t.unfinalizedDrafts_=t.drafts_.length;const a=t.drafts_[0];return void 0!==e&&e!==a?(a[Ee].modified_&&(Ke(t),Te(4)),Ce(e)&&(e=Ze(t,e),t.parent_||tt(t,e)),t.patches_&&Xe("Patches").generateReplacementPatches_(a[Ee].base_,e,t.patches_,t.inversePatches_)):e=Ze(t,a,[]),Ke(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Me?e:void 0}function Ze(e,t,a){if(Ve(t))return t;const n=t[Ee];if(!n)return Oe(t,((r,i)=>et(e,n,t,r,i,a))),t;if(n.scope_!==e)return t;if(!n.modified_)return tt(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const t=n.copy_;let r=t,i=!1;3===n.type_&&(r=new Set(t),t.clear(),i=!0),Oe(r,((r,o)=>et(e,n,t,r,o,a,i))),tt(e,t,!1),a&&e.patches_&&Xe("Patches").generatePatches_(n,a,e.patches_,e.inversePatches_)}return n.copy_}function et(e,t,a,n,r,i,o){if(_e(r)){const o=Ze(e,r,i&&t&&3!==t.type_&&!De(t.assigned_,n)?i.concat(n):void 0);if(Re(a,n,o),!_e(o))return;e.canAutoFreeze_=!1}else o&&a.add(r);if(Ce(r)&&!Ve(r)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Ze(e,r),t&&t.scope_.parent_||"symbol"==typeof n||!Object.prototype.propertyIsEnumerable.call(a,n)||tt(e,r)}}function tt(e,t,a=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Ue(t,a)}var at={get(e,t){if(t===Ee)return e;const a=Le(e);if(!De(a,t))return function(e,t,a){const n=it(t,a);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}(e,a,t);const n=a[t];return e.finalized_||!Ce(n)?n:n===rt(e.base_,t)?(st(e),e.copy_[t]=lt(n,e)):n},has:(e,t)=>t in Le(e),ownKeys:e=>Reflect.ownKeys(Le(e)),set(e,t,a){const n=it(Le(e),t);if(n?.set)return n.set.call(e.draft_,a),!0;if(!e.modified_){const n=rt(Le(e),t),o=n?.[Ee];if(o&&o.base_===a)return e.copy_[t]=a,e.assigned_[t]=!1,!0;if(((r=a)===(i=n)?0!==r||1/r==1/i:r!=r&&i!=i)&&(void 0!==a||De(e.base_,t)))return!0;st(e),ot(e)}var r,i;return e.copy_[t]===a&&(void 0!==a||t in e.copy_)||Number.isNaN(a)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=a,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==rt(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,st(e),ot(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const a=Le(e),n=Reflect.getOwnPropertyDescriptor(a,t);return n?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:n.enumerable,value:a[t]}:n},defineProperty(){Te(11)},getPrototypeOf:e=>ke(e.base_),setPrototypeOf(){Te(12)}},nt={};function rt(e,t){const a=e[Ee];return(a?Le(a):e)[t]}function it(e,t){if(!(t in e))return;let a=ke(e);for(;a;){const e=Object.getOwnPropertyDescriptor(a,t);if(e)return e;a=ke(a)}}function ot(e){e.modified_||(e.modified_=!0,e.parent_&&ot(e.parent_))}function st(e){e.copy_||(e.copy_=je(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function lt(e,t){const a=Ne(e)?Xe("MapSet").proxyMap_(e,t):$e(e)?Xe("MapSet").proxySet_(e,t):function(e,t){const a=Array.isArray(e),n={type_:a?1:0,scope_:t?t.scope_:qe(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=n,i=at;a&&(r=[n],i=nt);const{revoke:o,proxy:s}=Proxy.revocable(r,i);return n.draft_=s,n.revoke_=o,s}(e,t);return(t?t.scope_:qe()).drafts_.push(a),a}function dt(e){if(!Ce(e)||Ve(e))return e;const t=e[Ee];let a;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,a=je(e,t.scope_.immer_.useStrictShallowCopy_)}else a=je(e,!0);return Oe(a,((e,t)=>{Re(a,e,dt(t))})),t&&(t.finalized_=!1),a}Oe(at,((e,t)=>{nt[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),nt.deleteProperty=function(e,t){return nt.set.call(this,e,t,void 0)},nt.set=function(e,t,a){return at.set.call(this,e[0],t,a,e[0])};var ct=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,a)=>{if("function"==typeof e&&"function"!=typeof t){const a=t;t=e;const n=this;return function(e=a,...r){return n.produce(e,(e=>t.call(this,e,...r)))}}let n;if("function"!=typeof t&&Te(6),void 0!==a&&"function"!=typeof a&&Te(7),Ce(e)){const r=Ye(this),i=lt(e,void 0);let o=!0;try{n=t(i),o=!1}finally{o?Ke(r):He(r)}return ze(r,a),Qe(n,r)}if(!e||"object"!=typeof e){if(n=t(e),void 0===n&&(n=e),n===Me&&(n=void 0),this.autoFreeze_&&Ue(n,!0),a){const t=[],r=[];Xe("Patches").generateReplacementPatches_(e,n,t,r),a(t,r)}return n}Te(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...a)=>this.produceWithPatches(t,(t=>e(t,...a)));let a,n;return[this.produce(e,t,((e,t)=>{a=e,n=t})),a,n]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){var t;Ce(e)||Te(8),_e(e)&&(_e(t=e)||Te(10),e=dt(t));const a=Ye(this),n=lt(e,void 0);return n[Ee].isManual_=!0,He(a),n}finishDraft(e,t){const a=e&&e[Ee];a&&a.isManual_||Te(9);const{scope_:n}=a;return ze(n,t),Qe(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let a;for(a=t.length-1;a>=0;a--){const n=t[a];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}a>-1&&(t=t.slice(a+1));const n=Xe("Patches").applyPatches_;return _e(e)?n(e,t):this.produce(e,(e=>n(e,t)))}},ut=ct.produce;function ft(e){const t=[];return e?.forEach((e=>{e.media?.forEach((a=>{t.push({...a,...e})}))})),t}async function mt(){const e=await async function(){const e=await chrome.storage.session.get();let t,a=[];for(let n in e)n.startsWith("m:")&&(n.startsWith("m:pin")?t=e[n]:n.startsWith("m:scope:")&&a.push(e[n]));return{pinned:t,scopes:a}}();return{pinned:e.pinned,infos:ft(e.scopes)}}async function pt(e,t){let[{ignorePiP:a},{infos:n,pinned:r}]=await Promise.all([V({ignorePiP:!0}),mt()]);n=n.filter((e=>e.readyState)),n=t?n.filter((e=>e.videoSize)):n;const i=n.find((e=>e.key===r?.key));if(i&&await Se(i.tabInfo.tabId,i.tabInfo.frameId))return i;n.sort(((e,t)=>t.creationTime-e.creationTime));let o=n.find((e=>e.pipMode))||n.find((e=>e.isDip));if(o&&!await Se(o.tabInfo.tabId,o.tabInfo.frameId)&&(o=null),!a&&o)return o;if(!e)return o||void 0;if(n=n.filter((t=>t.tabInfo.tabId===e.tabId)),!n.length)return o||void 0;let s,l=n.filter((e=>null!=e.intersectionRatio)).sort(((e,t)=>t.intersectionRatio-e.intersectionRatio))[0]?.intersectionRatio;return n.forEach((t=>{let a=0;var n,r;n=t.tabInfo,r=e,n?.tabId===r?.tabId&&(n?.frameId??null)===(r?.frameId??null)&&0!==e.frameId&&(a+=32),t.intersectionRatio>.05&&t.intersectionRatio===l?a+=16:t.intersectionRatio>.9?a+=8:t.intersectionRatio>.5?a+=4:t.intersectionRatio>.1&&(a+=2),t.isVisible&&(a+=16),t.elementSize&&t.elementSize.w>200&&t.elementSize.h>200&&(a+=8),(t.infinity||t.duration>=1800)&&(a+=8),t.duration>=600&&(a+=4),t.duration>=180&&(a+=2),t.duration>=60&&(a+=1),!t.isVideo||t.isConnected||t.hasAudioTrack||(a=-1),(!s||a>s.score||a===s.score&&(t.infinity?60:t.duration)>s.info.duration)&&(s={info:t,score:a})})),s?.info}ct.produceWithPatches.bind(ct),ct.setAutoFreeze.bind(ct),ct.setUseStrictShallowCopy.bind(ct),ct.applyPatches.bind(ct),ct.createDraft.bind(ct),ct.finishDraft.bind(ct);const ht=chrome.runtime.getURL("offscreen.html");async function bt(){return!!(await chrome.runtime.getContexts({contextTypes:["OFFSCREEN_DOCUMENT"],documentUrls:[ht]})).length}async function gt(e){await async function(){await bt()||await chrome.offscreen.createDocument({url:ht,reasons:[chrome.offscreen.Reason.USER_MEDIA],justification:"For audio effects like volume gain, pitch shift, etc."})}();try{const[t,a]=await Promise.all([chrome.tabCapture.getMediaStreamId({targetTabId:e}),V(M,e)]);return chrome.runtime.sendMessage({type:"CAPTURE",streamId:t,tabId:e,view:a})}catch(e){return!e?.message?.includes("invoked")}}async function yt(e){await bt()&&chrome.runtime.sendMessage({type:"CAPTURE",tabId:e})}async function vt(e){return!!await bt()&&chrome.runtime.sendMessage({type:"REQUEST_CAPTURE_STATUS",tabId:e})}let wt;class It{started=Date.now();softMax=Date.now()+6e5;constructor(e){this.softMax=this.started+6e4*e,this.intervalId=setInterval(this.handleInterval,2e4)}release=()=>{clearInterval(this.intervalId)};handleInterval=async()=>{const e=Date.now();(e>this.softMax||e>this.hardMax)&&this.release(),await chrome.storage.local.get("g:version")};static start(e){if(It.keepAlive){if(It.keepAlive.softMax-Date.now()>6e4*e)return;It.keepAlive.release(),delete It.keepAlive}It.keepAlive=new It(e)}static clear(){It.keepAlive?.release(),delete It.keepAlive}}var St=a(5739).$;let Mt;class xt{shortcutHideIndicator=!1;stopped=!1;itcList=[];immediateItc=!1;constructor(e,t){this.matches=e,this.tabInfo=t,this.init()}stop=()=>{this.stopped=!0};init=async()=>{this.globalHideIndicator=(await St.es.getAllUnsafe())["g:hideIndicator"],this.immediateItc=this.matches.some((e=>"nothing"===e.kb.command&&null!=e.kb.valueNumber));for(let e of this.matches){if(this.stopped)return;await this.processKeybindMatch(e)}this.flushItcList()};fetch=async e=>V(e,this.tabInfo?.tabId);push=async(e,t)=>B({override:e,tabId:this.tabInfo?.tabId,...t??null});show=async e=>{this.tabInfo&&(this.shortcutHideIndicator||O({type:"SHOW_INDICATOR",opts:e,requiresFocus:null==this.tabInfo.frameId},this.tabInfo.tabId,0))};processItc=e=>{this.immediateItc?this.sendItcs([e]):this.itcList.push(e)};flushItcList=()=>{this.itcList.length&&(this.sendItcs(this.itcList),this.itcList=[])};sendItcs=e=>{chrome.tabs.sendMessage(this.tabInfo.tabId,{type:"ITC",inits:e})};applyToMedia=async(e,t=!1)=>{const a=await this.getMediaAny(t);a&&F(e,a.key,a.tabInfo.tabId,a.tabInfo.frameId)};getMediaAny=async(e=!1)=>(this.loadedMedia||(this.loadedMedia={value:await pt(this.tabInfo,e)}),this.loadedMedia.value);getMediaVideo=async()=>(this.loadedMediaVideo||(this.loadedMediaVideo={value:await pt(this.tabInfo,!0)}),this.loadedMediaVideo.value);autoCaptureWithCheck=(e,t)=>{"adjustMode"===e.valueType&&t?.toFixed(6)!==e.ref.default.toFixed(6)&&this.autoCapture()};autoCapture=()=>{null!=this.tabInfo?.tabId&&gt(this.tabInfo.tabId)};processKeybindMatch=async e=>{let t,a=e.kb,n=ae[a.command];if(n.requiresVideo){if(t=await this.getMediaVideo(),!t)return}else if(n.requiresMedia&&(t=await this.getMediaAny(),!t))return;let r={};this.shortcutHideIndicator=a.invertIndicator?!this.globalHideIndicator:this.globalHideIndicator,await kt[a.command]({media:t,override:r,commandInfo:n,kb:a,isAlt:e.alt,...this}),Object.keys(r).length&&await B({override:r,tabId:this.tabInfo?.tabId})}}let Et={},Tt={};const kt={nothing:async e=>{if(!(e.kb.valueNumber>0))return;const t=Date.now();let a=e.kb.valueNumber;if(a<.35){let n=t-Tt[e.kb.id];(n>300||isNaN(n))&&(a=.35),Tt[e.kb.id]=t}let n=Symbol();Et[e.kb.id]=n,a>10&&It.start(a/60+.5),await f(1e3*a),Et[e.kb.id]!==n&&e.stop()},runCode:async e=>{const{kb:t,tabInfo:a}=e;if(a&&await Se(a.tabId,a.frameId||0))if(d())chrome.tabs.sendMessage(a.tabId,{type:"RUN_JS",value:t.valueString},{frameId:0});else try{chrome.userScripts.execute({injectImmediately:!0,js:[{code:t.valueString}],world:"MAIN",target:{tabId:a.tabId,frameIds:[0]}})}catch{}},openUrl:async e=>{const{kb:t,tabInfo:a}=e;let n=t.valueString;if("sameTab"===t.valueUrlMode){if(!a)return;return void chrome.tabs.update(a.tabId,{url:n})}let r="fgTab"===(t.valueUrlMode||"fgTab");if(r||"bgTab"===t.valueUrlMode){let e=a?.tabId?(await chrome.tabs.get(a.tabId)).index+1:void 0;return void chrome.tabs.create({url:n,index:e,active:r})}let i="newPopup"===t.valueUrlMode;(i||"newWindow"===t.valueUrlMode)&&chrome.windows.create({url:n,type:i?"popup":"normal",...t.valuePopupRect||{}})},intoPopup:async e=>{const{kb:t,tabInfo:a}=e;if(!a.tabId)return;const n=await chrome.tabs.get(a.tabId),r=await chrome.windows.get(n.windowId),i=`s:popup:${n.id}`;if("popup"===r.type){let e=(await chrome.storage.session.get(i))[i];if(await chrome.windows.create({tabId:n.id,type:"normal",state:"normal",...e?{width:50,height:50}:{}}),!e)return;try{await chrome.windows.get(e.windowId)}catch(e){return}return await chrome.tabs.move(n.id,{windowId:e.windowId,index:e.index}),void chrome.tabs.update(n.id,{active:!0})}chrome.storage.session.set({[i]:{windowId:r.id,index:n.index,state:r.state}}),await chrome.windows.create({type:"popup",tabId:n.id,...t.valuePopupRect||{}})},muteTab:async e=>{if(!e.tabInfo?.tabId)return;let t=e.tabInfo.tabId;const a=(await chrome.tabs.get(t))?.mutedInfo?.muted;e.show({text:a?"100%":"0%"}),chrome.tabs.update(t,{muted:!a})},state:async e=>{const{kb:t,show:a,override:n,fetch:r}=e,i=await r({enabled:!0,latestViaShortcut:!0});n.latestViaShortcut=!0,"off"===t.valueState||"toggle"===t.valueState&&i.enabled?n.enabled=!1:n.enabled=!0,a({text:" "+(n.enabled?"on":"off"),icons:["power"]})},pin:async e=>{const{kb:t,tabInfo:a,override:n,show:r,fetch:i}=e;if(!a)return;const o=await i({isPinned:!0});"off"===t.valueState||"toggle"===t.valueState&&o.isPinned?n.isPinned=!1:n.isPinned=!0,r({text:n.isPinned?"local":"global",small:!0})},speed:async e=>_t(e),temporarySpeed:async({media:e,show:t,kb:a,commandInfo:n})=>{const i=r(a.valueNumber||n.ref.default,2);t({text:`${i}x`}),function(e,t){chrome.tabs.sendMessage(e.tabInfo.tabId,{type:"SET_TEMPORARY_SPEED",factor:t},{frameId:e.tabInfo.frameId}),clearTimeout(Pt),Pt=setTimeout((()=>{chrome.tabs.sendMessage(e.tabInfo.tabId,{type:"SET_TEMPORARY_SPEED"},{frameId:e.tabInfo.frameId})}),150)}(e,i)},speedChangesPitch:async e=>{const{kb:t,show:a,override:n,fetch:r}=e,i=await r({freePitch:!0});"off"===t.valueState||"toggle"===t.valueState&&i.freePitch?n.freePitch=!1:n.freePitch=!0,a({text:" "+(n.freePitch?"on":"off"),icons:["speedChangesPitch"]})},seek:async e=>_t(e),pause:async e=>{const{kb:t,media:a,applyToMedia:n,show:r}=e;"off"===t.valueState||"toggle"===t.valueState&&a.paused?r({icons:["play"]}):r({icons:["pause"]}),n({type:"PAUSE",state:t.valueState})},mute:async e=>{const{kb:t,media:a,applyToMedia:n,show:r}=e;"off"===t.valueState||"toggle"===t.valueState&&a.muted?r({text:`${Math.round(100*a.volume)}%`}):r({text:"0%"}),n({type:"MUTE",state:t.valueState})},volume:async e=>_t(e),setMark:async e=>{const{kb:t,applyToMedia:a,show:n}=e;let r=` ${t.valueString}`,i=["bookmark"];switch(t.valueString?.toLowerCase()){case"::nameless":r=" nameless";break;case"::nameless-prev":r=" prev",i=["arrowLeft"];break;case"::nameless-next":r=" next",i=["arrowRight"]}n({icons:i,text:r,small:!0}),a({type:"SET_MARK",key:t.valueString})},seekMark:async e=>{const{media:t,kb:a,applyToMedia:n,show:r}=e;let i,o=t.marks.includes(a.valueString);if(!o){let e=`s:mark:${a.valueString}:${await async function(e,t=6){return(await async function(e,t){return wt=wt??new TextEncoder,e=`${e}:${t}`,a=await crypto.subtle.digest("sha-1",wt.encode(e)),Array.from(new Uint8Array(a)).map((e=>e.toString(16).padStart(2,"0"))).join("");var a}(e,await async function(){let e=(await chrome.storage.local.get("f:salt"))["f:salt"];return e||(e=crypto.randomUUID().slice(0,18).replaceAll("-",""),await chrome.storage.local.set({"f:salt":e})),e}())).slice(0,t??99)}(t.domain,6)}`;const n=(await chrome.storage.session.get(e))[e];n&&Math.abs(t.duration-n.duration)<2&&(i=n.current,o=!0)}r({icons:o?["arrowRight"]:["bookmark"],text:` ${a.valueString}`,small:!0}),n({type:"SEEK_MARK",key:i??a.valueString,fast:a.fastSeek})},loopEntire:async e=>{const{media:t,kb:a,applyToMedia:n,show:r}=e;let i=!(await chrome.tabs.sendMessage(t.tabInfo.tabId,{type:"MEDIA_PROBE",key:t.key},{frameId:t.tabInfo.frameId||0})).fullyLooped&&"toggle"===a.valueState||"on"===a.valueState;r({icons:["loop"],text:" "+(i?"on":"off"),small:!0}),n({type:"LOOP_ENTIRE",key:t.key,state:i?"on":"off"})},loop:async e=>{const{media:t,kb:a,applyToMedia:n,show:r}=e;if(t.marks.includes(a.valueString))return r({icons:["loop"],text:" "+(t.inLoop?"off":"on"),small:!0}),void n({type:"TOGGLE_LOOP",key:a.valueString,indicator:!e.shortcutHideIndicator,ignoreNavigate:a.ignoreNavigate});r({icons:["loop"],text:` ${a.valueString}???`,small:!0})},skip:async e=>{const{media:t,kb:a,applyToMedia:n,show:r}=e;if(t.marks.includes(a.valueString))return r({icons:["skip"],text:" "+(t.inSkip?"off":"on"),small:!0}),void n({type:"TOGGLE_LOOP",key:a.valueString,skipMode:!0,indicator:!e.shortcutHideIndicator,ignoreNavigate:a.ignoreNavigate});r({icons:["skip"],text:` ${a.valueString}???`,small:!0})},fullscreen:async e=>{const{kb:t,applyToMedia:a,media:n,tabInfo:r,fetch:i}=e;let o=!1;if(chrome.offscreen&&chrome.tabCapture&&!n.fsMode&&await vt(r.tabId)){let e=await i({audioFx:!0,audioFxAlt:!0});e.audioFx&&(0!==e.audioFx.pitch||1!==e.audioFx.volume||0!==e.audioFx.delay||e.audioFx.eq.enabled)&&(o=!0,await yt(r.tabId),await f(100))}a({type:"FULLSCREEN",direct:t.direct}),o&&(await f(250),await gt(r.tabId))},PiP:async e=>{const{kb:t,applyToMedia:a}=e;a({type:"PIP",state:t.valueState})},cinema:async e=>{const{kb:t,applyToMedia:a,media:n}=e,r={type:"CINEMA",state:t.valueState,init:t.cinemaInit};n.tabInfo.frameId>0&&await chrome.tabs.sendMessage(n.tabInfo.tabId,{type:"CINEMA",event:r},{frameId:0}),a(r)},mediaInfo:async({applyToMedia:e})=>{e({type:"MEDIA_INFO"})},fxState:async e=>{const{kb:t,fetch:a,override:n,show:r}=e;let i=await a({elementFx:!0,backdropFx:!0});const o=A(t.filterTarget);if(o.element){i.elementFx=i.elementFx??ce();const e="on"===t.valueState||"toggle"===t.valueState&&!i.elementFx.enabled;n.elementFx={...i.elementFx,enabled:e}}if(o.backdrop){i.backdropFx=i.backdropFx??ce();const e="on"===t.valueState||"toggle"===t.valueState&&!i.backdropFx.enabled;n.backdropFx={...i.backdropFx,enabled:e}}r({icons:["power"]})},fxReset:async e=>{const{kb:t,show:a,override:n}=e,r=A(t.filterTarget);r.element&&(n.elementFx=null),r.backdrop&&(n.backdropFx=null)},fxSwap:async e=>{const{fetch:t,show:a,override:n}=e,r=await t({backdropFx:!0,elementFx:!0});n.elementFx=r.backdropFx,n.backdropFx=r.elementFx,a({icons:["swap"]})},fxFilter:async e=>_t(e),drawPage:async e=>{const{tabInfo:t}=e;t&&chrome.scripting.executeScript({target:{tabId:t.tabId,allFrames:!1},files:["pageDraw.js"]})},afxPitch:async e=>_t(e),afxGain:async e=>_t(e),afxDelay:async e=>_t(e),afxPan:async e=>_t(e),afxMono:async e=>{const{kb:t,fetch:a,show:n,override:r,autoCapture:i}=e,o=await a({monoOutput:!0});"off"===t.valueState||"toggle"===t.valueState&&o.monoOutput?r.monoOutput=!1:r.monoOutput=!0,r.monoOutput&&i(),n({text:" "+(r.monoOutput?"on":"off")})},afxCapture:async e=>{const{kb:t,show:a,tabInfo:n}=e;if(!n)return;let r="off";const i=await vt(n.tabId);try{"off"===t.valueState?yt(n.tabId):"on"===t.valueState?(gt(n.tabId),r="on"):(i?yt(n.tabId):gt(n.tabId),r=i?"off":"on")}catch(e){return}a({text:r})},afxReset:async e=>{const{show:t,tabInfo:a,override:n}=e;a&&(await vt(a.tabId)?yt(a.tabId):gt(a.tabId),n.audioFx=ue(),n.audioFxAlt=n.audioPan=null,t({icons:["reset"]}))}};async function _t(e){const{fetch:a,override:n,kb:i,commandInfo:o,show:s,media:l,applyToMedia:d,tabInfo:c}=e,f=i.adjustMode||x.SET;if(f===x.ITC||f===x.ITC_REL){let t=await async function(e){const{kb:t,commandInfo:a,tabInfo:n,media:r}=e,i=a.ref||a.getRef(a,t);let o={relative:t.adjustMode===x.ITC_REL,seekOnce:t.seekOnce,resetTo:i.reset??i.default,min:i.min,max:i.max,sliderMin:t.valueItcMin??i.sliderMin,sliderMax:t.valueItcMax??i.sliderMax,step:t.valueNumber??i.itcStep,shouldShow:!e.shortcutHideIndicator,dontReleaseKeyUp:(t.trigger||T.LOCAL)===T.LOCAL?t.noHold:void 0,kb:t};if("seek"===t.command||"volume"===t.command){if(!n||!r.duration)return;delete o.resetTo;let e=await chrome.tabs.sendMessage(r.tabInfo.tabId,{type:"MEDIA_PROBE",key:r.key},{frameId:r.tabInfo.frameId||0});if(!e)return;if(o.mediaKey=r.key,o.mediaTabInfo=r.tabInfo,o.mediaDuration=e.duration,"seek"===t.command){if(o.min=0,delete o.max,o.original=e.currentTime,o.wasPaused=e.paused,t.duration===E.PERCENT)o.sliderMin=o.sliderMin/100*e.duration,o.sliderMax=o.sliderMax/100*e.duration,o.step=o.step/100*e.duration;else if(t.duration===E.FRAMES){let t=1/(e.fps??24);o.sliderMin=o.sliderMin*t,o.sliderMax=o.sliderMax*t,o.step=o.step*t}o.relative&&t.relativeToSpeed&&(o.step=o.step*(r.playbackRate||1))}else o.original=e.volume}else{let t=await Ft(e);if(!t)return;null!=t.main&&(o.original=t.main),null!=t.secondary&&(o.originalAlt=t.secondary)}return o}(e);if(!t)return;return void chrome.tabs.sendMessage(c.tabId,{type:"ITC",inits:[t]})}const m=o.ref||o.getRef(o,i);let p,h=!1;if(f===x.SET){if(p=i.valueNumber??m.default,"speed"===i.command){let e=await a({speed:!0,lastSpeed:!0});i.skipToggleSpeed||e.speed?.toFixed(2)!==p.toFixed(2)||null==e.lastSpeed||(p=e.lastSpeed)}}else i.adjustMode===x.ADD?(p=i.valueNumber??m.step,h=!0):i.adjustMode===x.CYCLE&&(p=await async function(e){const{fetch:a,override:n,kb:r,isAlt:i}=e;let o=(await a({keybinds:!0})).keybinds||[];if(!r.valueCycle?.length)return null;const s=r.valueCycle.length;let l=(r.cycleIncrement??0)+(i?-1:1);return r.cycleNoWrap||(l<0?l=s-1:l>=s&&(l=0)),l=t(0,s-1,l),n.keybinds=ut(o,(e=>{e.find((e=>e.id===r.id)).cycleIncrement=l})),r.valueCycle?.[l]}(e));if(null==p||isNaN(p))throw Error("Value not NULL or NaN.");let b,g,y="",v="",w=[];if("seek"===i.command){let e=h?Math.abs(p):p;h?w.push(p<0?"arrowLeft":"arrowRight"):y="=";const t=1/(l.fps??24),a=l.duration/100;let n=p,o=function(e,t){if(e.adjustMode===x.ADD){let a=e.valueNumber??t?.step;if((e.duration||E.SECS)===E.SECS)return Math.abs(a)<.5;if(e.duration===E.FRAMES)return Math.abs(a)<14}}(i,m);if(i.duration===E.FRAMES?(n=p*t,v=` ${r(e,2)}f`):i.duration===E.PERCENT?(n=p*a,v=` ${r(e,0)}%`):v=` ${r(e,2)}`,h&&i.relativeToSpeed&&(n*=l.playbackRate),i.showNetDuration){const e=Date.now();let t=0;Mt&&Mt.key===l.key&&Mt.time+750>e&&(t=Mt.net),t+=n,Mt={key:l.key,time:e,net:t},v=u(t,!0),w=[]}return d({type:"SEEK",relative:h,value:n,fast:i.fastSeek,autoPause:o?!i.skipPauseSmall:i.autoPause,wraparound:i.wraparound}),void s({text:v||"",icons:w||[],preText:y||""})}if(h){let t=await Ft(e);if(!t)return;null!=(t.secondary??t.main)&&(b=p+(t.main??t.secondary),g=p+(t.secondary??t.main))}else b=g=p;await Ot({kb:i,mediaKey:l?.key,mediaTabInfo:l?.tabInfo,tabInfo:c,value:b,valueAlt:g,shouldShow:!e.shortcutHideIndicator,ref:m,wasDirect:!0})}const Ct=new Set(["afxPitch","afxGain","afxDelay","afxPan"]),At={afxPitch:"pitch",afxGain:"volume",afxDelay:"delay"};async function Ft(e){const{kb:t,media:a,fetch:n,commandInfo:r}=e;if("volume"===t.command)return{main:a.volume};if("speed"===t.command)return{main:(await n({speed:!0})).speed};if("fxFilter"===t.command){const e=await n({elementFx:!0,backdropFx:!0}),a=te[t.filterOption];return{main:(e.elementFx||ce())[a.isTransform?"transforms":"filters"].find((e=>e.name===t.filterOption)).value,secondary:(e.backdropFx||ce())[a.isTransform?"transforms":"filters"].find((e=>e.name===t.filterOption)).value}}if(Ct.has(t.command)){const e=await n({audioFx:!0,audioFxAlt:!0,audioPan:!0});if("afxPan"===t.command)return{main:e.audioPan??r.ref.default};let a=At[t.command];return{main:e.audioFx?e.audioFx[a]??r.ref.default:void 0,secondary:e.audioFxAlt?e.audioFxAlt[a]??r.ref.default:void 0}}}async function Ot(e){let{tabInfo:a,kb:i,mediaKey:o,mediaTabInfo:s,value:l,valueAlt:d,ref:c}=e;if(null==l&&null==d)return;const f=ae[i.command];c=c||f.ref||f.getRef?.(f,"seek"===i.command?{duration:E.SECS}:i);let m="seek"===i.command?e.mediaDuration:c.max,p=e.wasDirect?i.wraparound:i.itcWraparound;null!=l&&(l=c.wrappable&&e.wasRelative&&p&&null!=m&&null!=c.min?n(c.min,m,l):t(c.min,c.max,l)),null!=d&&(d=c.wrappable&&e.wasRelative&&p?n(c.min,c.max,d):t(c.min,c.max,d));let h={};if("speed"===i.command)h.lastSpeed=(await V({speed:!0},a.tabId)).speed,h.lastSpeed===l&&delete h.lastSpeed,h.speed=l;else if("volume"===i.command)e.dry||F({type:"SET_VOLUME",value:l,relative:!1},o,s.tabId,s.frameId);else if("seek"===i.command)e.dry||F({type:"SEEK",value:l,fast:i.fastSeek},o,s.tabId,s.frameId);else if("fxFilter"===i.command){const t=await V({elementFx:!0,backdropFx:!0},e.tabInfo?.tabId),{element:a,backdrop:n}=A(i.filterTarget),r=te[i.filterOption].isTransform?"transforms":"filters";a&&null!=l&&(h.elementFx=ut(t.elementFx||ce(),(e=>{e[r].find((e=>e.name===i.filterOption)).value=l,l.toFixed(6)!==c.default.toFixed(6)&&(e.enabled=!0)}))),n&&null!=d&&(h.backdropFx=ut(t.backdropFx||ce(),(e=>{e[r].find((e=>e.name===i.filterOption)).value=d,d.toFixed(6)!==c.default.toFixed(6)&&(e.enabled=!0)})))}else if("afxPan"===i.command){h.audioPan=l;let e=ae[i.command];l?.toFixed(6)!==e.ref.default.toFixed(6)&&gt(a.tabId)}else if(Ct.has(i.command)){const t=await V({audioFx:!0,audioFxAlt:!0},a?.tabId);let n=ae[i.command];(null!=l&&l?.toFixed(6)!==n.ref.default.toFixed(6)||null!=d&&d.toFixed(6)!==n.ref.default.toFixed(6))&&(e.dry||gt(a.tabId)),t.audioFx&&null!=l&&(h.audioFx=ut(t.audioFx,(e=>{e[At[i.command]]=l}))),t.audioFxAlt&&null!=d&&(h.audioFxAlt=ut(t.audioFxAlt,(e=>{e[At[i.command]]=d})))}!e.dry&&Object.keys(h)&&await B({override:h,tabId:a.tabId}),l=l??d;let b=`${r(l,2)}`,g=[];var y,v;"volume"===i.command||"afxGain"===i.command?b=`${r(100*l,0)}%`:"seek"===i.command?b=`${u(l)}`:"speed"===i.command&&(b.includes(".")||(b=`${b}.0`)),e.shouldShow&&b.length+g.length&&(y={text:b||"",icons:g||[],preText:""},v=a.tabId,O({type:"SHOW_INDICATOR",opts:y,showAlt:e.showAlt},v,0))}let Pt;const Dt=new Set(["ar","de","en","es","fr","id","it","ja","ko","ms","pl","pt_BR","ru","th","tr","uk","vi","zh_CN","zh_TW"]);var Rt=a(5739).$;async function Nt(){let e;try{let t=await async function(){const e=Object.entries(await chrome.storage.local.get());return{...Object.fromEntries(e.filter((([e])=>e.startsWith("g:"))).map((([e,t])=>[e.slice(2),t])))}}();t.version||(t=(await chrome.storage.local.get("config")).config),e=function(e){const t=e?.version,a=le();return!e||e.version<7?a:(7===e.version&&(e=function(e){return e.version=8,e.rules?.forEach((e=>{e.condition={parts:[{type:e.matchType||"CONTAINS",id:i(),value:e.match||""}]},delete e.matchType,delete e.match})),e}(e)),8===e.version&&(e=function(e){return e.version=9,e.keybinds?.forEach((e=>{"seek"===e.command&&(e.valueBool2=!0)})),e}(e)),9===e.version&&(e=function(e){return e.version=10,e.keybinds?.forEach((e=>{"preservePitch"===e.command&&(e.command="speedChangesPitch",e.valueState="on"===e.valueState?"off":"off"===e.valueState?"on":"toggle")})),e}(e)),10===e.version&&(e=function(e){const t={adjustSpeed:"speed",setPin:"pin",setState:"state",setPause:"pause",setMute:"mute",adjustVolume:"volume",toggleLoop:"loop",setFx:"fxState",resetFx:"fxReset",flipFx:"fxSwap",adjustFilter:"fxFilter",adjustGain:"afxGain",adjustPitch:"afxPitch",adjustDelay:"afxDelay",adjustPan:"afxPan",tabCapture:"afxCapture"},a=(e,t,a)=>{t&&!d()&&(e.parts="JS"===t.type?e.parts.filter((e=>"REGEX"!==e.type)):e.parts),e.parts.forEach((e=>{e.valueContains="CONTAINS"===e.type?e.value:String.raw`example.com`,e.valueStartsWith="STARTS_WITH"===e.type?e.value:String.raw`https://example.com`,e.valueRegex="REGEX"===e.type?e.value:String.raw`example\.com`,delete e.value})),e.matchAll&&e.parts.every((e=>e.inverse))?e.block=!0:!e.matchAll&&e.parts.every((e=>!e.inverse))||(t?t.enabled=!1:e.parts=[]),e.parts.forEach((e=>{delete e.inverse})),delete e.matchAll};e.version=11,e.rules?.forEach((e=>{"STATE"===e.type&&(e.type=e.overrideEnabled?"ON":"OFF"),e.condition&&a(e.condition,e),delete e.overrideEnabled,delete e.strict,delete e.initialLoadOnly})),e.common.latestViaShortcut=!e.common.enabledLatestViaPopup,delete e.common.enabledLatestViaPopup,e.keybinds=e.keybinds??[],e.keybinds.forEach((e=>{Object.hasOwn(t,e.command)&&(e.command=t[e.command])})),e.keybindsUrlCondition&&a(e.keybindsUrlCondition),e.keybinds.forEach((e=>{e.global&&(e.trigger=T.GLOBAL),e.condition&&(e.condition.parts?.length?a(e.condition):delete e.condition),e.adjustMode===x.ADD&&(e.valueNumber=e.valueNumberAlt),"seek"===e.command&&(e.valueBool&&(e.relativeToSpeed=!0),e.valueBool2&&(e.fastSeek=!0),e.valueBool3&&(e.autoPause=!0),e.adjustMode=x.ADD,e.valueBool4?(e.adjustMode=x.SET,e.duration=E.PERCENT,e.valueNumber=e.valueNumberAlt):Math.abs(e.valueNumber)<.05&&(e.duration=E.FRAMES,e.valueNumber=e.valueNumber<0?-1:1),delete e.valueBool,delete e.valueBool2,delete e.valueBool3,delete e.valueBool4),"volume"===e.command?e.adjustMode=x.ADD:"seekMark"===e.command?(e.valueBool2&&(e.fastSeek=!0),delete e.valueBool2):"fullscreen"===e.command&&(e.valueBool&&(e.direct=!0),delete e.valueBool),delete e.valueNumberAlt})),e.initialContext=e.inheritPreviousContext?1:2,delete e.staticOverlay;const n=e.common;return delete e.common,Object.assign(e,n),e}(e)),11===e.version&&(e=function(e,t){if(e.version=12,11===t){if(e.keybinds.some((e=>"speed"===e.command&&"KeyD"===e.key&&.1===e.valueNumber&&e.adjustMode===x.ADD))){let t=e.keybinds.find((e=>"speed"===e.command&&e.adjustMode===x.ADD&&"KeyA"===e.key&&null==e.valueNumber));t&&(t.valueNumber=-.1)}e.keybinds.filter((e=>"speed"===e.command&&0===e.valueNumber&&e.adjustMode===x.ADD)).forEach((e=>{e.command="nothing"}))}return e}(e,t)),e?.version!==a.version?a:(d()&&(e=function(e){return e.keybinds=e.keybinds.filter((e=>re.includes(e.command))),e}(e)),e=function(e){e.websitesAddedToUrlConditionsExclusion=e.websitesAddedToUrlConditionsExclusion||[];const t=new Set(e.websitesAddedToUrlConditionsExclusion);e.keybindsUrlCondition=e.keybindsUrlCondition||{block:!0,parts:[]};const a=e.keybindsUrlCondition;if(a.parts=a.parts||[],a.block)return ie.forEach((n=>{const r=oe(n);if(t.has(r))return;if(n.contains){if(a.parts.find((e=>e.valueContains===n.v&&"CONTAINS"===e.type)))return}else if(a.parts.find((e=>e.valueStartsWith===n.v&&"STARTS_WITH"===e.type)))return;e.websitesAddedToUrlConditionsExclusion.push(r);const i=se(n.v);n.contains&&(i.type="CONTAINS"),a.parts.push(i)})),e}(e)||e))}(t)}catch(e){console.log("ERROR",e)}e=e||le(),await async function(e,t=!0){const a=t?Object.fromEntries((await q(X)).map((e=>[e,null]))):{};for(let t in e)a[`g:${t}`]=e[t];return setTimeout((()=>{N(e.keybinds)}),100),chrome.storage.local.set(a)}(e),delete Rt.installPromise}async function $t(e,t,a){if(!(t=t||await V({pinByDefault:!0,initialContext:!0,customContext:!0})).pinByDefault)return;let n=a?null:e.openerTabId,r=t.initialContext??b.PREVIOUS,i=de(!0);r===b.NEW||(i=r===b.CUSTOM?t.customContext??i:await V(g,r===b.PREVIOUS?n??0:0)),B({override:{...i,isPinned:!0},tabId:e.id})}globalThis.gvar=Rt,Rt.sess.installCbs.add((()=>{Rt.installPromise=Nt()})),Rt.sess.safeCbs.add((async()=>{const e=await chrome.storage.local.get();let t=Object.keys(e).filter((t=>null==e[t]));t=[...t,...await q(W,e)],t.length&&await chrome.storage.local.remove(t),d()||async function(){const e=await chrome.tabs.query({url:["https://*/*","http://*/*"]})||[];for(let t of e)if(!t.frozen&&t.url)try{await chrome.scripting.executeScript({target:{tabId:t.id,allFrames:!0},files:["isolated.js"]})}catch(e){}}(),chrome.storage.session?.setAccessLevel?.({accessLevel:chrome.storage.AccessLevel.TRUSTED_AND_UNTRUSTED_CONTEXTS})})),Rt.sess.safeStartupCbs.add((async()=>{let e=await chrome.tabs.query({});const t=await V({pinByDefault:!0,initialContext:!0,customContext:!0});t.pinByDefault&&e.forEach((e=>$t(e,t,!0)))})),chrome.tabs.onRemoved.addListener((async e=>{const t=(await V(["rules"])).rules||[];chrome.storage.local.remove([...[...g,"isPinned"].map((t=>`t:${e}:${t}`)),...g.map((t=>`r:${e}:${t}`)),...t.map((t=>`s:ro:${e}:${t.id}`))]),chrome.storage.session.remove(`m:scope:${e}:0`),Math.random()>.95&&async function(){const[e,t]=await Promise.all([chrome.tabs.query({}),chrome.storage.session.get()]),a=new Set(e.map((e=>e.id))),n=[];for(let e in t){if(!e.startsWith("m:scope:"))return;if(a.has(t[e]?.tabInfo.tabId))return;n.push(e)}chrome.storage.session.remove(n)}()})),chrome.tabs.onCreated.addListener($t),!d()&&!c()&&chrome.commands?.onCommand.addListener((async(e,t)=>{const a=await V({enabled:!0,superDisable:!0,keybinds:!0,keybindsUrlCondition:!0,latestViaShortcut:!0});if(a.superDisable)return;let n=a.keybinds||[];if(!a.enabled&&(n=n.filter((e=>"state"===e.command&&e.enabled&&e.trigger===T.GLOBAL&&(a.latestViaShortcut||e.alwaysOn))),!n.length))return;let r=(i=e,n.filter((e=>e.enabled&&e.trigger===T.GLOBAL)).map((e=>(e.globalKey||"commandA")===i?{kb:e}:e.allowAlt&&e.adjustMode===x.CYCLE&&(e.globalKeyAlt||"commandA")===i?{kb:e,alt:!0}:void 0)).filter((e=>e)));var i;if(!r.length)return;let o=t?Ie(t):await async function(){let e=await chrome.tabs.query({active:!0,lastFocusedWindow:!0});const[t]=e;if(t)return{tabId:t.id,windowId:t.windowId,url:t.url}}();const s=o?.url||"";a.keybindsUrlCondition&&!P(s,a.keybindsUrlCondition,!0)||(r=r.filter((e=>!(e.kb.condition?.parts.length>0)||P(s,e.kb.condition,!0))),new xt(r,o))})),chrome.contextMenus?.onClicked.addListener((async(e,t)=>{const a=(n=(await V({keybinds:!0})).keybinds,r=e.menuItemId,n.filter((e=>e.enabled&&e.trigger===T.CONTEXT)).map((e=>e.id===r?{kb:e}:e.allowAlt&&e.adjustMode===x.CYCLE&&`ALT_${e.id}`===r?{kb:e,alt:!0}:void 0)).filter((e=>e)));var n,r;1===a.length&&new xt([a[0]],Ie(t))})),chrome.runtime.onMessage.addListener(((e,t,a)=>{if("REQUEST_TAB_INFO"===e.type)a({tabId:t.tab.id,frameId:t.frameId});else{if("GET_TOP_ORIGIN"===e.type)return chrome.tabs.get(t.tab.id).then((e=>{let t="";e.url&&(t=`${new URL(e.url).origin||""}/`),a(t.length>1?t:null)}),(e=>{a(null)})),!0;if("REQUEST_GSM"===e.type)return async function(){return async function(e){const t=await fetch(chrome.runtime.getURL(`locales/${e}.json`)),a=await t.json();return a._lang=e.replace("_","-"),a}(function(e){if(e&&Dt.has(e))return e;const t=new Set;for(let e of navigator.languages.map((e=>e.replace("-","_"))))t.add(e),t.add(e.split("_")[0]);return t.add("en"),[...t].find((e=>Dt.has(e)))}((await chrome.storage.local.get("g:language"))["g:language"]))}().then((e=>a(e)),(e=>a(null))),!0;if("REQUEST_CREATE_TAB"===e.type)chrome.tabs.create({url:e.url}),a(!0);else{if("REQUEST_PANE"===e.type)return chrome.scripting.executeScript({target:{tabId:t.tab.id},files:["pane.js"],injectImmediately:!0}).finally((()=>a(!0))),!0;if("TRIGGER_KEYBINDS"===e.type)V({keybinds:!0}).then((({keybinds:a})=>{let n=e.ids.map((e=>{let t=a.find((t=>t.id===e.id));return t?{kb:t,alt:e.alt}:null}));new xt(n,{tabId:t.tab.id,frameId:t.frameId,windowId:t.tab.windowId})})),a(!0);else if("SET_SESSION"===e.type)chrome.storage.session.set(e.override);else{if("GET_SESSION"===e.type)return chrome.storage.session.get(e.keys).then((e=>a(e)),(e=>a(null))),!0;if("SET_LOCAL"===e.type)Rt.es.set(e.override);else{if("GET_LOCAL"===e.type)return Rt.es.get(e.keys).then((e=>a(e)),(e=>a(null))),!0;if("INSERT_CSS"===e.type)chrome.scripting.insertCSS({css:e.value,target:{tabId:t.tab.id,frameIds:[t.frameId]}});else if("SYNC_CONTEXT_MENUS"===e.type)e.direct?N():j();else if("SEND_MEDIA_EVENT_TO"===e.type)a(!0),chrome.tabs.sendMessage(e.tabId,{type:"APPLY_MEDIA_EVENT",event:e.event,key:e.key},{frameId:e.frameId||0});else if("SET_STATEFUL"===e.type)a(!0),Ot(e.init);else{if("REQUEST_TOP_FRAME_URL"===e.type)return chrome.tabs.sendMessage(t.tab.id,{type:"REQUEST_TOP_FRAME_URL"},{frameId:0},(e=>{chrome.tabs.sendMessage(t.tab.id,{type:"TOP_FRAME_URL_UPDATE",value:e.value},{frameId:t.frameId})})),void a(!0);"REQUEST_NOTIFY_TOP_FRAME_URL_CHANGE"===e.type&&(a(!0),chrome.webNavigation?.getAllFrames({tabId:t.tab.id},(a=>{a.map((e=>e.frameId)).filter((e=>e)).forEach((a=>{chrome.tabs.sendMessage(t.tab.id,{type:"TOP_FRAME_URL_UPDATE",value:e.value},{frameId:a})}))})))}}}}}}));const Lt=["g:speed","g:freePitch","g:enabled","g:superDisable"];Rt.es.addWatcher([],(async e=>{if(!Lt.some((t=>e[t])))return;const t=await Rt.es.getAllUnsafe();let a={speed:t["g:speed"],freePitch:t["g:freePitch"]};!t["g:superDisable"]&&t["g:enabled"]||(a=null),(await chrome.tabs.query({audible:!0,active:!1})).forEach((e=>{t[`t:${e.id}:isPinned`]||t[`r:${e.id}:speed`]||!1===t[`r:${e.id}:enabled`]||chrome.tabs.sendMessage(e.id,{type:"BG_SPEED_OVERRIDE",value:a})}))}))})()})();
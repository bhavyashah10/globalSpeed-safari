(()=>{var e={5739:(e,t,i)=>{"use strict";i.d(t,{$:()=>s});const s=globalThis.gvar??{}},181:(e,t,i)=>{var s=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,r=/^0o[0-7]+$/i,a=parseInt,l="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,d="object"==typeof self&&self&&self.Object===Object&&self,h=l||d||Function("return this")(),c=Object.prototype.toString,u=Math.max,p=Math.min,m=function(){return h.Date.now()};function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(f(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=f(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var i=o.test(e);return i||r.test(e)?a(e.slice(2),i?2:8):n.test(e)?NaN:+e}e.exports=function(e,t,i){var s,n,o,r,a,l,d=0,h=!1,c=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function w(t){var i=s,o=n;return s=n=void 0,d=t,r=e.apply(o,i)}function y(e){var i=e-l;return void 0===l||i>=t||i<0||c&&e-d>=o}function b(){var e=m();if(y(e))return C(e);a=setTimeout(b,function(e){var i=t-(e-l);return c?p(i,o-(e-d)):i}(e))}function C(e){return a=void 0,g&&s?w(e):(s=n=void 0,r)}function E(){var e=m(),i=y(e);if(s=arguments,n=this,l=e,i){if(void 0===a)return function(e){return d=e,a=setTimeout(b,t),h?w(e):r}(l);if(c)return a=setTimeout(b,t),w(l)}return void 0===a&&(a=setTimeout(b,t)),r}return t=v(t)||0,f(i)&&(h=!!i.leading,o=(c="maxWait"in i)?u(v(i.maxWait)||0,t):o,g="trailing"in i?!!i.trailing:g),E.cancel=function(){void 0!==a&&clearTimeout(a),d=0,s=l=n=a=void 0},E.flush=function(){return void 0===a?r:C(m())},E}}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,i),o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(){return chrome.runtime.sendMessage({type:"REQUEST_TAB_INFO"})}function t(e,t){return null!=e&&null!=t&&("string"==typeof e&&(e={code:e}),"string"==typeof t&&(t={code:t}),!(!0===e.ctrlKey!=(!0===t.ctrlKey)||!0===e.altKey!=(!0===t.altKey)||!0===e.shiftKey!=(!0===t.shiftKey)||!0===e.metaKey!=(!0===t.metaKey))&&(!(!e.key||!t.key||e.key!==t.key)||!(!e.code||!t.code||e.code!==t.code)||void 0))}i(5739).$;var s=i(181),n=i.n(s);const o=["speed","lastSpeed","enabled","latestViaShortcut","elementFx","backdropFx","monoOutput","audioFx","audioFxAlt","audioPan"],r=new Set(o),a=[["speed"],["elementFx","backdropFx"],["enabled","latestViaShortcut"]],l=a.flat(1),d=new Set(l),h=Object.fromEntries(l.map((e=>[e,a.find((t=>t.includes(e)))])));new Set(["enabled","monoOutput","audioFx","audioFxAlt","audioPan"]);let c=function(e){return e[e.SET=1]="SET",e[e.ADD=2]="ADD",e[e.CYCLE=3]="CYCLE",e[e.ITC=4]="ITC",e[e.ITC_REL=5]="ITC_REL",e}({}),u=function(e){return e[e.LOCAL=0]="LOCAL",e[e.GLOBAL=1]="GLOBAL",e[e.CONTEXT=2]="CONTEXT",e}({}),p=function(e){return e[e.STANDARD=1]="STANDARD",e[e.CUSTOM_COLOR=2]="CUSTOM_COLOR",e[e.CUSTOM_FILTER=3]="CUSTOM_FILTER",e}({});var m=i(5739).$;function f(e,t,i){let s=i;return null!=e&&(s=Math.max(e,s)),null!=t&&(s=Math.min(t,s)),s}function v(e,t,i){return i>=e&&i<=t}function g(e,t){const i=10**t;return Math.round(e*i)/i}function w(){return Math.ceil(1e10*Math.random()).toString()}let y,b,C,E,S,x;function M(){return y=y??navigator.userAgent.includes("Firefox/"),y}function k(){return b=b??navigator.userAgent.includes("Mac OS"),b}function T(){if(null!=C)return C;let e=navigator.userAgentData;return e?(C=e.mobile,C):(C=/Mobi|Android|iPhone|iTabletPad/i.test(navigator.userAgent),!C&&!M()&&globalThis.CSS&&globalThis.CSS.supports?.("(-webkit-touch-callout: none)")&&(C=!0),C)}function L(){return M()&&T()}function I(e,t){let i=e<0?"-":t?"+":"";const s=(e=Math.abs(e))/60,n=s/60;return n>=100?"":n>1?`${i}${Math.floor(n)}:${Math.floor(s%60).toString().padStart(2,"0")}:${Math.floor(e%60).toString().padStart(2,"0")}`:`${i}${Math.floor(s).toString().padStart(1,"0")}:${Math.floor(e%60).toString().padStart(2,"0")}`}function P(e,t,i){return e+i*(t-e)}function $(e,t,i){return(i-e)/(t-e)}function A(e,t){if(e===t)return!0;if("object"!=typeof e||"object"!=typeof t||null===e||null===t)return!1;const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!1;for(const s of i){if(!t.hasOwnProperty(s))return!1;if(!A(e[s],t[s]))return!1}return!0}function O(e,t){return Object.fromEntries(e.map((e=>[e,t])))}function D(e){let t=document.createElement("div");return t.innerHTML=e,t.children[0]}function _(e){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.innerHTML=e.trim(),t.firstElementChild}function F(e){let t,i;return globalThis.TouchEvent&&e instanceof globalThis.TouchEvent?e.touches[0]?(t=e.touches[0].clientX,i=e.touches[0].clientY):(t=e.changedTouches[0]?.clientX,i=e.changedTouches[0]?.clientY):(t=e.clientX,i=e.clientY),{clientX:t,clientY:i}}function R(e){const t=e.toLowerCase().split(".");if(t.length<2)return{baseName:t[0],registeredDomain:t[0]};let i;if("www"===t[0]&&t.length>1)i=t.slice(1);else{const e={uk:["co","org","ac","gov","mod","nhs","ltd","plc","me"],au:["com","net","org","edu","gov","asn","id"],nz:["ac","co","net","org","govt","school","geek","gen","maori"],in:["co","com","net","org","firm","gen","ind","ac","ernet","nic"],ng:["com","net","org","sch"],jp:["co","or","ne","ac","ad","ed","go","gr","lg"],br:["com","net","org","gov","edu","mil"],cn:["com","net","org","gov","edu","mil"],ua:["com","net","org","gov","edu"],za:["co","org","net","gov","edu","ac"],mx:["com","org","net","edu","gob"],kr:["co","or","ne","re","pe","go","ac","hs","ms"],pl:["com","net","org","edu","gov"]},s=t[t.length-1],n=t[t.length-2];i=e[s]?.includes(n)&&t.length>=3?t.slice(-3):t.slice(-2)}return{baseName:i[0],registeredDomain:i.join(".")}}function N(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function U(e,t,i=3){return x&&x.title===e||(x={title:e,result:H(e,t,i)}),x.result}function H(e,t,i=3){let s=e?.trim()||"";if(!(s&&t&&t.baseName&&t.registeredDomain))return s;const{baseName:n,registeredDomain:o}=t;for(const e of[o,n]){const t=N(e);if(""===s.replace(new RegExp(t,"gi"),"").replace(/[\s\-:]/g,""))return null}let r=s;for(const e of[o,n]){const t=N(e);let i=r.match(new RegExp(`^(.*?)(?:\\s*[-:]\\s*${t})$`,"i"));if(i&&i[1].trim()){r=i[1].trim();break}if(i=r.match(new RegExp(`^(?:${t}\\s*[-:]\\s*)(.*)$`,"i")),i&&i[1].trim()){r=i[1].trim();break}}return r.trim().split(/\s+/).filter((e=>e.length>0)).length<i?null:r}function V(){return m.isTopFrame?location.href:m.topFrameUrl||function(){if(location.ancestorOrigins)return location.ancestorOrigins[location.ancestorOrigins.length-1]}()||location.href||""}var z=i(5739).$;function B(e,t,i=!1,s=!1){let n=new Set;s&&t>0&&n.add(`t:${t}:isPinned`);for(let s in e)"isPinned"===s?t>0&&n.add(`t:${t}:isPinned`):"hasOrl"===s?t>0&&l.forEach((e=>{n.add(`r:${t}:${e}`)})):r.has(s)?(n.add(`g:${s}`),t>0&&(n.add(`t:${t}:${s}`),n.add(`t:${t}:isPinned`),!i&&d.has(s)&&n.add(`r:${t}:${s}`))):n.add(`g:${s}`);return[...n]}function G(e,t,i){t={...t};let s="g:";i>0&&t[`t:${i}:isPinned`]&&(s=`t:${i}:`);const n=`r:${i}:`;let o={};for(let i in e)"isPinned"===i?o[i]=t[s.concat(i)]:"hasOrl"===i?o[i]=l.some((e=>null!=t[n.concat(e)])):r.has(i)?o[i]=t[n.concat(i)]??t[s.concat(i)]:o[i]=t[`g:${i}`];return o}async function K(e,t,i=!1){return t=t??0,G(e=Array.isArray(e)?O(e,!0):e,await async function(e){return z.es?z.es.get(e):chrome.storage.local.get(e)}(B(e,t,i)),t)}async function Y(e){return async function(e){return z.es?z.es.set(e):chrome.storage.local.set(e)}(await j(e))}async function j(e){e.tabId=e.tabId??0,e.override={...e.override};const t={};let i=Object.entries(e.override).filter((([i,s])=>{if("isPinned"!==i){if(r.has(i))return!0;if("hasOrl"===i){if(1==s||0===e.tabId)return;l.forEach((i=>{t[`r:${e.tabId}:${i}`]=null}))}else t[`g:${i}`]=s}})),s=i.length||null!=e.override.isPinned,{base:n,isPinned:a}=s?await async function(e,t){const i=t.override;if(null!=i.isPinned&&0===t.tabId)throw Error("Setting isPinned requires a non-zero tabId");let s=!1;return t.tabId>0&&(s=t.knownPinStatus??(await K(["isPinned"],t.tabId)).isPinned??!1,null!=i.isPinned&&(!0===i.isPinned&&!1===s?(e=await async function(e,t,i){o.forEach((i=>{e[`t:${t}:${i}`]=null})),e[`t:${t}:isPinned`]=!0;const s=await K(o,i,!0);for(let i in s)e[`t:${t}:${i}`]=s[i];return l.forEach((i=>{e[`r:${t}:${i}`]=null})),e}(e,t.tabId,t.inheritContextFromTabId||0),s=!0):!1===i.isPinned&&!0===s&&(e=function(e,t){return[...o,"isPinned"].forEach((i=>{e[`t:${t}:${i}`]=null})),l.forEach((i=>{e[`r:${t}:${i}`]=null})),e}(e,t.tabId),s=!1))),delete i.isPinned,{base:e,isPinned:s}}({},e):{base:{},isPinned:!1};if(Object.assign(n,t),i.length){const t=a?`t:${e.tabId}:`:"g:",s=`r:${e.tabId}:`;i.forEach((([e,i])=>{n[`${t}${e}`]=i,d.has(e)&&h[e].forEach((e=>{n[`${s}${e}`]=null}))}))}if(e.overrideRaw)for(let t in e.overrideRaw)n[t]=e.overrideRaw[t];return n}class W{cbs=new Set;processedChangeIds=new Set;released=!1;constructor(e,t,i,s,n,o){this.tabId=t,this.onLaunch=i,this.wait=n,this.maxWait=o,this.tabId=t??0,this.selector=Array.isArray(e)?O(e,!0):e,s&&this.cbs.add(s),this.watchKeys=new Set(B(this.selector,this.tabId,void 0,!0)),this.start()}start=async()=>{this.triggerCbs=this.wait?n()(this._triggerCbs,this.wait,{trailing:!0,leading:!0,...null==this.maxWait?{}:{maxWait:this.maxWait}}):this._triggerCbs,chrome.storage.local.onChanged.addListener(this.handleChange),this.onLaunch&&await this.handleChange(null,!0)};release=()=>{if(!this.released){this.released=!0,this.triggerCbs.cancel?.(),delete this.triggerCbs;try{chrome.storage.local.onChanged.removeListener(this.handleChange)}catch(e){}this.cbs.clear(),this.processedChangeIds.clear(),delete this.cbs,delete this.tabId,delete this.selector,delete this.processedChangeIds,delete this.view,delete this.latestView,delete this.rawMap}};handleChange=async(e,t=!1)=>{if(this.released)return;e=e??{};const i=e.changeId?.newValue;if(i){if(this.processedChangeIds.has(i))return void this.processedChangeIds.delete(i);this.processedChangeIds.add(i)}let s=t,n=this.tabId&&e[`t:${this.tabId}:isPinned`];this.rawMap||(this.rawMap=await chrome.storage.local.get([...this.watchKeys]),s=!0);for(let t in e)this.watchKeys.has(t)&&(this.rawMap[t]=e[t].newValue,s=!0);if(!s)return;const o=G(this.selector,this.rawMap,this.tabId);A(this.latestView,o)||(this.latestView=o,this.view=structuredClone(this.latestView),n?(this.triggerCbs.cancel?.(),this._triggerCbs(t)):this.triggerCbs(t))};_triggerCbs=(e=!1)=>{this.cbs.forEach((t=>t(this.view,e)))};push=async(e,t=!0)=>{if(!t)return Y({override:e,tabId:this.tabId});let i;return this.rawMap&&(i=this.tabId>0&&!!this.rawMap[`t:${this.tabId}:isPinned`]),null!=i?this.pushPreCog(e,i):Y({override:e,tabId:this.tabId})};pushPreCog=async(e,t)=>{const i=await j({override:e,tabId:this.tabId,knownPinStatus:t,overrideRaw:{changeId:w()}}),s={};for(let e in i)void 0!==i[e]&&(s[e]={newValue:i[e]});return Promise.all([this.handleChange(s,!0),chrome.storage.local.set(i)])}}function X(){const[e,t]=function(e,t){let i=[],s=[];return e.forEach((e=>{(([e,t])=>t.isTransform)(e)?i.push(e):s.push(e)})),[i,s]}(Object.entries(q));return{filters:t.map((([e,t])=>({name:e,value:t.ref.default}))),transforms:e.map((([e,t])=>({name:e,value:t.ref.default})))}}Object.freeze([{name:"1965",values:[-6,-17.2,-6,0,-3.6,9.2,1.2,9.2,3.6,-5.2]},{name:"1965 - Part 2",values:[-18,-14.4,0,0,-3.6,9.2,1.2,9.2,3.6,-5.2]},{name:"Lo-Fidelity",values:[-15.1,-9.4,0,2.3,-2,4.3,4.3,-2.3,-4.6,-8.9]},{name:"Musical Presence",values:[0,0,0,0,0,2.5,5,2.5,0,0]},{name:"Notch Every Two Octaves",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"Rattle The Trunk",values:[17.99,17.99,9,0,0,0,0,0,0,0]},{name:"Simple Bass Cut",values:[-4,-3,-2,-2,-2,0,0,0,0,0]},{name:"Simple Bass Lift",values:[6,6,3,3,3,0,0,0,0,0]},{name:"Simple High Cut",values:[0,0,0,0,0,-2,-2,-3,-3,-3]},{name:"Simple High Lift",values:[0,0,0,0,0,1,2,2,3,4]},{name:"Vocal Presence - Boost",values:[0,0,0,0,0,0,6.5,0,0,0]},{name:"Vocal Presence - Cut",values:[0,0,0,0,0,0,-6.5,0,0,0]}]),Object.freeze([{name:"20 Band Classic V",values:[5,6,3.54,.59,-.48,-2.5,-5,-7,-8,-8,-7,-5,-3,-2.5,-1,2,3,4,5,4.02]},{name:"Bowed String",values:[0,0,-1.2,-1.6,-2.4,-2.8,-1.6,-1.6,-1.6,0,0,0,0,0,2.4,3.6,5.6,0,0,0]},{name:"Bright and Punchy",values:[-3,3,6,4.5,3,1.5,0,0,0,0,0,0,0,1,2,3,4,4,4,4]},{name:"Cymbal Shimmer",values:[0,0,0,0,0,0,0,0,0,0,0,-.1,-.3,-.5,-.4,.2,1.3,2.6,3.6,4]},{name:"Dark and Dull",values:[-6,-4,-2,0,0,0,0,0,0,0,0,0,0,-3,-6,-9,-12,-15,-18,-18]},{name:"Destination - Car Stereo",values:[-4,-2,0,3,4,3,1.5,0,-1,-2,-2,-1,0,1,2,3,4,2,0,-3]},{name:"Heavy Guitar",values:[0,-.2,-.1,1,1.9,1.6,.4,-.5,-1.1,-2.2,-3.6,-3.9,-2.9,-1.6,-.5,.1,.1,0,0,0]},{name:"Liven up dead samples",values:[0,0,0,0,0,0,0,0,0,0,0,.1,.1,-.2,-.6,.5,3,3.9,1.5,-.4]},{name:"Notch Every Octave",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"Possible Bass",values:[0,0,5.2,6,3.2,0,-11.6,-5.2,-4,-4,0,3.2,4.8,0,0,0,-3.2,-7.2,-10.8,-14]},{name:"Sloping High End Boost",values:[0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,6,7,8,8]},{name:"Sloping Low End Boost",values:[8,8,8,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0]},{name:"Tinny and Brittle",values:[-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,0,0,0,1,3.52,6,6,3,1]},{name:"Vocal Magic (breath)",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,.1,-.1,-.5,2,2.5,1]}]),Object.freeze([{name:"Bass - Increased Clarity",values:[-4,-3.4,-1.9,-.3,.6,.6,.2,-.3,-1.2,-1.5,1.4,2.9,.7,.2,.8,.5,0,-2,-.5,-.5,-.4,-.2,0,0,-.2,-.4,-.4,-.3,-.1,0]},{name:"Background Vocal",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,-3,-6,-3,0,0,-.1,0,0,0]},{name:"Classic V",values:[3,2.5,1.3,.2,-.4,-.5,-.2,.2,.4,.3,-.3,-1.6,-3.4,-5.7,-8.2,-10.2,-10.9,-9.8,-7.4,-4.5,-2.3,-.9,-.1,0,-.2,-.3,.2,1.3,2.5,3]},{name:"Destination - Home Theater",values:[4.5,6,7.5,7.5,5,3,1.5,.5,0,-.5,-1.5,-3,-5,-3,-1.5,0,1.5,3,3,3,1.5,0,0,3,6,7.5,7.5,6,3,0]},{name:"Drums",values:[0,0,0,0,0,0,0,-.1,.3,.4,-2,-2.8,0,.6,-.2,-.1,0,-.2,-.3,-.5,-.4,-.1,0,0,.2,-.3,-.1,2.5,2.1,0]},{name:"Generic Attack Booster",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.1,-.1,-.1,.2,.6,1.3,2,2.8,3.1,2.7,1.8,.6,-.2,-.3,-.1,0]},{name:"Generic Mud Removal",values:[0,0,0,0,-.1,-.3,-.7,-1.5,-2.4,-3,-2.8,-2,-.8,0,.4,.3,0,-.1,-.1,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Hi Boost",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.5,1.5,3,5,5,3,1.5,.5]},{name:"Gentle Hi Cut",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.5,-1.5,-3,-5,-5,-3,-1.5,-.5]},{name:"Gentle Low Boost",values:[0,.5,1.5,3,5,3,1.5,.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Low Cut",values:[0,-.5,-1.5,-3,-5,-3,-1.5,-.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{name:"Gentle Mid Boost",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,.5,1.5,3,5,5,3,1.5,.5,0,0,0,0,0,0,0,0,0]},{name:"Gentle Mid Cut",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,-.5,-1.5,-3,-5,-5,-3,-1.5,-.5,0,0,0,0,0,0,0,0,0]},{name:"Guitar - Increases Attack",values:[0,0,0,0,-1.5,-4,-2,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,2,0,-.1,0,0,0,-.1,0,0,0]},{name:"Keyboards - Bright and Clear",values:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,2,5,2.5,0,0,-.1,0,0,0]},{name:"Kick - Less Boxy, more Attack",values:[0,0,0,0,0,0,0,0,0,0,-2.5,-6,-2.5,0,0,0,0,0,0,0,0,2,5,2,0,0,0,0,0,0]},{name:"Lead Vocal - Clarity",values:[0,0,0,0,0,0,0,0,-3,0,0,0,0,0,0,0,0,-.2,-.3,-.4,-.4,0,2,0,0,4,-.1,0,0,0]},{name:"Notch Every 2/3 Octave",values:[-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99,-18,17.99]},{name:"RIAA De-Emphasis",values:[18.3,17.6,16.7,15.6,14.2,12.8,11.3,9.6,8,6.5,5,3.7,2.6,1.6,.7,0,-.7,-1.6,-2.6,-3.7,-5.1,-6.6,-8.2,-10,-11.9,-13.8,-15.7,-17.7,-19.7,-20]},{name:"Snare - Increase Snap",values:[0,-.1,-.2,-.1,.5,1.3,1.9,1.9,1.3,.4,-.1,-.3,-.2,0,.1,0,0,-.1,-.2,-.4,-.6,-.7,-.5,1.5,2,0,0,0,.9,0]},{name:"cymbals sans gong",values:[-8,-6.5,-3.3,-.4,.4,-.5,-2.3,-3.7,-4.5,-4.4,-3.7,-2.3,-.9,.1,.5,.3,0,-.3,-.5,-.5,-.4,-.2,0,.1,0,0,-.1,0,0,0]}]);const q={sepia:{ref:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,itcStep:.5,wrappable:!0},format:e=>`sepia(${e})`},hueRotate:{ref:{step:8,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,itcStep:180},format:e=>`hue-rotate(${e}deg)`},grayscale:{ref:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,itcStep:.5,wrappable:!0},format:e=>`grayscale(${e})`},contrast:{ref:{min:0,step:.1,sliderMin:0,sliderMax:5,default:1,itcStep:2.5},format:e=>`contrast(${e})`},brightness:{ref:{min:0,step:.1,sliderMin:0,sliderMax:5,sliderStep:.05,default:1,itcStep:2.5},format:e=>`brightness(${e})`},saturate:{ref:{min:0,step:.1,sliderMin:0,sliderMax:5,sliderStep:.05,default:1,itcStep:2.5},format:e=>`saturate(${e})`},invert:{ref:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:0,itcStep:.5,wrappable:!0},format:e=>`invert(${e})`},blur:{ref:{min:0,step:.1,sliderMin:0,sliderMax:10,sliderStep:.1,default:0,itcStep:5},format:e=>`blur(${e}px)`},opacity:{ref:{min:0,max:1,step:.1,sliderMin:0,sliderMax:1,default:1,itcStep:.5,wrappable:!0},format:e=>`opacity(${e})`},scaleX:{isTransform:!0,ref:{step:.1,sliderMin:-1,sliderMax:3,sliderStep:.04,default:1,itcStep:2},format:e=>`scaleX(${e})`},scaleY:{isTransform:!0,ref:{step:.1,sliderMin:-1,sliderMax:3,sliderStep:.04,default:1,itcStep:2},format:e=>`scaleY(${e})`},translateX:{isTransform:!0,ref:{step:1,sliderMin:-300,sliderMax:300,sliderStep:5,default:0,itcStep:300},format:e=>`translateX(${e}px)`},translateY:{isTransform:!0,ref:{step:1,sliderMin:-300,sliderMax:300,sliderStep:5,default:0,itcStep:300},format:e=>`translateY(${e}px)`},rotateX:{isTransform:!0,ref:{step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,itcStep:180},format:e=>`rotateX(${e}deg)`},rotateY:{isTransform:!0,ref:{step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,itcStep:180},format:e=>`rotateY(${e}deg)`},rotateZ:{isTransform:!0,ref:{step:1,sliderMin:-180,sliderMax:180,sliderStep:1,default:0,itcStep:180},format:e=>`rotateZ(${e}deg)`}};function Q(e,t){return!t||t(e)}const Z={mosaic:{format:e=>{const t=e.mosaic;let i=Math.round(2*t.blockX-1),s=Math.round(2*t.blockY-1),n=Math.round(P(1,i,t.sampleNormalX));n%2==0&&(n=Math.round(n+1));let o=Math.round(P(1,s,t.sampleNormalY));o%2==0&&(o=Math.round(o+1));const r=Math.round((i-n)/2),a=Math.round((s-o)/2);return J(`<feFlood flood-color="red" x="0" y="0" width="${n}" height="${o}"/> <feComposite width="${i}" height="${s}"/><feTile result="a"/><feComposite in="SourceGraphic" in2="a" operator="in"/><feMorphology operator="dilate" radius="${Math.round(r*t.scalingNormalX)} ${Math.round(a*t.scalingNormalY)}"></feMorphology>`)}},custom:{format:e=>e.text},colorMatrix:{format:e=>{const t=Array(20).fill(0);for(let i=0;i<3;i++)t[5*i+0]=e.colorMatrix[4*i+0],t[5*i+1]=e.colorMatrix[4*i+1],t[5*i+2]=e.colorMatrix[4*i+2],t[5*i+4]=e.colorMatrix[4*i+3];return t[18]=1,J(`<feColorMatrix type="matrix" values="${t.map((e=>e.toFixed(3))).join(" ")}"/>`)}},rgb:{format:e=>{const t=Array(20).fill(0);for(let i=0;i<3;i++)t[5*i+i]=e.rgb[i];return t[18]=1,J(`<feColorMatrix type="matrix" values="${t.map((e=>e.toFixed(3))).join(" ")}"/>`)},isValid:e=>e.rgb&&(1!==e.rgb[0]||1!==e.rgb[1]||1!==e.rgb[2])},posterize:{format:e=>{if(!e.posterize)return;const t=Math.round(e.posterize-1),i=Array(t).fill(0).map(((e,i)=>(i/t).toFixed(4)));i.push("1.0");const s=i.join(" ");return J(`<feComponentTransfer>\n               <feFuncR type="discrete" tableValues="${s}"/>\n               <feFuncG type="discrete" tableValues="${s}"/>\n               <feFuncB type="discrete" tableValues="${s}"/>\n            </feComponentTransfer>`)}},blur:{format:e=>J(`<feGaussianBlur stdDeviation="${e.blur.x} ${e.blur.y}"/ >`),isValid:e=>e.blur.x>0||e.blur.y>0},sharpen:{format:e=>{if(!e.sharpen)return;const t=`-${e.sharpen.toFixed(2)}`;return J(`<feConvolveMatrix order="3" kernelMatrix="0 ${t} 0 ${t} ${(1+4*e.sharpen).toFixed(6)} ${t} 0 ${t} 0" edgeMode="duplicate" preserveAlpha="true"/>`)},isValid:e=>e.sharpen>0},noise:{format:e=>{if(e.noise)return J(`<feTurbulence id="turb" type="fractalNoise" baseFrequency="${1-e.noise.size}" numOctaves="1" seed="0" result="n">\n\t         <animate attributeName="seed" values="${Array(25).fill(0).map(((e,t)=>t)).join(";")}" dur="${1/e.noise.speed}s" repeatCount="indefinite"/>\n         </feTurbulence>\n\t      <feColorMatrix type="saturate" values="0" in="n" result="gn"/>\n\t      <feBlend in="SourceGraphic" in2="gn" mode="${e.noise.mode||"hard-light"}"/>`)},isValid:e=>e.noise&&0!==e.noise.speed&&e.noise.size%1!=0},motion:{format:e=>{const t=e.motion;let i=1/t.speed,s=[];return 0!==t.x&&s.push(`<animate attributeName="dx" values="-${t.x};${t.x};-${t.x}" dur="${i}s" repeatCount="indefinite"/>`),0!==t.y&&s.push(`<animate attributeName="dy" values="-${t.y};${t.y};-${t.y}" dur="${i}s" repeatCount="indefinite"/>`),J(`<feOffset dx="0" dy="0">${s.join("")}</feOffset>`)},isValid:e=>e.motion&&e.motion.speed>0&&(e.motion.x>0||e.motion.y>0)},special:{format:e=>J(e.text),isValid:e=>!!e.text}};function J(e){return`<filter x="0%" y="0%" width="100%" height="100%">${e}</filter>`}function ee(e,t=2){return f(.07,16,g(e,t))}function te(e,t=!1){let i=e.toFixed(2);return t&&"0"===i.at(-1)&&(i=i.slice(0,-1)),i}function ie(e){let t=[];return e?.forEach((e=>{const i=q[e.name];null!=e.value&&e.value!==i.ref.default&&t.push(i.format(e.value))})),t.join(" ")}function se(e,t){if("STARTS_WITH"===t.type)return e.startsWith(t.valueStartsWith);if("CONTAINS"===t.type)return e.includes(t.valueContains);if("REGEX"===t.type)try{return new RegExp(t.valueRegex).test(e)}catch(e){}}function ne(e,t,i){const s=t?.parts.filter((e=>!e.disabled))||[];if(!s.length)return i;const n=s.some((t=>se(e,t)));return t.block?!n:n}function oe(e){if(e)return chrome.dom?chrome.dom.openOrClosedShadowRoot(e):e.openOrClosedShadowRoot}function re(e,t){let i=e;for(;;){let e=i[t];if(!e)return i?.host;if(i=oe(e),!i)return e}}function ae(e,t){let i=document.createElement("style");return i.innerHTML=e,t.appendChild(i),i}i(5739).$;var le=i(5739).$;class de{_div=document.createElement("div");_supportsPopover=!!this._div.togglePopover;_shouldShow=!1;constructor(){this._supportsPopover||(this._jump=new he,this._wrapper=this._jump.div,this._div.classList.add("popoverYah")),this._wrapper=this._wrapper||document.createElement("div"),this._shadow=this._wrapper.attachShadow({mode:"closed"}),this._shadow.appendChild(this._div),this._div.popover="manual",this._div.style.zIndex="99999999999",le.os?.eListen.fsCbs.add(this._handleFsChange),this._supportsPopover||(this._style=ae(".popoverYah {\n    z-index: 99999999999;\n    display: none;\n}\n\n.popoverYah.popoverOpenYah {\n    display: block !important;\n}",this._shadow))}_update=e=>{null!=e&&(this._shouldShow=e),this._shouldShow?(this._jump?this._jump.connect():document.documentElement.appendChild(this._wrapper),this._supportsPopover?!this._div.togglePopover()&&this._div.togglePopover():this._div.classList.add("popoverOpenYah")):(this._wrapper.isConnected&&this._wrapper.remove(),this._div.classList.remove("popoverOpenYah"))};_release=()=>{le.os?.eListen.fsCbs.delete(this._handleFsChange),this._wrapper.remove(),this._jump?.release(),delete this._jump,delete this._div};_handleFsChange=()=>{document.fullscreenElement&&this._update()}}class he{base=document.documentElement;div=document.createElement("div");released=!1;constructor(){le.os?.eListen.fsCbs.add(this.handleFullscreenChange)}release=()=>{this.released||(this.released=!0,this.div.remove(),le.os?.eListen.fsCbs.delete(this.handleFullscreenChange))};handleFullscreenChange=()=>{let e=document.documentElement,t=re(document,"fullscreenElement");t&&"IFRAME"!==t.tagName&&(e=t),this.base!==e&&(this.base=e,this.div.isConnected&&this.connect())};connect=()=>{this.div.parentElement!==this.base&&this.base.appendChild(this.div)};disconnect=()=>{this.div.isConnected&&this.div.remove()}}class ce extends de{constructor(){super(),ae(":is(div:popover-open, div.popoverOpenYah)  { \n    position: fixed;\n    width: 100vw;\n    height: 100vh;\n    left: 0px;\n    top: 0px;\n    margin: 0px;\n    pointer-events: none;\n    background-color: transparent;\n    border: none;\n}",this._shadow)}release=()=>{this._release(),this.svg?.remove()};show=(e,t)=>{e!==this.lastFilter&&(this.svg?.remove(),this.svg=t,this.lastFilter=e,this._div.style.backdropFilter=e,this.svg&&this._shadow.appendChild(this.svg),this._update(!!e))}}var ue=i(5739).$;class pe{client=new W({elementFx:!0,backdropFx:ue.isTopFrame},ue.tabInfo.tabId,!0,(e=>{e.elementFx=e.elementFx??X(),e.backdropFx=e.backdropFx??X(),this.handleChange(e)}));release=()=>{this.released||(this.released=!0,this.client?.release(),delete this.client,this.tempStyle?.release(),delete this.tempStyle,this.backdrop?.release(),delete this.backdrop,this.documentTransform?.clear(),delete this.documentTransform)};handleChange=e=>{let t=me(e.elementFx.enabled,e.elementFx.query||"video",ie(e.elementFx.filters),ie(e.elementFx.transforms.slice().reverse()),`${e.elementFx.originX||"center"} ${e.elementFx.originY||"center"}`,e.elementFx.svgFilters);if(t?(this.tempStyle&&this.tempStyle.styleInfo.styleString!==t.styleString&&(this.tempStyle.release(),delete this.tempStyle),this.tempStyle=this.tempStyle||new ve(t)):(this.tempStyle?.release(),delete this.tempStyle),!ue.isTopFrame)return;const i=ie(e.backdropFx.filters),s=ie(e.backdropFx.transforms.slice().reverse()),n=`${e.backdropFx.originX||"center"} ${e.backdropFx.originY||"top"}`,o=me(e.backdropFx.enabled,"placeholder",i,s,n,e.backdropFx.svgFilters),r=e.backdropFx.enabled;r&&o?.filterValue?(this.backdrop=this.backdrop||new ce,this.backdrop.show(o.filterValue,o.svg)):(this.backdrop?.release(),delete this.backdrop),r&&s?(this.documentTransform=this.documentTransform||new fe,this.documentTransform.set(s,n)):(this.documentTransform?.clear(),delete this.documentTransform)}}function me(e,t,i,s,n,o){if(!e||!t||!(i||s||function(e){if(e?.filter((e=>{if(e.enabled)return!!Q(e,Z[e.type].isValid)||void 0})).length)return!0}(o)))return null;let r,a,l,d=[];if(s&&(d.push(`transform: ${s} !important`),n&&d.push(`transform-origin: ${n} !important`)),o?.length)try{let e=o.map((e=>{const t=Z[e.type];if(!e.enabled||!Q(e,t.isValid))return;let i=`svg_${w()}`;const s=t.format(e);if(!s)return;let n=_(s);return n.id=i,{filterElement:n,id:i}})).filter((e=>e));a=e.map((e=>`url(#${e.id})`)).join(" "),r=e.map((e=>e.filterElement))}catch{a=r=null}(i||a)&&(l=`${i||""} ${a||""}`,d.push(`filter: ${l} !important`));const h=`:is(${t}, #proooof > #essi > #onal) {${d.join(";")}}`,c=document.createElement("style");let u;return c.innerHTML=h,r?.length&&(u=_('<svg width="0" height="0" style="position:fixed;left:-9999px;top:-9999px" aria-hidden="true"></svg>'),r.forEach((e=>{u.appendChild(e)}))),{styleString:h,styleTemplate:c,svg:u,filterValue:l}}class fe{set=(e,t)=>{this.memoized=this.memoized||{transform:document.body.style.transform,origin:document.body.style.transformOrigin},document.body.style.transform!==e&&(document.body.style.transform=e),document.body.style.transformOrigin!==t&&(document.body.style.transformOrigin=t)};clear=()=>{this.memoized&&(document.body.style.transform=this.memoized.transform,document.body.style.transformOrigin=this.memoized.origin,delete this.memoized)}}class ve{processed=new Set;appended=[];released=!1;constructor(e){this.styleInfo=e,this.processAll()}release=()=>{this.released||(this.released=!0,ue.os.mediaTower.newDocCallbacks.delete(this.processAll),this.appended.forEach((e=>e.remove())),delete this.appended,this.processed.clear(),delete this.processed)};processAll=()=>{this.process(document.documentElement),[...ue.os.mediaTower.docs].filter((e=>e instanceof ShadowRoot)).filter((e=>e.host.isConnected)).forEach(this.process)};process=e=>{if(this.processed.has(e))return;this.processed.add(e);const t=this.styleInfo.styleTemplate.cloneNode(!0);if(e.appendChild(t),this.appended.push(t),this.styleInfo.svg){const t=this.styleInfo.svg.cloneNode(!0);e.appendChild(t),this.appended.push(t)}}}class ge extends de{main=document.createElement("div");icons=function(){return{play:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="0.8em" width="0.8em" xmlns="http://www.w3.org/2000/svg"><path d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"></path></svg>'),pause:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="0.8em" width="0.8em" xmlns="http://www.w3.org/2000/svg"><path d="M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"></path></svg>'),bookmark:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="0.8em" width="0.8em" xmlns="http://www.w3.org/2000/svg"><path d="M0 512V48C0 21.49 21.49 0 48 0h288c26.51 0 48 21.49 48 48v464L192 400 0 512z"></path></svg>'),arrowRight:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"></path></svg>'),arrowLeft:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"></path></svg>'),forward:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M500.5 231.4l-192-160C287.9 54.3 256 68.6 256 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2zm-256 0l-192-160C31.9 54.3 0 68.6 0 96v320c0 27.4 31.9 41.8 52.5 24.6l192-160c15.3-12.8 15.3-36.4 0-49.2z"></path></svg>'),backward:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.5 280.6l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2zm256 0l192 160c20.6 17.2 52.5 2.8 52.5-24.6V96c0-27.4-31.9-41.8-52.5-24.6l-192 160c-15.3 12.8-15.3 36.4 0 49.2z"></path></svg>'),loop:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 640 512" height="1.1em" width="1.1em" xmlns="http://www.w3.org/2000/svg"><path d="M471.1 96C405 96 353.3 137.3 320 174.6 286.7 137.3 235 96 168.9 96 75.8 96 0 167.8 0 256s75.8 160 168.9 160c66.1 0 117.8-41.3 151.1-78.6 33.3 37.3 85 78.6 151.1 78.6 93.1 0 168.9-71.8 168.9-160S564.2 96 471.1 96zM168.9 320c-40.2 0-72.9-28.7-72.9-64s32.7-64 72.9-64c38.2 0 73.4 36.1 94 64-20.4 27.6-55.9 64-94 64zm302.2 0c-38.2 0-73.4-36.1-94-64 20.4-27.6 55.9-64 94-64 40.2 0 72.9 28.7 72.9 64s-32.7 64-72.9 64z"></path></svg>'),skip:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M240,88v64a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66l26.19-26.18A88,88,0,0,0,40,184a8,8,0,0,1-16,0,104,104,0,0,1,175.86-75.18l26.48-26.48A8,8,0,0,1,240,88Z"></path></svg>'),fx:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 10 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 7H6l3-7-9 9h4l-3 7 9-9z"></path></svg>'),power:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="0.95em" width="0.95em" xmlns="http://www.w3.org/2000/svg"><path d="M400 54.1c63 45 104 118.6 104 201.9 0 136.8-110.8 247.7-247.5 248C120 504.3 8.2 393 8 256.4 7.9 173.1 48.9 99.3 111.8 54.2c11.7-8.3 28-4.8 35 7.7L162.6 90c5.9 10.5 3.1 23.8-6.6 31-41.5 30.8-68 79.6-68 134.9-.1 92.3 74.5 168.1 168 168.1 91.6 0 168.6-74.2 168-169.1-.3-51.8-24.7-101.8-68.1-134-9.7-7.2-12.4-20.5-6.5-30.9l15.8-28.1c7-12.4 23.2-16.1 34.8-7.8zM296 264V24c0-13.3-10.7-24-24-24h-32c-13.3 0-24 10.7-24 24v240c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24z"></path></svg>'),swap:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 168v-16c0-13.255 10.745-24 24-24h360V80c0-21.367 25.899-32.042 40.971-16.971l80 80c9.372 9.373 9.372 24.569 0 33.941l-80 80C409.956 271.982 384 261.456 384 240v-48H24c-13.255 0-24-10.745-24-24zm488 152H128v-48c0-21.314-25.862-32.08-40.971-16.971l-80 80c-9.372 9.373-9.372 24.569 0 33.941l80 80C102.057 463.997 128 453.437 128 432v-48h360c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24z"></path></svg>'),reset:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M248.91 50c11.882-.006 23.875 1.018 35.857 3.13 85.207 15.025 152.077 81.895 167.102 167.102 15.023 85.208-24.944 170.917-99.874 214.178-32.782 18.927-69.254 27.996-105.463 27.553-46.555-.57-92.675-16.865-129.957-48.15l30.855-36.768c50.95 42.75 122.968 49.05 180.566 15.797 57.597-33.254 88.152-98.777 76.603-164.274-11.55-65.497-62.672-116.62-128.17-128.168-51.656-9.108-103.323 7.98-139.17 43.862L185 192H57V64l46.34 46.342C141.758 71.962 194.17 50.03 248.91 50z"></path></svg>'),speedChangesPitch:D('<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 13c0 1.105-1.12 2-2.5 2S7 14.105 7 13s1.12-2 2.5-2 2.5.895 2.5 2z"></path><path fill-rule="evenodd" d="M12 3v10h-1V3h1z" clip-rule="evenodd"></path><path d="M11 2.82a1 1 0 01.804-.98l3-.6A1 1 0 0116 2.22V4l-5 1V2.82z"></path><path fill-rule="evenodd" d="M0 11.5a.5.5 0 01.5-.5H4a.5.5 0 010 1H.5a.5.5 0 01-.5-.5zm0-4A.5.5 0 01.5 7H8a.5.5 0 010 1H.5a.5.5 0 01-.5-.5zm0-4A.5.5 0 01.5 3H8a.5.5 0 010 1H.5a.5.5 0 01-.5-.5z" clip-rule="evenodd"></path></svg>')}}();scaling=1;duration=1;animation=1;constructor(){super(),this._div.append(this.main),ae('@keyframes keyframe_1 {\n    from { transform: scale(0.95); opacity: 1 }\n    to { transform: scale(1.05); opacity: 0 }\n}\n\n@keyframes keyframe_3 {\n    0% { transform: scale(1) }\n    80% { transform: scale(0.75) }\n    100% { transform: scale(0) }\n}\n\n@keyframes keyframe_4 {\n    0% { transform: scale(1) }\n    60% { transform: scale(0.95) }\n    90% { transform: scale(0.5); opacity: 0.5 }\n    100% { transform: scale(1.2); opacity: 0 }\n}\n\n@keyframes keyframe_5 {\n    0% { transform: scale(0.95) }\n    30% { transform: scale(1.05) }\n    100% { transform: scale(0) rotateZ(100deg); opacity: 0 }\n}\n\n\n:is(div:popover-open, div.popoverOpenYah, #proo) {\n    border: none;\n    position: fixed;\n    width: 100vw;\n    left: 0px;\n    top: 0px;\n    height: 100vh;\n    margin: 0px;\n    pointer-events: none;\n    white-space: pre;\n    grid-auto-flow: column;\n    align-items: center;\n    justify-content: center;\n    display: grid !important;\n    background-color: transparent;\n    font-family: "Segoe UI", "Avenir", system-ui, Courier, monospace;\n}',this._shadow)}setInit=e=>{e=e||{},this.key=e.key,this.main.removeAttribute("style"),this.main.style.backgroundColor=e.backgroundColor||"#000000",this.main.style.color=e.textColor||"#ffffff",e.showShadow&&(this.main.style.boxShadow="1px 1px 35px 3px #ffffff88"),this.animation=e.animation||1,this.duration=e.duration??1,this.scaling=e.scaling??1;const t=(e.rounding??0)*this.scaling;this.main.style.padding=10*(this.scaling+.12*t)+"px",this.main.style.fontSize=30*this.scaling+"px",this.main.style.borderRadius=t?10*t+"px":"0px";const i=e.position??"TL";if("C"===i)return void(this.main.style.position="revert");this.main.style.position="fixed";let s=30*(e.offset??1);const n=i.includes("T"),o=i.includes("L");this.main.style[n?"top":"bottom"]=`${s}px`,this.main.style[o?"left":"right"]=`${s}px`};release=()=>{delete this.icons,clearTimeout(this.timeoutId),this._release()};show=e=>{clearTimeout(this.timeoutId),this.main.innerText=e.preText||"",(e.icons||[]).forEach((e=>{this.main.appendChild(this.icons[e])})),this.main.append(e.text||"");const t=(e.duration??900)*this.duration;let i=(e.small?24.9:30)*this.scaling+"px",s="";e.static||2===this.animation||(s=`keyframe_${this.animation} ${t}ms ease-in forwards`),this.main.style.animation=s,this.main.style.fontSize=e.fontSize??i,this._wrapper.remove(),this._update(!0),this.timeoutId=setTimeout((()=>{this._update(!1),delete this.timeoutId}),1.2*t)}}const we=!(!("requestPictureInPicture"in HTMLVideoElement.prototype)||!("pictureInPictureElement"in Document.prototype));document.featurePolicy?.allowsFeature("picture-in-picture");let ye=!1,be=!1,Ce=!1,Ee=!1,Se=!1,xe=!1,Me=!1;"www.netflix.com"===location.hostname?ye=!0:(document.URL||"").startsWith("www.amazon")?be=!0:"www.bilibili.com"===location.hostname?Ce=!0:"www.youtube.com"===location.hostname?Ee=!0:"vimeo.com"===location.hostname?Se=!0:location.hostname.endsWith("reddit.com")?xe=!0:location.hostname.endsWith("facebook.com")&&(Me=!0);const ke=ye||be,Te=!(ye||Me),Le=!(Se||xe);let Ie;async function Pe(){let e=(await chrome.storage.local.get("f:salt"))["f:salt"];return e||(e=crypto.randomUUID().slice(0,18).replaceAll("-",""),await chrome.storage.local.set({"f:salt":e})),e}async function $e(e,t=6){return(await async function(e,t){return Ie=Ie??new TextEncoder,e=`${e}:${t}`,i=await crypto.subtle.digest("sha-1",Ie.encode(e)),Array.from(new Uint8Array(i)).map((e=>e.toString(16).padStart(2,"0"))).join("");var i}(e,await Pe())).slice(0,t??99)}class Ae extends de{released=!1;index=0;constructor(e,t){super(),this.video=e,Ae.currentCinema?.release(),Ae.currentCinema=this;const i={mode:1,color:"#000000",colorAlpha:90,rounding:10},s=(t=t||i).mode||i.mode;if(this._div.style.position="fixed",this._div.style.margin="0",this._div.style.left="0px",this._div.style.top="0px",this._div.style.width="100vw",this._div.style.height="100vh",this._div.style.border="none",s===p.CUSTOM_COLOR)this._div.style.backgroundColor=t.color??i.color,this._div.style.opacity=""+(t.colorAlpha??i.colorAlpha)/100;else if(this._div.style.backgroundColor="transparent",s===p.STANDARD&&(this._div.style.backdropFilter=`grayscale(1) brightness(${100-(t.colorAlpha??i.colorAlpha)}%)`),s===p.CUSTOM_FILTER){const e=ie(t.filter??function(){const e=X().filters;return e.find((e=>"brightness"===e.name)).value=.1,e.find((e=>"grayscale"===e.name)).value=1,e}());if(!e)return void this.release();this._div.style.backdropFilter=e}this.roundness=t.rounding??i.rounding,this.style=ae(":is(::-webkit-scrollbar) {\n    display: none !important\n}\n:root, body {\n    scrollbar-width: none !important\n}",document.documentElement),this.every(),this._update(!0),this._div.addEventListener("click",this.release)}every=()=>{this.released||(this.reposition(),requestAnimationFrame(this.every))};reposition=()=>{this.index++;const e=this.video.getBoundingClientRect(),t=f(0,window.innerHeight,e.top+e.height)-f(0,window.innerHeight,e.top),i=f(0,window.innerWidth,e.left+e.width)-f(0,window.innerWidth,e.left);if(this.video.ended||i<150||t<150)return this.release();if(this.currentBounds&&window.innerWidth===this.currentBounds.innerWidth&&window.innerHeight===this.currentBounds.innerHeight&&e.x===this.currentBounds.x&&e.y===this.currentBounds.y&&e.width===this.currentBounds.width&&e.height===this.currentBounds.height)return;if(this.currentBounds={...e,innerWidth:window.innerWidth,innerHeight:window.innerHeight},document.fullscreenElement||e.width/window.innerWidth>.95&&e.height/window.innerHeight>.95)return void this.release();let s=e.y+1,n=e.y+e.height-1,o=e.x+1,r=e.x+e.width-1,a=this.roundness,l=window.innerWidth,d=window.innerHeight;this._div.style.clipPath=`path("            M0,0V${d}H${l}V0H${l/2-5}V${s}            H${r-a} A${a},${a},0,0,1,${r},${s+a}            V${n-a} A${a},${a},0,0,1,${r-a},${n}            H${o+a} A${a},${a},0,0,1,${o},${n-a}            V${s+a} A${a},${a},0,0,1,${o+a},${s}            H${l/2+5}V0H0Z")`};release=()=>{this.released||(this.released=!0,this.style?.remove(),delete this.style,this._release(),this.obs?.disconnect(),delete this.obs,Ae.currentCinema===this&&delete Ae.currentCinema)}}var Oe=i(5739).$;function De(e,t,i,s){i&&(t<10||Math.abs(e.currentTime-t)<3)&&(i=!1);const n=e.paused;s&&e.pause(),ye?Oe.os.stratumServer.send({type:"SEEK_NETFLIX",value:t}):(e.currentTime=t,be&&!s&&(n?e.play():e.pause(),n?e.pause():e.play()))}function _e(e,t){"on"===t||"toggle"===t&&!e.paused?e.pause():e.play()}function Fe(e,t){e.readyState&&(e.gsMarks=e.gsMarks||{},e.gsMarks[t]=e.currentTime,Oe.os.mediaTower.sendUpdate(),async function(e,t){let i=`s:mark:${t}:${await $e(location.hostname,6)}`;!function(e){chrome.storage.session?chrome.storage.session.set(e):chrome.runtime.sendMessage({type:"SET_SESSION",override:e})}({[i]:{duration:e.duration,current:e.currentTime}})}(e,t))}function Re(e,t,i){let s;return e.forEach(((e,n)=>{if("N"===i&&e<=t)return;if("P"===i&&e>=t)return;let o=Math.abs(t-e);(!s||o<s.diff)&&(s={index:n,diff:o})})),s||("N"===i&&e.length&&(s={index:0,diff:Math.abs(t-e[0])}),"P"===i&&e.length&&(s={index:e.length-1,diff:Math.abs(t-e[e.length-1])})),s}function Ne(e,t){e.gsNameless=e.gsNameless||[];let i=Re(e.gsNameless,e.currentTime-(t?0:1),t?"N":"P");i&&De(e,e.gsNameless[i.index])}class Ue{static checkLimited(e){if(!e||e.gsRateBanned)return!0;const t=2e4*Math.ceil(Date.now()/2e4);if(e.gsRateCounter?.time===t){if(++e.gsRateCounter.count>1e3)return e.gsRateViolations=e.gsRateViolations??0,++e.gsRateViolations>=3&&(e.gsRateBanned=!0),delete e.gsRateCounter,!0}else e.gsRateCounter={time:t,count:1};return!1}static _set(e,t,i){if(!Ue.checkLimited(e)){t=f(.0625,16,t);try{e.playbackRate.toFixed(3)!==t.toFixed(3)&&(e.playbackRate=t)}catch(e){}try{e.defaultPlaybackRate.toFixed(3)!==t.toFixed(3)&&(e.defaultPlaybackRate=t)}catch(e){}e.preservesPitch=!i,e.mozPreservesPitch=!i,e.webkitPreservesPitch=!i}}static _setYt(e,t,i){e.hasAttribute("yss-skip")||this._set(e,t,i)}static set=Ee?Ue._setYt:Ue._set}function He(e,t){Oe.isTopFrame?"off"===t.state||"toggle"===t.state&&Ae.currentCinema?(Ae.currentCinema?.release(),delete Ae.currentCinema):new Ae(e,t.init):window.top===window.parent&&window.top.postMessage("CINEMA","*")}function Ve(e){if(e.gsFpsCount>5){let t=e.gsFpsSum/e.gsFpsCount;if(t>0)return t}}function ze(e,t){return 0===t?e:ze(t,e%t)}function Be(e,t){const i=ze(e,t),s=[e/i,t/i];if(s[0]<=.2*e||s[1]<=.2*t)return s}function Ge(e){const t=[];if(e instanceof HTMLVideoElement){let i=function(e){if(e.videoWidth&&e.videoHeight){const t=Be(e.videoWidth,e.videoHeight).join(" x ");let i=`${e.videoWidth} x ${e.videoHeight}`;return t&&(i=`${i} ${Be(e.videoWidth,e.videoHeight).join(":")}`),i}}(e)||"",s=Ve(e);s&&(i=`${i} (~${s.toFixed(0)} FPS)`),t.push(i)}let i=`${I(e.currentTime)} / ${e.duration===1/0?"∞":I(e.duration)}`;return 1!==e.playbackRate&&(i=`${i} → ${I(e.currentTime/e.playbackRate)} / ${I(e.duration/e.playbackRate)}`),t.push(i),t.push(`Speed: ${g(e.playbackRate,2)}x, Volume: ${(100*e.volume).toFixed(0)}%${e.muted?" (Muted)":""}`),t.join("\n")}function Ke(e,t){if("CINEMA"!==t.type){if(e?.duration)if("PLAYBACK_RATE"===t.type)Ue.set(e,t.value,t.freePitch);else if("SEEK"===t.type)!function(e,t,i,s,n,o){let r=t;if(i){if(e instanceof HTMLVideoElement&&"0.0410"===Math.abs(t).toFixed(4)){if(e.seekToNextFrame&&t>=0&&!ke)return void e.seekToNextFrame();const i=Ve(e);i&&(t=t>=0?1/i:-1/i)}r=e.currentTime+t,o&&e.duration>60&&(r<0?r=(e.duration-Math.abs(r)%e.duration)%e.duration:r>e.duration&&(r%=e.duration))}De(e,r,s,n)}(e,t.value,t.relative,t.fast,t.autoPause,t.wraparound);else if("PAUSE"===t.type)_e(e,t.state);else if("MUTE"===t.type)!function(e,t){e.muted="on"===t||"off"!==t&&!e.muted}(e,t.state);else if("SET_VOLUME"===t.type)!function(e,t,i){e.volume=f(0,1,i?e.volume+t:t)}(e,t.value,t.relative);else if("SET_MARK"===t.type){let i=(t.key||"").toLowerCase();"::nameless"===t.key?function(e){e.gsNameless=e.gsNameless||[];const t=e.gsNameless,i=Re(t,e.currentTime,"C");i?.diff<=1?t.splice(i.index,1):t.push(e.currentTime)}(e):"::nameless-prev"===i?Ne(e):"::nameless-next"===i?Ne(e,!0):Fe(e,t.key)}else"SEEK_MARK"===t.type?function(e,t,i){const s="number"==typeof t?t:e.gsMarks?.[t];null==s?Fe(e,t):De(e,s,i)}(e,t.key,t.fast):"TOGGLE_LOOP"===t.type?function(e,t,i,s,n){let o=e.gsMarks?.[t];const r=i?"gsSkipTimeUpdateHandler":"gsLoopTimeUpdateHandler",a=i?"gsSkipSeekingHandler":"gsLoopSeekingHandler",l=t=>{e.removeEventListener("timeupdate",e[r],!0),e.removeEventListener("seeking",e[a],!0),delete e[r],delete e[a],Oe.os.mediaTower.sendUpdate(),!t&&s&&Oe.os.indicator?.show({text:" off",icons:[i?"skip":"loop"]})};if(e[r])return void l(!0);if(null==o)return;let d=e.currentTime;o>d&&([o,d]=[d,o]);const h=Math.abs(d-o);e[r]=()=>{if(!i&&(e.currentTime>d||e.currentTime<o))De(e,o);else if(i&&e.currentTime>=o&&e.currentTime<d){if(e.paused)return;De(e,d)}},e[a]=()=>{(!i&&(e.currentTime<o-12||e.currentTime>d+12)||i&&h>12&&e.currentTime>=o+4&&e.currentTime<d-4)&&l()},e.addEventListener("timeupdate",e[r],{capture:!0,passive:!0}),n||e.addEventListener("seeking",e[a],{capture:!0,passive:!0}),Oe.os.mediaTower.sendUpdate()}(e,t.key,t.skipMode,t.indicator,t.ignoreNavigate):"PIP"===t.type?function(e,t="toggle"){if(!we)return;let i="off"===t;if("toggle"===t&&e.getRootNode().pictureInPictureElement===e&&(i=!0),i)document.exitPictureInPicture();else{if(!e.isConnected)return;e.removeAttribute("disablePictureInPicture"),e.requestPictureInPicture?.().catch((e=>{"SecurityError"===e?.name&&e?.message.includes("permissions policy")&&alert("PiP blocking detected. To circumvent, try my 'PiP Unblocker' extension.")}))}}(e,t.state):"FULLSCREEN"===t.type?async function(e,t){if("hidden"!==document.visibilityState){if(Ce&&!t){let e=document.querySelector(".bilibili-player-video-btn-fullscreen");if(e)return void e.click()}if(Ee&&!t){let e=document.querySelector(".ytp-fullscreen-button.ytp-button");if(e)return void e.click()}!Te||!t&&Le?!Le||t&&Te||Oe.os.smartFs.toggleSafe(e):Oe.os.nativeFs.toggleSafe(e)}}(e,t.direct):"MEDIA_INFO"===t.type?function(e){Oe.os.indicator.show({text:Ge(e),duration:5e3,static:!0,fontSize:"20px"})}(e):"LOOP_ENTIRE"===t.type&&function(e,t="toggle"){e.loop=!e.loop&&"toggle"===t||"on"===t}(e,t.state)}else He(e,t)}function Ye(e,t,i,s){if((t||0)===(Oe.tabInfo?.frameId||0)&&e&&e===Oe.tabInfo?.tabId){if(!Oe.os)return;const e=[...Oe.os.mediaTower.media].find((e=>e.gsKey===i));e&&Ke(e,s)}else chrome.runtime.sendMessage({type:"SEND_MEDIA_EVENT_TO",key:i,tabId:e,frameId:t,event:s})}var je=i(5739).$;const We=T()?450:350;class Xe extends de{released=!1;circle=document.createElement("div");ref=document.createElement("div");delete=document.createElement("div");size=45;x=20;y=50;opacity=.5;visibleOpacity=.8;autoHide=!0;indicator=new ge;strong=!0;autoHidden=!0;hidden=!1;conflictWithDelete=!1;clientWidth=this._div.clientWidth;clientHeight=this._div.clientHeight;addedOutStyle=!1;constructor(e){super(),this.init=e,this.init=e||{},this.key=this.init.key,this.x=this.init.circleInitial?.x??this.x,this.y=this.init.circleInitial?.y??this.y,this.autoHide=!this.init.autoHideDisabled,this.size=this.init.circleSize??this.size,this.opacity=this.init.opacity??this.opacity;let t=P(1.6,.8,f(0,1,$(0,100,this.size)));this.size<10&&(t*=4);let i=this.size/18*t,s=2*i;this.indicator.setInit({position:"C",rounding:3,scaling:1.3,showShadow:!0}),this.circle.className="circle",this.ref.className="ref",this.delete.className="delete",this.delete.textContent="X",this._div.appendChild(this.circle),this._div.appendChild(this.ref),this._div.appendChild(this.delete),ae("\n:root[gspointerdown] {\n    -webkit-touch-callout: none !important;\n    user-select: none;\n}\n \n:is(div:popover-open, div.popoverOpenYah) {\n    background-color: transparent;\n    position: fixed;\n    left: 0px;\n    top: 0px;\n    width: 100vw;\n    height: 100vh;\n    pointer-events: none;\n    user-select: none;\n    touch-action: none;\n    -webkit-user-select: none;\n    margin: 0px;\n    padding: 0px;\n    border: none;\n    transition: 300ms ease-in opacity;\n}\n \n:is(div:popover-open, div.popoverOpenYah) .circle, :is(div:popover-open, div.popoverOpenYah) .ref, :is(div:popover-open, div.popoverOpenYah) .delete {\n        position: fixed; \n        border-radius: 50%;\n        box-sizing: border-box;\n        user-select: none; \n        transition: transform 50ms ease-out, border-color 100ms ease-out, opacity 100ms ease-out;\n    }\n \n:is(div:popover-open, div.popoverOpenYah) .circle, :is(div:popover-open, div.popoverOpenYah) .ref {\n        background-color: white;\n    }\n \n:is(div:popover-open, div.popoverOpenYah) .delete {\n        background-color: black;\n        color: white;\n        left: calc(50vw - 30px);\n        top: calc(50vh + 60px);\n        width: 60px;\n        height: 60px;\n        overflow: hidden;\n        font-size: 30px;\n        padding: 20px 0;\n        text-align: center;\n        opacity: 0;\n    }\n \n:is(div:popover-open, div.popoverOpenYah) .circle {\n        background-color: white;\n        pointer-events: none;\n        touch-action: none;\n        border: 5px solid white;\n        z-index: 3;\n    }\n \n:is(div:popover-open, div.popoverOpenYah) .ref {\n        pointer-events: none;\n        opacity: 0;\n        z-index: 2;\n    }",this._shadow),this.circle.style.width=`${this.size}px`,this.circle.style.height=`${this.size}px`,this.circle.style.boxShadow=`#00000088 0px 0px ${s}px ${i}px`,this.ref.style.width=.5*this.size+"px",this.ref.style.height=.5*this.size+"px",this.x=this.init.circleInitial?.x??this.x,this.y=this.init.circleInitial?.y??this.y,this.drawPosition(),this.drawCircleOpacity(),je.os.mediaTower.reobserveAllVideos(),this.autoHidden=this.autoHide,this.syncVisibility()}release=()=>{this.stop(),this._release(),this.indicator?.release(),delete this.indicator};start=e=>{if(this.addedOutStyle||(this.addedOutStyle=!0,ae(":root[gspointerdown] {-webkit-touch-callout: none !important; -webkit-user-select: none; user-select: none;}",document.body)),this.video){if(this.video===e)return;this.stop()}this.video=e,je.os.eListen.pointerDownCbs.add(this.handlePointerDown),je.os.eListen.pointerUpCbs.add(this.handlePointerUp),je.os.eListen.touchEndCbs.add(this.handlePointerUp),je.os.eListen.pointerMoveCbs.add(this.handlePointerMove),je.os.eListen.touchMoveCbs.add(this.handlePointerMove),(!T()||!k())&&je.os.eListen.contextMenuCbs.add(this.handleContextMenu),je.os.eListen.fsCbs.add(this.syncVisibility),je.os.eListen.touchStartCbs.add(this.handleGuard),je.os.eListen.touchEndCbs.add(this.handleGuard),je.os.eListen.touchMoveCbs.add(this.handleGuard),je.os.eListen.mouseDownCbs.add(this.handleGuard),je.os.eListen.mouseUpCbs.add(this.handleGuard),je.os.eListen.mouseMoveCbs.add(this.handleGuard),je.os.eListen.clickCbs.add(this.handleGuard),je.os.eListen.dblClickCbs.add(this.handleGuard),this._update(!0)};stop=()=>{this.video&&(this.clearSession(),clearTimeout(this.autoHiddenTimeout),delete this.autoHiddenTimeout,delete this.video,this._update(!1),je.os.eListen.pointerDownCbs.delete(this.handlePointerDown),je.os.eListen.pointerUpCbs.delete(this.handlePointerUp),je.os.eListen.touchEndCbs.delete(this.handlePointerUp),je.os.eListen.pointerMoveCbs.delete(this.handlePointerMove),je.os.eListen.touchMoveCbs.delete(this.handlePointerMove),je.os.eListen.contextMenuCbs.delete(this.handleContextMenu),je.os.eListen.fsCbs.delete(this.syncVisibility),je.os.eListen.touchStartCbs.delete(this.handleGuard),je.os.eListen.touchEndCbs.delete(this.handleGuard),je.os.eListen.touchMoveCbs.delete(this.handleGuard),je.os.eListen.mouseDownCbs.delete(this.handleGuard),je.os.eListen.mouseUpCbs.delete(this.handleGuard),je.os.eListen.mouseMoveCbs.delete(this.handleGuard),je.os.eListen.clickCbs.delete(this.handleGuard),je.os.eListen.dblClickCbs.delete(this.handleGuard))};updateClientDimensions=()=>{this.clientWidth=this._div.clientWidth,this.clientHeight=this._div.clientHeight};startShowTimeout=()=>{this.autoHidden=!1,clearTimeout(this.autoHiddenTimeout),this.autoHiddenTimeout=setTimeout(this.clearShow,4e3),this.syncVisibility()};clearShow=()=>{this.autoHidden=!0,this.syncVisibility()};syncVisibility=()=>{this.autoHidden||this.init.fullscreenOnly&&!document.fullscreenElement?(this._div.style.opacity="0",this.hidden=!0,this.circle.style.pointerEvents="none"):(this._div.style.opacity="1",this.hidden=!1,this.circle.style.pointerEvents="all")};clearPreventSecond=()=>{delete this.preventSecond};preventDefault=e=>{this.preventSecond=!0,e.cancelable&&e.preventDefault(),e.stopImmediatePropagation(),setTimeout(this.clearPreventSecond)};handleGuard=e=>{(this.preventSecond||this.downAt)&&(e.cancelable&&e.preventDefault(),e.stopImmediatePropagation())};handlePointerDown=e=>{this.autoHide&&this.startShowTimeout(),this.downAt&&this.clearSession(),this.isAtCircle(F(e))&&(this.downAt=Date.now(),this.drawCircleOpacity(),this._div.style.pointerEvents="all !important",this.preventDefault(e),T()&&k()&&document.documentElement.setAttribute("gspointerdown","true"),Ze(),this.longPressTimeoutId=T()&&k()?window.setTimeout((()=>{this.activateMovingMode(),Ze()}),600):null)};handlePointerUp=e=>{clearTimeout(this.longPressTimeoutId),this.downAt&&(e instanceof PointerEvent&&"mouse"!==e.pointerType?this.preventDefault(e):(this.autoHide&&this.startShowTimeout(),this.preventDefault(e),this.movingMode||this.leftCircle||this.doMain(),this.clearSession()))};handlePointerMove=async e=>{if(this.autoHide&&this.startShowTimeout(),!this.downAt)return;if(e instanceof PointerEvent&&"mouse"!==e.pointerType)return void this.preventDefault(e);this.preventDefault(e),Ze();let{clientX:t,clientY:i}=F(e);if(this.movingMode)return this.updateClientDimensions(),L()&&(i-=(window.visualViewport.height-window.innerHeight)/2),this.x=t/this.clientWidth*100,this.y=i/this.clientHeight*100,this.isAtDelete()?(Y({override:{circleWidget:!1},tabId:je.tabInfo.tabId}),void Qe.cancel()):(this.drawPosition(),void Qe(this.x,this.y,this.size));if(this.isAtCircle({clientX:t,clientY:i}))return void this.clearDirectional();this.leftCircle=!0;let s=this.getDirection(t,i);s?this.startDirectional(s):this.clearDirectional(),clearTimeout(this.longPressTimeoutId)};handleContextMenu=e=>{this.autoHide&&this.startShowTimeout(),this.isAtCircle(F(e))&&(this.activateMovingMode(),e.cancelable&&e.preventDefault(),e.stopImmediatePropagation())};clearSession=()=>{T()&&k()&&document.documentElement.removeAttribute("gspointerdown"),this._div.style.pointerEvents="none",this.clearDirectional(),this.clearMovingMode(),delete this.downAt,this.drawCircleOpacity(),Ze()};isAtCircle=e=>{if(this.hidden)return;let{clientX:t,clientY:i}=e;const s=this.ref.getBoundingClientRect();let n=s.x+.5*s.width,o=s.y+.5*s.height,r=.5*(T()?1.5:1.1);return L()&&(o+=(window.visualViewport.height-window.innerHeight)/2),!(!v(n-this.size*r,n+this.size*r,t)||!v(o-this.size*r,o+this.size*r,i))||void 0};isAtDelete=e=>{let t=this.ref.getBoundingClientRect(),i={clientX:t.x+.5*t.width,clientY:t.y+.5*t.height},s=this.delete.getBoundingClientRect(),n=s.x+.5*s.width,o=s.y+.5*s.height,r=.5*(e?3:1);if(v(n-s.width*r,n+s.width*r,i.clientX)&&v(o-s.height*r,o+s.height*r,i.clientY))return!0};doMain=()=>{"PAUSE"===this.init.mainAction?this.togglePause():this.toggleSpeed()};togglePause=async()=>{let e=!this.video.paused;_e(this.video,e?"on":"off")};toggleSpeed=async()=>{let e=this.init.mainActionSpeed||3;const t=await K({speed:!0,lastSpeed:!0},je.tabInfo.tabId);let i=t.lastSpeed;t.speed?.toFixed(2)===e.toFixed(2)&&([e,i]=[t.lastSpeed,t.speed]),Y({override:{speed:e,lastSpeed:t.speed},tabId:je.tabInfo.tabId}),this.indicator.show({text:te(e)})};handleDirectionalInterval=async()=>{if(!this.combo)return void this.clearDirectional();this.autoHide&&this.startShowTimeout(),this.combo.combo++;let e=this.direction===qe.TOP||this.direction===qe.BOTTOM,t=this.direction===qe.LEFT||this.direction===qe.TOP;this.circle.style.transform=`translate${e?"Y":"X"}(${t?"-":""}${this.strong?"40":"20"}px)`;let i=!!(e?this.init.fixedSpeedStep:this.init.fixedSeekStep);this.circle.style.border=this.strong?"5px solid red":"5px solid white",this.ref.style.opacity="1";let s=this.direction;if(e){let e=this.strong?.25:this.init.fixedSpeedStep||.1;const t=await K({speed:!0},je.tabInfo.tabId);let i=ee((n=t.speed+(s===qe.TOP?e:-e),o=e,g(Math.round(n/o)*o,6)));Y({override:{speed:i,lastSpeed:t.speed},tabId:je.tabInfo.tabId}),this.indicator.show({text:te(i)})}else{let e=this.strong?30:this.init.fixedSeekStep||10;!i&&this.combo.combo>3&&(e*=1.2**this.combo.combo),De(this.video,this.video.currentTime+(this.direction===qe.LEFT?-e:e)),this.indicator.show({text:I(this.video.currentTime-this.combo.initialTime,!0)})}var n,o};getDirection=(e,t)=>{this.updateClientDimensions();const i=this.ref.getBoundingClientRect();let s=i.x+.5*i.width,n=i.y+.5*i.height;L()&&(n+=(window.visualViewport.height-window.innerHeight)/2);const o=e-s,r=t-n,a=Math.sqrt(o**2+r**2);if(a<50)return;const l=Math.abs(o)>Math.abs(r)?o>=0?qe.RIGHT:qe.LEFT:r>=0?qe.BOTTOM:qe.TOP,d=!!(l===qe.TOP||l===qe.BOTTOM?this.init.fixedSpeedStep:this.init.fixedSeekStep);return this.strong=a>115&&!d,l};clearDirectional=()=>{this.direction&&(delete this.combo,delete this.direction,delete this.leftCircle,this.circle.style.transform="",this.circle.style.border="5px solid white",this.ref.style.opacity="0",clearInterval(this.directionalIntervalId),delete this.directionalIntervalId)};startDirectional=e=>{e&&this.direction!==e&&(this.clearDirectional(),this.direction=e,this.combo={combo:0,initialTime:this.video.currentTime},this.directionalIntervalId=setInterval(this.handleDirectionalInterval,We),this.handleDirectionalInterval())};activateMovingMode=()=>{this.movingMode||(this.indicator.show({text:"Positioning",duration:2e3}),this.movingMode=!0,this.delete.style.top&&(this.delete.style.top=null),this.conflictWithDelete=this.isAtDelete(!0),this.circle.style.border="5px solid yellow",this.delete.style.opacity="0.75",this.delete.style.top=this.conflictWithDelete?"calc(70vh + 60px)":null)};clearMovingMode=()=>{this.movingMode&&(this.indicator.show({text:"Standard",duration:2e3}),this.movingMode=!1,this.conflictWithDelete=!1,this.circle.style.border="5px solid white",this.delete.style.opacity="0")};drawPosition=()=>{this.circle.style.left=`calc(${this.x}vw - ${this.size/2}px)`,this.circle.style.top=`calc(${this.y}vh - ${this.size/2}px)`,this.ref.style.left=`calc(${this.x}vw - ${this.size/4}px)`,this.ref.style.top=`calc(${this.y}vh - ${this.size/4}px)`};drawCircleOpacity=()=>{this.circle.style.opacity=this.downAt?`${this.visibleOpacity}`:`${this.opacity}`}}var qe=function(e){return e[e.TOP=1]="TOP",e[e.RIGHT=2]="RIGHT",e[e.BOTTOM=3]="BOTTOM",e[e.LEFT=4]="LEFT",e}(qe||{});const Qe=n()((async(e,t,i)=>{let s=(await K({circleInit:!0})).circleInit||{};s.circleInitial=function(e,t,i){if(!window.innerWidth)return{x:e,y:t};let s=i/window.visualViewport.width*100*2,n=i/window.visualViewport.height*100*2;return{x:f(s,100-s,e),y:f(n,100-n,t)}}(e,t,i),await Y({override:{circleInit:s},tabId:je.tabInfo.tabId})}),2e3,{trailing:!0});function Ze(){const e=document.getSelection?.();e&&e.rangeCount&&e.removeAllRanges()}var Je=i(5739).$;const et=[".qq.com","wetv.vip","web.whatsapp.com","pan.baidu.com","onedrive.live.com","open.spotify.com",".instagram.com",".descript.com","www.ccmtv.cn",".douyin.com",".tiktok.com",".linkedin.com"].some((e=>(location.hostname||"").includes(e)));class tt{released=!1;blockKeyUp=!1;lastTrigger=0;urlConditionsClient=new W({keybindsUrlCondition:!0},Je.tabInfo.tabId,!0,((e,t)=>{this.handleChangeUrlConditionsList()}),300);client=new W({ghostMode:!0,ghostModeUrlCondition:!0,enabled:!0,superDisable:!0,latestViaShortcut:!0,keybinds:!0,keybindsUrlCondition:!0,indicatorInit:!0,circleWidget:!0,circleInit:!0,holdToSpeed:!0},Je.tabInfo.tabId,!0,((e,t)=>{t&&this.init(),this.handleChange()}),300);speedClient=new W({speed:!0,freePitch:!0,enabled:!0,superDisable:!0},Je.tabInfo.tabId,!0,(e=>{this.handleSpeedChange()}),100,150);ignoreList=new Set;init=()=>{Je.os.eListen.keyDownCbs.add(this.handleKeyDown),Je.os.eListen.keyUpCbs.add(this.handleKeyUp),this.handleSpeedChange()};release=()=>{this.released||(this.released=!0,this.client?.release(),delete this.client,this.speedClient?.release(),delete this.speedClient,this.fxSync?.release(),delete this.fxSync,Je.os.eListen.keyDownCbs.delete(this.handleKeyDown),Je.os.eListen.keyUpCbs.delete(this.handleKeyUp))};urlConditionsMode="Off";urlConditionsNonStatic=[];handleChangeUrlConditionsList=()=>{this.urlConditions=this.urlConditionsClient.view.keybindsUrlCondition||{block:!0,parts:[]};const e=(this.urlConditions.parts||[]).filter((e=>!e.disabled));if(0===e.length)return void(this.urlConditionsMode="On");let t=[],i=[];if(e.forEach((e=>{(!function(e){const t=location.origin||"",i=(e.valueStartsWith||"").trim();if("STARTS_WITH"===e.type&&i.startsWith("http")){const e=[...i].filter((e=>"/"===e)).length;if(2===e)return!0;if(3===e&&i.endsWith("/"))return!0;if(!i.startsWith(t))return!0}}(e)?i:t).push(e)})),this.urlConditionsNonStatic=i,0===t.length)return void(this.urlConditionsMode="Runtime");const s=V(),n=t.map((e=>se(s,e))).some((e=>e));this.urlConditionsMode=n?this.urlConditions.block?"Off":"On":"Runtime","Runtime"===this.urlConditionsMode&&0===i.length&&(this.urlConditionsMode=this.urlConditions.block?"On":"Off")};checkUrlRuntime=()=>{if("Runtime"!==this.urlConditionsMode)return this.urlConditionsMode;const e=V(),t=this.urlConditionsNonStatic.map((t=>se(e,t))).some((e=>e));return this.urlConditions.block?t?"Off":"On":t?"On":"Off"};handleChange=()=>{const e=this.client.view,t=e?.enabled&&!e.superDisable;Je.os.indicator&&Je.os.indicator.key!==e?.indicatorInit?.key&&Je.os.indicator.setInit(e?.indicatorInit||{}),Je.os.speedSync.holdToSpeed=e.holdToSpeed,t?this.fxSync=this.fxSync??new pe:(this.fxSync?.release(),delete this.fxSync),t&&e.circleWidget?(Je.os.circle&&Je.os.circle.key!==e.circleInit?.key&&(Je.os.circle?.release(),delete Je.os.circle),Je.os.circle=Je.os.circle||new Xe(e.circleInit)):(Je.os.circle?.release(),delete Je.os.circle);let i=!1;if(e?.ghostMode&&ne(V(),e.ghostModeUrlCondition,!0)&&(i=!0),e?.enabled&&(i||et)){if(Je.ghostMode)return;Je.ghostMode=!0,Je.os.stratumServer.initialized?this.sendGhostOn():Je.os.stratumServer.initCbs.add(this.sendGhostOn)}else{if(!Je.ghostMode)return;Je.ghostMode=!1,Je.os.stratumServer.initialized?this.sendGhostOff():Je.os.stratumServer.initCbs.add(this.sendGhostOff)}};handleSpeedChange=()=>{const e=this.speedClient.view;e&&e.enabled&&!e.superDisable?(Je.os.speedSync.latest={speed:e.speed,freePitch:e.freePitch},Je.os.speedSync.update()):(delete Je.os.speedSync.latest,Je.os.speedSync.update())};sendGhostOn=()=>Je.os.stratumServer.send({type:"GHOST"});sendGhostOff=()=>Je.os.stratumServer.send({type:"GHOST",off:!0});handleKeyUp=e=>{this.lastTrigger=0,this.ignoreList.clear(),this.blockKeyUp&&(this.blockKeyUp=!1,e.stopImmediatePropagation(),e.preventDefault())};handleKeyDown=e=>{if("IFRAME"===document.activeElement?.tagName)return;if(!chrome.runtime?.id)return Je.os.handleOrphan();if(!this.client?.view)return;if(this.client.view.superDisable)return;const i=this.client.view.enabled;let s=this.client.view.keybinds;if(!i&&(s=(s||[]).filter((e=>"state"===e.command&&e.enabled&&(e.trigger||u.LOCAL)===u.LOCAL&&(this.client.view.latestViaShortcut||e.alwaysOn))),!s.length))return;this.blockKeyUp=!1;const n=e.target;if(["INPUT","TEXTAREA"].includes(n.tagName)||n.isContentEditable)return;const o=re(document,"activeElement");if(n!==o&&(["INPUT","TEXTAREA"].includes(o.tagName)||o.isContentEditable))return;if("Off"===this.checkUrlRuntime())return;const r=function(e,t=!0,i){return{ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,code:t?e.code:void 0,key:i?e.key:void 0}}(e,!0,!0);let a=(l=r,s.filter((e=>e.enabled&&(e.trigger||u.LOCAL)===u.LOCAL)).map((e=>e.key&&t(e.key,l)?{kb:e}:e.allowAlt&&e.adjustMode===c.CYCLE&&t(e.keyAlt,l)?{kb:e,alt:!0}:void 0)).filter((e=>e)));var l;if(a=a.filter((e=>!(e.kb.condition?.parts.length>0)||ne(V(),e.kb.condition,!0))),a.some((e=>e.kb.greedy))&&(this.blockKeyUp=!0,e.preventDefault(),e.stopImmediatePropagation()),a=a.filter((e=>!(e.kb.adjustMode===c.ITC||e.kb.adjustMode===c.ITC_REL)||!this.ignoreList.has(e.kb.id))),a.length){const e=Date.now();e-this.lastTrigger>50&&(this.lastTrigger=e,a.filter((e=>e.kb.adjustMode===c.ITC||e.kb.adjustMode===c.ITC_REL)).forEach((e=>this.ignoreList.add(e.kb.id))),chrome.runtime.sendMessage({type:"TRIGGER_KEYBINDS",ids:a.map((e=>({id:e.kb.id,alt:e.alt})))}))}}}var it=i(5739).$;class st{media=new Set;docs=new Set;newDocCallbacks=new Set;forceSpeedCallbacks=new Set;trackFps=!0;constructor(){this.processDoc(window),it.os.stratumServer.wiggleCbs.add(this.handleWiggle),Ee&&it.os.stratumServer.msgCbs.add(this.handleServerMessage),it.os.detectOpen.cbs.add(this.handleDetectOpen),window.addEventListener("beforeunload",this.handleUnload,{capture:!0}),window.addEventListener("blur",this.handleBlur,{capture:!0,passive:!0})}handleDetectOpen=()=>{this.observer?.disconnect(),this.ensureEventListeners(),window.addEventListener("beforeunload",this.handleUnload,{capture:!0}),window.addEventListener("blur",this.handleBlur,{capture:!0,passive:!0}),this.handleUnload()};handleUnload=()=>{if(this.scopeStorageKey)try{chrome.storage.session.remove(this.scopeStorageKey)}catch(e){}};handleBlur=e=>{let t=document;for(;t=oe(t.activeElement),t;)this.processDoc(t)};observe=e=>{window.IntersectionObserver&&(this.observer=this.observer||new IntersectionObserver(this.handleObservation,{threshold:[0,.2,.4,.6,.8,1]}),this.observer.observe(e))};reobserve=e=>{this.observer.unobserve(e),this.observer.observe(e)};reobserveAllVideos=()=>{this.media.forEach((e=>{e instanceof HTMLVideoElement&&e.duration&&this.reobserve(e)}))};handleObservation=e=>{e.forEach((e=>{e.target.intersectionRatio=e.intersectionRatio})),this.sendUpdateDeb(),it.os.circle&&this.processEntriesForCircle()};processEntriesForCircle=()=>{const e=[...this.media].find((e=>e.duration>10&&e.isConnected&&e instanceof HTMLVideoElement&&e.intersectionRatio>.5));e?it.os.circle.start(e):it.os.circle.stop()};handleWiggle=e=>{e instanceof ShadowRoot?this.processDoc(e):e instanceof HTMLMediaElement&&this.processMedia(e)};handleServerMessage=e=>{if("YT_REQUEST_RATE"===e?.type){const e=it.os.speedSync.latest?.speed;e&&it.os.stratumServer.send({type:"YT_RATE_CHANGE",value:e})}};processDoc=e=>{this.docs.has(e)||(this.docs.add(e),this.ensureDocEventListeners(e),this.newDocCallbacks.forEach((e=>e())))};processMedia=e=>{if(this.media.has(e))return;e.gsKey=e.gsKey||w();const t=e?.getRootNode();t instanceof ShadowRoot&&this.processDoc(t),this.ensureMediaEventListeners(e),e instanceof HTMLVideoElement&&this.observe(e),this.media.add(e),this.sendUpdate(),this.forceSpeedCallbacks.forEach((e=>e()))};ensureDocEventListeners=e=>{e.addEventListener("playing",this.handleMediaLastPlayedEvent,{capture:!0,passive:!0}),e.addEventListener("pause",this.handleMediaLastPlayedEvent,{capture:!0,passive:!0}),e.addEventListener("play",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("playing",this.handleInterrupt,{capture:!0,passive:!0}),e.addEventListener("timeupdate",this.handleMediaEventTimeUpdate,{capture:!0,passive:!0}),e.addEventListener("pause",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("volumechange",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("loadedmetadata",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("emptied",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("enterpictureinpicture",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("leavepictureinpicture",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("fullscreenchange",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("webkitfullscreenchange",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("ratechange",this.handleMediaEvent,{capture:!0,passive:!0}),Ee&&e.addEventListener("ratechange",this.handleYoutubeRateChange,{capture:!0,passive:!0})};ensureMediaEventListeners=e=>{e.addEventListener("playing",this.handleMediaLastPlayedEvent,{capture:!0,passive:!0}),e.addEventListener("pause",this.handleMediaLastPlayedEvent,{capture:!0,passive:!0}),e.addEventListener("play",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("playing",this.handleInterrupt,{capture:!0,passive:!0}),e.addEventListener("pause",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("volumechange",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("loadedmetadata",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("emptied",this.handleMediaEvent,{capture:!0,passive:!0}),e.addEventListener("ratechange",this.handleMediaEvent,{capture:!0,passive:!0})};ensureEventListeners=()=>{this.docs.forEach((e=>this.ensureDocEventListeners(e))),this.media.forEach((e=>this.ensureMediaEventListeners(e)))};handleYoutubeRateChange=e=>{const t=e.target.playbackRate;t&&it.os.stratumServer.send({type:"YT_RATE_CHANGE",value:t})};handleInterrupt=e=>{e.processed||(e.processed=!0,delete this.previousTimeUpdate,this.forceSpeedCallbacks.forEach((e=>e())))};handleMediaLastPlayedEvent=e=>{e.target instanceof HTMLMediaElement&&(e.target,e.target.gsLastPlayed=Date.now())};handleMediaEventTimeUpdate=e=>{if(e.target instanceof HTMLMediaElement){if(e.target,this.trackFps){const t={key:e.target.gsKey,time:performance.now(),frames:e.target.webkitDecodedFrameCount??e.target.getVideoPlaybackQuality?.()?.totalVideoFrames};!function(e,t,i){if(!i||i.key!==t.key)return;const s=t.time-i.time,n=(t.frames-i.frames)/(s/1e3)/e.playbackRate;if(!isNaN(n)){if(e.gsFpsCount>5){const t=e.gsFpsSum/e.gsFpsCount;if(!v(.5*t,1.5*t,n))return}e.gsFpsSum=(e.gsFpsSum||0)+n,e.gsFpsCount=(e.gsFpsCount||0)+1,e.gsFpsCount>200&&(e.gsFpsSum/=10,e.gsFpsCount/=10)}}(e.target,t,this.previousTimeUpdate),this.previousTimeUpdate=t}else delete this.previousTimeUpdate;this.handleMediaEventDeb(e)}};handleMediaEvent=e=>{if(!e?.isTrusted)return;if(e.processed)return;e.processed=!0;let t=e.target;this.processMedia(t),this.sendUpdate(),"ratechange"===e.type?(it.ghostMode&&e.stopImmediatePropagation(),delete e.target.gsFpsCount,delete e.target.gsFpsSum):"emptied"===e.type?(delete t.gsMarks,delete t.gsNameless):"pause"!==e.type&&"playing"!==e.type||this.handleInterrupt(e),it.os.circle&&("playing"===e.type||"loadedmetadata"===e.type)&&t instanceof HTMLVideoElement&&this.reobserve(t)};handleMediaEventDeb=n()(this.handleMediaEvent,5e3,{leading:!0,trailing:!0,maxWait:5e3});sendUpdate=()=>{if(!chrome.runtime?.id)return it.os.handleOrphan();if(!it.tabInfo)return;this.scopeStorageKey||(this.scopeStorageKey=`m:scope:${it.tabInfo.tabId}:${it.tabInfo.frameId}`);const e=function(e,t){const i=(s=location.hostname,S||(S={result:R(s)}),S.result);var s;const n={tabInfo:{...e},title:document.title,displayTitle:U(navigator.mediaSession?.metadata?.title||document.title,i),domain:location.hostname,displayDomain:(o=i?.baseName,o?o[0].toUpperCase()+o.slice(1).toLowerCase():""),url:document.URL,media:t.map((e=>function(e){const t=e.getRootNode();let i={key:e.gsKey,duration:e.duration,volume:e.volume,readyState:e.readyState,marks:Object.keys(e.gsMarks||{}),playbackRate:e.playbackRate,lastPlayed:e.gsLastPlayed};if(e.duration===1/0&&(i.infinity=!0,i.duration=999999999),e.isConnected&&(i.isConnected=!0),e.paused&&(i.paused=!0),e.muted&&(i.muted=!0),t&&(t instanceof ShadowRoot&&(e.gsShadowRoot=t,i.shadowMode=t.mode),t.pictureInPictureElement===e&&(i.pipMode=!0)),e.gsLoopTimeUpdateHandler&&(i.inLoop=!0),e.gsSkipTimeUpdateHandler&&(i.inSkip=!0),e instanceof HTMLVideoElement){i.isVideo=!0;const t=e.videoWidth,s=e.videoHeight;if(t&&s&&(i.videoSize={w:t,h:s},e.intersectionRatio&&(i.intersectionRatio=e.intersectionRatio)),e.isConnected){try{i.isVisible=e.checkVisibility({contentVisibilityAuto:!0,opacityProperty:!0,visibilityProperty:!0})}catch{}let t=e.isConnected?e.getBoundingClientRect():null;t&&(i.elementSize={w:t.width,h:t.height})}if(e.gsFpsCount>5){const t=e.gsFpsSum/e.gsFpsCount;t>0&&(i.fps=t)}(e.videoTracks?.length??t)&&(i.hasVideoTrack=!0)}return(e.duration&&!i.isVideo||[...e.audioTracks||[]].some((e=>e.enabled))||e.webkitAudioDecodedByteCount||e.mozHasAudio)&&(i.hasAudioTrack=!0),i}(e))),creationTime:Date.now()};var o;return function(){if(E)return E.result;try{E={result:window.opener.documentPictureInPicture.window===window}}catch{E={result:!1}}return E.result}()&&(n.isDip=!0),n}(it.tabInfo,[...this.media]),t={[this.scopeStorageKey]:e};chrome.storage.session?chrome.storage.session.set(t):chrome.runtime.sendMessage({type:"SET_SESSION",override:t})};sendUpdateDeb=n()(this.sendUpdate,500,{leading:!0,trailing:!0,maxWait:2e3});applyMediaEventTo=(e,t,i)=>{let s=[...this.media].filter((e=>e.readyState));if(t?s=s.filter((e=>e.gsKey===t)):i&&(s=s.sort(((e,t)=>t.duration-e.duration)).slice(0,1)),0===s.length)return;let n=[...this.media];s.forEach((t=>{Ke(n.find((e=>e.gsKey===t.gsKey)),e)}))};applySpeedToAll=(e,t)=>{e&&(e=ee(e),this.media.forEach((i=>{Ke(i,{type:"PLAYBACK_RATE",value:e,freePitch:t})})))}}class nt{eventFlag=!1;eventName=w();cbs=new Set;constructor(){document.addEventListener(this.eventName,this.handleEvent,{capture:!0}),this.mo.observe(document,{childList:!0})}handleEvent=e=>{e.stopImmediatePropagation(),this.eventFlag=!0};handleMut=e=>{if(e.some((e=>{for(let t of e.removedNodes)if("HTML"===t.nodeName)return!0}))){document.dispatchEvent(new Event(this.eventName));const e=this.eventFlag;this.eventFlag=!1,e||(document.addEventListener(this.eventName,this.handleEvent,{capture:!0}),this.cbs.forEach((e=>e())))}};mo=new MutationObserver(this.handleMut)}var ot=i(5739).$;class rt{constructor(){ot.os.eListen.fsCbs.add(this.handleFsChange)}release=()=>{ot.os.eListen.fsCbs.delete(this.handleFsChange)};toggleSafe=async e=>{this.operationLock||(this.operationLock=!0,await this.toggle(e).finally((()=>{delete this.operationLock})))};toggle=async e=>{this.lock?await this.releaseLock():document.fullscreenElement?await document.exitFullscreen():e?.isConnected&&Te&&await this.activate(e)};async activate(e){if(await e.requestFullscreen(),!document.fullscreenElement)return;this.ensureClickListeners();let t=e.getRootNode();this.lock={video:e,originalValues:{controls:e.controls,scrollX:window.scrollX,scrollY:window.scrollY},mo:new MutationObserver(this.ensureProper),style:ae(":is(*, #proooo > #fesss > #sion > #al) { all: revert !important; pointer-events: all; }",t instanceof ShadowRoot?t:document.documentElement),resetCount:0},this.lock.mo.observe(e,{attributeFilter:["controls"]}),this.ensureProper()}ensureProper=()=>{if(!this.lock)return;let{video:e,resetCount:t}=this.lock;e.controls||(e.controls=!0,t++>1e3&&this.releaseLock())};ensureClickListeners=()=>{ot.os.eListen.clickCbs.add(this.handleClick),ot.os.eListen.pointerDownCbs.add(this.handleClick),ot.os.eListen.pointerUpCbs.add(this.handleClick),ot.os.eListen.mouseDownCbs.add(this.handleClick),ot.os.eListen.mouseUpCbs.add(this.handleClick),ot.os.eListen.touchStartCbs.add(this.handleClick)};removeClickListeners=()=>{ot.os.eListen.clickCbs.delete(this.handleClick),ot.os.eListen.pointerDownCbs.delete(this.handleClick),ot.os.eListen.pointerUpCbs.delete(this.handleClick),ot.os.eListen.mouseDownCbs.delete(this.handleClick),ot.os.eListen.mouseUpCbs.delete(this.handleClick),ot.os.eListen.touchStartCbs.delete(this.handleClick)};handleClick=e=>{e.stopImmediatePropagation()};releaseLock=async()=>{this.removeClickListeners();const e=this?.lock;if(!e)return;let{video:t,originalValues:{scrollX:i,scrollY:s}}=this.lock;e.mo?.disconnect(),delete e.mo,e.style?.remove(),delete e.style,t.controls=e.originalValues.controls,document.fullscreenElement&&await document.exitFullscreen(),window.scrollTo(i,s),delete this.lock};handleFsChange=()=>{if(null==document.fullscreenElement)return void this.releaseLock();const e=this.lock?.video;e&&e.getRootNode().fullscreenElement!==e&&this.releaseLock()}}var at=i(5739).$;class lt{constructor(){at.os.eListen.fsCbs.add(this.handleFullscreenChange)}release=()=>{at.os.eListen.fsCbs.delete(this.handleFullscreenChange)};handleFullscreenChange=e=>{if(!chrome.runtime?.id)return at.os.handleOrphan();if(this.lock){if(document.fullscreenElement&&this.lock.getRootNode().fullscreenElement===this.lock)return;this.lock=null}document.fullscreenElement&&this.attemptIntegration()};attemptIntegration=async()=>{if(!document.fullscreenElement||document.fullscreenElement instanceof HTMLVideoElement)return;let e=[...at.os.mediaTower.media].filter((e=>e.readyState&&e instanceof HTMLVideoElement&&e.videoWidth&&e.isConnected)).map((e=>function(e){if(!e)return;let t=function(e){if(!e)return;let t=e;for(;;){let e=t?.getRootNode();if(!e)return;if(e.fullscreenElement)return e;if(!(e instanceof ShadowRoot))return;t=e.host}}(e)?.fullscreenElement;return t&&t!==e?function(e,t){if(!e||!t)return;let i=0,s=t;for(;;){if(s=s?.parentNode||s?.host,i++,!s)return;if(s===e)return{ancestor:e,distance:i,child:t}}}(t,e):void 0}(e))).filter((e=>e));if(e.length>1&&(e=e.filter((e=>e.child.intersectionRatio)).sort(((e,t)=>t.child.intersectionRatio-e.child.intersectionRatio)).slice(0,1)),1!==e.length)return;const t=await ht(e[0]);t&&await async function(e,t=.5){let{profiles:i,key:s}=await ct();i=i.filter((e=>e.created>Date.now()-7776e6));let n=i.map((t=>({profile:t,score:dt(t,e)}))).sort(((e,t)=>t.score-e.score))[0];if(n?.score>0&&n.score/e.maxScore>(t??.5)){let e=i.indexOf(n.profile);e>=0&&i.splice(e,1)}i.unshift(e),chrome.storage.local.set({[s]:i.slice(0,10)})}(t)};toggleSafe=async e=>{this.operationLock||(this.operationLock=!0,await this.toggle(e).finally((()=>{delete this.operationLock})))};toggle=async e=>{if(document.fullscreenElement)return void await document.exitFullscreen();if(!(Le&&e?.isConnected&&e.readyState&&e.videoWidth))return;const t=await async function(e,t=.5){let{profiles:i}=await ct();const s=await Promise.all(i.map((t=>async function(e,t){let i=function(e,t){let i=e;for(let e=0;e<t;e++)if(i=i.parentNode||i.host,!i)return;return i}(e,t.distance);if(!(i instanceof Element))return;return{profile:t,score:dt(await ht({distance:t.distance,child:e,ancestor:i}),t),ancestor:i}}(e,t))));let n;return s.filter((e=>e.score/e.profile.maxScore>t)).forEach((e=>{(!n||e.score>n.score)&&(n=e)})),n}(e,.5);t?(await t.ancestor.requestFullscreen(),this.lock=t.ancestor):await at.os.nativeFs.toggleSafe(e)}}function dt(e,t){if(e.distance!==t.distance)return-1/0;if(e.parentTag!==t.parentTag)return-1/0;let i=0;return new Set([...e.videoAttributes,...t.videoAttributes]).forEach((s=>{i+=e.videoAttributes.includes(s)&&t.videoAttributes.includes(s)?10:-10})),new Set([...e.parentAttributes,...t.parentAttributes]).forEach((s=>{i+=e.parentAttributes.includes(s)&&t.parentAttributes.includes(s)?10:-10})),new Set([...e.videoClassNames,...t.videoClassNames]).forEach((s=>{i+=e.videoClassNames.includes(s)&&t.videoClassNames.includes(s)?10:0})),new Set([...e.parentClassNames,...t.parentClassNames]).forEach((s=>{i+=e.parentClassNames.includes(s)&&t.parentClassNames.includes(s)?10:0})),i+=e.videoId===t.videoId?e.videoId?25:10:0,i+=e.parentId===t.parentId?e.parentId?25:10:0,e.slashes[0]&&t.slashes[0]&&(i+=e.slashes[0]===t.slashes[0]?25:0),e.slashes[1]&&t.slashes[1]&&(i+=e.slashes[1]===t.slashes[1]?10:0),i}async function ht({distance:e,child:t,ancestor:i}){let s=[],n=(document?.location?.pathname||"").substr(1);n&&(s=n.split("/").slice(0,3));const o={created:Date.now(),distance:e,videoId:t?.id||null,videoClassNames:[...t?.classList||[]],videoAttributes:t?.getAttributeNames()??[],parentId:i.id||null,parentTag:i.tagName,parentClassNames:[...i?.classList||[]],parentAttributes:i?.getAttributeNames()??[],slashes:s};return await Pe(),await Promise.all([...["videoId","parentId","parentTag"].map((async e=>{o[e]&&(o[e]=await $e(o[e]))})),...["videoClassNames","videoAttributes","parentClassNames","parentAttributes","slashes"].map((async e=>{o[e]?.length&&await Promise.all(o[e].map((async(t,i)=>{o[e][i]=await $e(t)})))}))]),o.maxScore=dt(o,o),o}async function ct(){await Pe();const e=`f:fs:${await $e(location.hostname)}`;return{key:e,profiles:(await chrome.storage.local.get(e))[e]||[]}}class ut{wiggleCbs=new Set;msgCbs=new Set;initCbs=new Set;#e;#t;initialized=!1;constructor(){window.addEventListener("GS_INIT",this.handleInit,{capture:!0,once:!0})}handleInit=e=>{e.target instanceof HTMLDivElement&&"GS_PARASITE"===e.target.id&&e.target.shadowRoot&&(this.parasite=e.target,this.parasiteRoot=e.target.shadowRoot,this.#e=`GS_SERVER_${e.detail}`,this.#t=`GS_CLIENT_${e.detail}`,this.parasiteRoot.addEventListener(this.#e,this.handle,{capture:!0}),this.initCbs.forEach((e=>e())),this.initCbs.clear(),this.initialized=!0)};handle=e=>{let t;e.stopImmediatePropagation();try{t=JSON.parse(e.detail)}catch(e){}if("WIGGLE"===t.type){const e=this.parasite.parentNode;e&&(this.parasite.remove(),this.wiggleCbs.forEach((t=>t(e))))}else"MSG"===t.type&&this.msgCbs.forEach((e=>e(t.data||{})))};send=e=>{this.parasiteRoot.dispatchEvent(new CustomEvent(this.#t,{detail:JSON.stringify(e)}))}}var pt=i(5739).$;class mt{constructor(e){this.cb=e,pt.os.eListen.visibilityCbs.add(this.handleChange),this.sync()}release=()=>{pt.os.eListen.visibilityCbs.delete(this.handleChange)};handleChange=()=>{this.timeoutId&&(this.timeoutId=clearTimeout(this.timeoutId)),document.hidden?this.timeoutId=setTimeout(this.sync,1500):this.sync()};sync=()=>{this.cb?.()}}var ft=i(5739).$;class vt extends de{lastDraw=-1/0;slider=document.createElement("div");ref=document.createElement("div");cancelButton=D('<button class="cancel"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M5.72 5.72a.75.75 0 0 1 1.06 0L12 10.94l5.22-5.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L13.06 12l5.22 5.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L12 13.06l-5.22 5.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L10.94 12 5.72 6.78a.75.75 0 0 1 0-1.06Z"></path></svg></button>');resetButton=D('<button class="reset"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke-width="2" d="M20,8 C18.5974037,5.04031171 15.536972,3 12,3 C7.02943725,3 3,7.02943725 3,12 C3,16.9705627 7.02943725,21 12,21 L12,21 C16.9705627,21 21,16.9705627 21,12 M21,3 L21,9 L15,9"></path></svg></button>');paused=!1;isShowingReset=!1;constructor(){super(),this.ref.className="ref",this.slider.className="slider",this._div.appendChild(this.ref),this._div.appendChild(this.slider),this._div.appendChild(this.cancelButton),this._div.appendChild(this.resetButton),ae("\n:is(div:popover-open, div.popoverOpenYah) {\n    background-color: transparent;\n    position: fixed;\n    left: 0px;\n    top: 0px;\n    width: 100vw;\n    height: 100vh;\n    border: none;\n    margin: 0;\n    user-select: none;\n    touch-action: none;\n    pointer-events: all !important;\n\n}\n\n    :is(div:popover-open, div.popoverOpenYah) .slider, :is(div:popover-open, div.popoverOpenYah) .ref {\n        pointer-events: none;\n        left: 0px;\n        position: fixed; \n        border: 1px solid #00000066;\n    }\n\n    :is(div:popover-open, div.popoverOpenYah) .slider.slider, :is(div:popover-open, div.popoverOpenYah) .ref.slider {\n            pointer-events: none;\n            background-color: blue;\n            border-radius: 50%;\n        }\n\n    :is(div:popover-open, div.popoverOpenYah) .slider.ref, :is(div:popover-open, div.popoverOpenYah) .ref.ref {\n            background-color: #ff0000;\n            border-radius: 50%;\n            opacity: 0.8;\n        }\n\n    :is(div:popover-open, div.popoverOpenYah) .cancel, :is(div:popover-open, div.popoverOpenYah) .reset {\n        position: fixed;\n        box-sizing: border-box;\n        font-size: 55px;\n        line-height: 1;\n        bottom: calc(10vh - 52px);\n        background-color: black;\n        box-shadow: 1px 1px 40px 4px white;\n        border-radius: 50%;\n        color: white;\n        opacity: 0.8;\n        padding: 25px;\n    }\n\n    :is(div:popover-open, div.popoverOpenYah) .cancel:hover, :is(div:popover-open, div.popoverOpenYah) .reset:hover {\n            opacity: 1;\n        }\n\n    :is(div:popover-open, div.popoverOpenYah) .cancel.cancel, :is(div:popover-open, div.popoverOpenYah) .reset.cancel {\n            right: calc(10vw - 52px);\n        }\n\n    :is(div:popover-open, div.popoverOpenYah) .cancel.reset, :is(div:popover-open, div.popoverOpenYah) .reset.reset {\n            left: calc(10vw - 52px);\n            display: none;\n        }",this._shadow),this.slider.style.top="calc(50vh - 50px)",this.slider.style.height="100px",this.slider.style.width="100px",this.slider.style.display="none",this.ref.style.top="calc(50vh - 5px)",this.ref.style.height="10px",this.ref.style.width="10px",this.ref.style.display="block"}released=!1;release=()=>{this.stop(),this._release()};start=e=>{if(this.paused=!1,this.inits=e,this.sole=1===this.inits.length?this.inits[0]:void 0,this.inits.length){if(this.sole?(this.ref.style.transform=`translateX(calc((100vw - 100px) * ${this.sole.relative?.5:$(this.sole.sliderMin,this.sole.sliderMax,this.sole.original)} + 50px - 5px))`,this.ref.style.display="block"):this.ref.style.display="none",this.isShowingReset=this.inits.every((e=>null!=e.resetTo)),this.resetButton.style.display=this.isShowingReset?"inline-block":"none",this.inits.some((e=>"seek"===e.kb.command&&!e.wasPaused&&e.kb.pauseWhileScrubbing))){let e=this.inits.find((e=>e.mediaKey));Ye(e.mediaTabInfo.tabId,e.mediaTabInfo.frameId,e.mediaKey,{type:"PAUSE",state:"on"}),this.paused=!0}this._update(!0),this.inits.some((e=>e.dontReleaseKeyUp))||ft.os.eListen.keyUpCbs.add(this.handleKeyUp),ft.os.eListen.pointerMoveCbs.add(this.handlePointerMove),ft.os.eListen.pointerUpCbs.add(this.handlePointerUp),ft.os.eListen.touchMoveCbs.add(this.handlePointerMove),ft.os.eListen.touchEndCbs.add(this.handlePointerUp),ft.os.eListen.touchStartCbs.add(this.handleGuard),ft.os.eListen.touchEndCbs.add(this.handleGuard),ft.os.eListen.touchMoveCbs.add(this.handleGuard),ft.os.eListen.mouseDownCbs.add(this.handleGuard),ft.os.eListen.mouseUpCbs.add(this.handleGuard),ft.os.eListen.mouseMoveCbs.add(this.handleGuard),ft.os.eListen.clickCbs.add(this.handleGuard),ft.os.eListen.dblClickCbs.add(this.handleGuard)}};stop=()=>{if(this.paused){let e=this.inits.find((e=>e.mediaKey));Ye(e.mediaTabInfo.tabId,e.mediaTabInfo.frameId,e.mediaKey,{type:"PAUSE",state:"off"}),this.paused=!1}delete this.latestXy,ft.os.eListen.keyUpCbs.delete(this.handleKeyUp),ft.os.eListen.pointerMoveCbs.delete(this.handlePointerMove),ft.os.eListen.pointerUpCbs.delete(this.handlePointerUp),ft.os.eListen.touchMoveCbs.delete(this.handlePointerMove),ft.os.eListen.touchEndCbs.delete(this.handlePointerUp),ft.os.eListen.touchStartCbs.delete(this.handleGuard),ft.os.eListen.touchEndCbs.delete(this.handleGuard),ft.os.eListen.touchMoveCbs.delete(this.handleGuard),ft.os.eListen.mouseDownCbs.delete(this.handleGuard),ft.os.eListen.mouseUpCbs.delete(this.handleGuard),ft.os.eListen.mouseMoveCbs.delete(this.handleGuard),ft.os.eListen.clickCbs.delete(this.handleGuard),ft.os.eListen.dblClickCbs.delete(this.handleGuard),this._update(!1)};handleKeyUp=e=>{"Escape"!==e.key?(this.latestXy&&this.draw(this.latestXy,!0),this.stop()):this.cancel()};isAtCancel=e=>{let t=this.cancelButton.getBoundingClientRect();if(t.width)return!(!v(t.x,t.x+t.width,e.clientX)||!v(t.y,t.y+t.height,e.clientY))||void 0};isAtReset=e=>{if(!this.isShowingReset)return;let t=this.resetButton.getBoundingClientRect();return t.width&&!(!v(t.x,t.x+t.width,e.clientX)||!v(t.y,t.y+t.height,e.clientY))||void 0};preventDefault=e=>{e.cancelable&&e.preventDefault(),e.stopImmediatePropagation()};handleGuard=e=>{e.cancelable&&e.preventDefault(),e.stopImmediatePropagation()};handlePointerMove=e=>{if(this.preventDefault(e),e instanceof PointerEvent&&"mouse"!==e.pointerType)return;let t=F(e);this.isAtCancel(t)?this.cancel():this.isAtReset(t)?this.reset():(this.latestXy=t,Date.now()-this.lastDraw<200||this.draw(t))};handlePointerUp=e=>{e instanceof PointerEvent&&"mouse"!==e.pointerType||(this.latestXy=F(e),null!=this.latestXy.clientX&&this.draw(this.latestXy,!0),this.stop()),this.preventDefault(e)};draw=(e,t)=>{const i=f(0,1,(e.clientX-50)/(window.innerWidth-100));for(let e of this.inits){const s=e.seekOnce&&!t;if(e.relative)this.send(e,(2*i-1)*e.step,!0,s);else{const t=P(e.sliderMin,e.sliderMax,i);this.send(e,t,!1,s)}}};cancel=()=>{this.inits.forEach((e=>{this.send(e,0,!0)})),this.stop()};reset=()=>{if(this.isShowingReset){for(let e of this.inits)null!=e.resetTo&&this.send(e,e.resetTo);this.stop()}};send=(e,t,i,s)=>{chrome.runtime.sendMessage({type:"SET_STATEFUL",init:{mediaKey:e.mediaKey,mediaTabInfo:e.mediaTabInfo,tabInfo:ft.tabInfo,shouldShow:e.shouldShow,value:null==e.original?null:i?e.original+t:t,valueAlt:null==e.originalAlt?null:i?e.originalAlt+t:t,kb:e.kb,dry:s,showAlt:!0,wasRelative:e.relative,mediaDuration:e.mediaDuration}})}}var gt=i(5739).$;class wt{constructor(){chrome.runtime.onMessage.addListener(this.handleMessage)}handleMessage=(e,t,i)=>{if("APPLY_MEDIA_EVENT"===e.type)return function(e,t){if(e){const i=[...Oe.os.mediaTower.media].find((t=>t.gsKey===e));i&&Ke(i,t)}else Oe.os.mediaTower.media.forEach((e=>{Ke(e,t)}))}(e.key,e.event),void i(!0);if("SET_TEMPORARY_SPEED"===e.type)i(!0),gt.os.speedSync?.processTemporarySpeed(e.factor);else if("TOP_FRAME_URL_UPDATE"===e.type)gt.topFrameUrl=e.value;else{if("REQUEST_TOP_FRAME_URL"===e.type)return void i({value:location.href});if("RUN_JS"===e.type)return function(e){if(!M()||!e)return;const t=document.createElement("script");t.type="text/javascript",t.text=e,document.documentElement.appendChild(t),t.remove()}(e.value),void i(!0);if("BG_SPEED_OVERRIDE"===e.type){if(!gt.os?.speedSync)return;gt.os.speedSync.latest=e.value,gt.os.speedSync.update()}else{if("SHOW_INDICATOR"===e.type){if(e.requiresFocus&&(!document.hasFocus()||"IFRAME"===re(document,"activeElement")?.tagName))return;return e.showAlt?(gt.os.indicatorAlt||(gt.os.indicatorAlt=new ge,gt.os.indicatorAlt.setInit({position:"C",rounding:3,scaling:1.3,showShadow:!0})),gt.os.indicatorAlt.show(e.opts)):gt.os.indicator.show(e.opts),void i(!0)}if("ADD_PANE"===e.type)gt.Pane?gt.Pane&&new gt.Pane(e.filters,e.svgFilters):chrome.runtime.sendMessage({type:"REQUEST_PANE"}).then((()=>{gt.Pane&&new gt.Pane(e.filters,e.svgFilters)}));else{if("ITC"===e.type){if(gt.isTopFrame){if(re(document,"fullscreenElement")instanceof HTMLIFrameElement)return}else if(!document.fullscreenElement)return;return gt.os.itc?.stop(),gt.os.itc=gt.os.itc??new vt,gt.os.itc.start(e.inits),void i(!0)}if("MEDIA_PROBE"===e.type)return void i(function(e,t){if(e)return{currentTime:e.currentTime,paused:e.paused,duration:e.duration,volume:e.volume,fps:"VIDEO"===e.tagName?Ve(e):null,formatted:t?Ge(e):null,fullyLooped:e.loop}}([...gt.os.mediaTower?.media||[]].find((t=>t.gsKey===e.key)),e.formatted));if("CS_ALIVE"===e.type)return void i(!0);if("CINEMA"===e.type)return s=e.event,window.addEventListener("message",(e=>{if("CINEMA"!==e.data)return;let t=function(e){let t=new Set;return gt.os.mediaTower.docs.forEach((e=>{(e.document??e).querySelectorAll("iframe").forEach((e=>t.add(e)))})),[...t].find((t=>t.contentWindow===e))}(e.source);t&&He(t,s)}),{capture:!0,once:!0}),void i(!0)}}}var s}}var yt=i(5739).$;class bt{constructor(){window.addEventListener("pointerdown",this.handlePointerDown,{capture:!0,passive:!0}),window.addEventListener("pointerup",this.handlePointerUp,{capture:!0,passive:!0}),document.addEventListener("mouseleave",this.clearPointerDown,{capture:!0,passive:!0}),window.addEventListener("keyup",this.handleKeyUp,{capture:!0})}release=()=>{clearInterval(this.intervalId),delete this.intervalId,window.removeEventListener("pointerdown",this.handlePointerDown,!0),window.removeEventListener("pointerup",this.handlePointerUp,!0),document.removeEventListener("mouseleave",this.clearPointerDown,!0),window.removeEventListener("keyup",this.handleKeyUp,!0)};update=()=>{this.latest?(this.intervalId=this.intervalId??setInterval(this.realize,1e3),yt.os.mediaTower.forceSpeedCallbacks.add(this.realize),this.realize()):this.intervalId=(clearInterval(this.intervalId),null)};handlePointerDown=e=>{if(this.holdToSpeed&&0===e.button&&!this.keyDownActive()){if("VIDEO"===e.target?.tagName)return void this.setPointerDownToNow();if(Et(document,e))return void this.setPointerDownToNow();const t=new Set([...yt.os.mediaTower.media].filter((e=>!e.paused&&"VIDEO"===e.tagName&&e.gsShadowRoot)).map((e=>e.gsShadowRoot)));t.size&&[...t].some((t=>Et(t,e)))&&this.setPointerDownToNow()}};setPointerDownToNow=()=>{this.pointerDownAt=Date.now(),setTimeout(this.realize,620)};handlePointerUp=e=>{0===e.button&&this.clearPointerDown()};clearPointerDown=e=>{e&&null!==e.relatedTarget||!this.pointerDownAt||(delete this.pointerDownAt,this.realize())};pointerDownActive=()=>this.pointerDownAt&&v(600,3e4,Date.now()-this.pointerDownAt);keyDownActive=()=>this.keyDownAt&&v(0,3e4,Date.now()-this.keyDownAt);processTemporarySpeed=e=>{e?(this.holdToSpeedForKeyboard=e,this.keyDownAt=Date.now()):delete this.keyDownAt,this.realize()};handleKeyUp=()=>{delete this.keyDownAt};realize=()=>{if(this.latest){let e=this.latest.speed;this.holdToSpeed&&this.pointerDownActive()?e*=this.holdToSpeed:this.holdToSpeedForKeyboard&&this.keyDownActive()&&(e*=this.holdToSpeedForKeyboard),yt.os.mediaTower.applySpeedToAll(e,this.latest.freePitch)}yt.isTopFrame&&this.previousUrl!==location.href&&(this.previousUrl=location.href,chrome.runtime.sendMessage({type:"REQUEST_NOTIFY_TOP_FRAME_URL_CHANGE",value:this.previousUrl}))}}const Ct=new Set(["INPUT","BUTTON","TEXTAREA"]);function Et(e,t){const i=e.elementsFromPoint(t.clientX,t.clientY);return i.some((e=>"VIDEO"===e.tagName))&&i.every((e=>!Ct.has(e.tagName)))}class St{keyDownCbs=new Set;keyUpCbs=new Set;pointerDownCbs=new Set;pointerUpCbs=new Set;pointerMoveCbs=new Set;mouseDownCbs=new Set;mouseUpCbs=new Set;mouseMoveCbs=new Set;clickCbs=new Set;dblClickCbs=new Set;touchStartCbs=new Set;touchEndCbs=new Set;touchMoveCbs=new Set;contextMenuCbs=new Set;fsCbs=new Set;visibilityCbs=new Set;constructor(){this.update()}update=()=>{window.addEventListener("keydown",this.handleKeyDown,!0),window.addEventListener("keyup",this.handleKeyUp,!0),window.addEventListener("pointerdown",this.handlePointerDown,!0),window.addEventListener("pointerup",this.handlePointerUp,!0),window.addEventListener("pointermove",this.handlePointerMove,!0),window.addEventListener("mousedown",this.handleMouseDown,!0),window.addEventListener("mouseup",this.handleMouseUp,!0),window.addEventListener("mousemove",this.handleMouseMove,!0),window.addEventListener("click",this.handleClick,!0),window.addEventListener("dblclick",this.handleDblClick,!0),window.addEventListener("touchstart",this.handleTouchStart,!0),window.addEventListener("touchend",this.handleTouchEnd,!0),window.addEventListener("touchmove",this.handleTouchMove,!0),window.addEventListener("contextmenu",this.handleContextMenu,!0),window.addEventListener("fullscreenchange",this.handleFullscreen,!0),window.addEventListener("webkitfullscreenchange",this.handleFullscreen,!0),window.addEventListener("visibilitychange",this.handleVisibilityChange,!0)};handleKeyDown=e=>{this.keyDownCbs.forEach((t=>{t(e)}))};handleKeyUp=e=>{this.keyUpCbs.forEach((t=>{t(e)}))};handlePointerDown=e=>{this.pointerDownCbs.forEach((t=>{t(e)}))};handlePointerUp=e=>{this.pointerUpCbs.forEach((t=>{t(e)}))};handlePointerMove=e=>{this.pointerMoveCbs.forEach((t=>{t(e)}))};handleMouseDown=e=>{this.mouseDownCbs.forEach((t=>{t(e)}))};handleMouseUp=e=>{this.mouseUpCbs.forEach((t=>{t(e)}))};handleMouseMove=e=>{this.mouseMoveCbs.forEach((t=>{t(e)}))};handleClick=e=>{this.clickCbs.forEach((t=>{t(e)}))};handleDblClick=e=>{this.dblClickCbs.forEach((t=>{t(e)}))};handleTouchStart=e=>{this.touchStartCbs.forEach((t=>{t(e)}))};handleTouchEnd=e=>{this.touchEndCbs.forEach((t=>{t(e)}))};handleTouchMove=e=>{this.touchMoveCbs.forEach((t=>{t(e)}))};handleContextMenu=e=>{this.contextMenuCbs.forEach((t=>{t(e)}))};handleFullscreen=e=>{this.fsCbs.forEach((t=>{t(e)}))};handleVisibilityChange=e=>{this.visibilityCbs.forEach((t=>{t(e)}))}}var xt=i(5739).$;class Mt{orphaned=!1;released=!1;init=async()=>{this.eListen=new St,this.detectOpen=new nt,this.stratumServer=new ut,this.mediaTower=new st,this.smartFs=new lt,this.nativeFs=new rt,this.messageTower=new wt,this.speedSync=new bt,this.detectOpen.cbs.add((()=>{this.eListen.update()})),await this.initAsync(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.handleDOMLoaded,{capture:!0,passive:!0,once:!0}):this.handleDOMLoaded()};initAsync=async()=>{if(xt.tabInfo=await e(),!xt.tabInfo&&(await(3e3,new Promise(((e,t)=>{setTimeout((()=>e(!0)),3e3)}))),xt.tabInfo=await e(),!xt.tabInfo))return;const t=await K({indicatorInit:!0})||{};xt.isTopFrame&&(this.indicator=new ge,this.indicator.setInit(t.indicatorInit||{})),xt.isTopFrame||chrome.runtime.sendMessage({type:"REQUEST_TOP_FRAME_URL"})};handleDOMLoaded=()=>{this.visibleSync=new mt(this.handleVisibleChange)};handleVisibleChange=()=>{document.hidden?(this.configSync?.release(),delete this.configSync):this.configSync=this.configSync??new tt};handleOrphan=()=>{this.orphaned||(this.orphaned=!0,this.release())};release=()=>{this.released||(this.released=!0,this.indicator?.release(),delete this.indicator,this.indicatorAlt?.release(),delete this.indicatorAlt,this.smartFs?.release(),delete this.smartFs,this.nativeFs?.release(),delete this.nativeFs,this.visibleSync?.release(),delete this.visibleSync,this.configSync?.release(),delete this.configSync,this.itc?.release(),delete this.itc,this.circle?.release(),delete this.circle,this.speedSync?.release(),delete this.speedSync)}}var kt=i(5739).$;!async function(){globalThis.gvar||(globalThis.gvar=kt,document.gvar=kt,kt.isTopFrame=window.self===window.top,kt.os=new Mt,kt.os.init())}()})()})();